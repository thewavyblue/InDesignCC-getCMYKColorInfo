<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>InDesign Scripting SDK: AppleScript Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="adobe_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">InDesign Scripting SDK
   &#160;<span id="projectnumber">19.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('id_as_adobe_indesign_cc_scripting_guide_applescript.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AppleScript Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="id_as_introduction"></a>
Introduction</h1>
<p>This document shows how to do the following:</p>
<ul>
<li>Work with the InDesign scripting environment.</li>
<li>Use advanced scripting features.</li>
<li>Perform basic document tasks like setting up master spreads, printing, and exporting.</li>
<li>Work with page items (rectangles, ellipses, graphic lines, polygons, text frames, and groups).</li>
<li>Work with text and type in an InDesign document, including finding and changing text.</li>
<li>Create dialog boxes and other user-interface items.</li>
<li>Customize and add menus and create menu actions.</li>
<li>Respond to user-interface events.</li>
<li>Work with XML, from creating XML elements and importing XML to adding XML elements to a layout.</li>
<li>Apply XML rules, a new scripting feature that makes working with XML in InDesign faster and easier.</li>
</ul>
<p>We assume that you have already read the Adobe InDesign Scripting Tutorial and know how to create, install, and run scripts. If you need to know how to connect with your scripting environment or view the InDesign scripting object model from your script editor, that information can be found in the Adobe InDesign Scripting Tutorial.</p>
<h2><a class="anchor" id="id_as_how_to_use_the_scripts_in_this_document"></a>
How to Use the Scripts in this Document</h2>
<p>For the most part, the scripts shown in this document are not complete scripts. They are only fragments of scripts, and are intended to show only the specific part of a script relevant to the point being discussed in the text. You can copy the script lines shown in this document and paste them into your script editor, but you should not expect them to run without further editing. Note, in addition, that scripts copied out of this document may contain line breaks and other characters (due to the document layout) that will prevent them from executing properly.</p>
<p>All of the scripts shown in this document are available in the scripts folder. Move the folders corresponding to the scripting language(s) of your choice into the Scripts Panel folder inside the Scripts folder in your InDesign folder. At that point, you can run the scripts from the Scripts panel inside InDesign.</p>
<h2><a class="anchor" id="id_as_about_the_structure_of_the_scripts"></a>
About the Structure of the Scripts</h2>
<p>The script examples are all written using a common template that includes the handlers "main," "mySetup," "mySnippet," and "myTeardown." We did this to simplify automated testing and publication-there is no reason for you to construct your scripts this way. Most of the time, the part of the script you will be interested in will be inside the "mySnippet" handler.</p>
<h2><a class="anchor" id="id_as_for_more_information"></a>
For More Information</h2>
<p>For more information on InDesign scripting, you also can visit the InDesign Scripting User to User forum, at <a href="http://www.adobeforums.com">http://www.adobeforums.com </a>. In the forum, script writers can ask questions, post answers, and share their newest scripts. The forum contains hundreds of sample scripts.</p>
<h1><a class="anchor" id="id_as_scripting_features"></a>
Scripting Features</h1>
<p>This section covers scripting techniques related to InDesign's scripting environment. Almost every other object in the InDesign scripting model controls a feature that can change a document or the application defaults. By contrast, the features in this section control how scripts operate.</p>
<p>This document discusses the following:</p>
<ul>
<li>The script preferences object and its properties.</li>
<li>Getting a reference to the executing script.</li>
<li>Running scripts in prior versions of the scripting object model.</li>
<li>Using the do script method to run scripts.</li>
<li>Working with script labels.</li>
<li>Running scripts at InDesign start-up.</li>
</ul>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to write, install, and run InDesign scripts in the scripting language of your choice.</p>
<h2><a class="anchor" id="id_as_script_preferences"></a>
Script Preferences</h2>
<p>The script preferences object provides objects and properties related to the way InDesign runs scripts. The following table provides more detail on each property of the script preferences object:</p>
<table class="doxtable">
<tr>
<th>Property </th><th>Description </th></tr>
<tr>
<td>enableRedraw </td><td>Turns screen redraw on or off while a script is running from the Scripts panel. </td></tr>
<tr>
<td>scriptsFolder </td><td>The path to the scripts folder. </td></tr>
<tr>
<td>scriptsList </td><td>A list of the available scripts. This property is an array of arrays, in the following form: [[fileName,filePath], ...] where fileName is the name of the script file and filePath is the full path to the script. You can use this feature to check for the existence of a script in the installed set of scripts. </td></tr>
<tr>
<td>userInteractionLevel </td><td>This property controls the alerts and dialogs InDesign presents to the user. When you set this property to UserInteractionLevels.neverInteract , InDesign does not display any alerts or dialogs. Set it to UserInteractionLevels.interactWithAlerts to enable alerts but disable dialogs. Set it to interactWithAll to restore the normal display of alerts and dialogs. The ability to turn off alert displays is very useful when you are opening documents via script; often, InDesign displays an alert for missing fonts or linked graphics files. To avoid this alert, set the user-interaction level to UserInteractionLevels.neverInteract before opening the document, then restore user interaction (set the property to interactWithAll) before completing script execution. </td></tr>
<tr>
<td>version </td><td>The version of the scripting environment in use. For more information, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_script_versioning">Script Versioning</a>. Note this property is not the same as the version of the application. </td></tr>
</table>
<h2><a class="anchor" id="id_as_getting_the_current_script"></a>
Getting the Current Script</h2>
<p>You can get a reference to the current script using the active script property of the application object. You can use this property to help you locate files and folders relative to the script, as shown in the following example (from the ActiveScript tutorial script):</p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myScript to active script</div>
<div class="line">        display dialog (<span class="stringliteral">&quot;The current script is: &quot;</span> &amp; myScript)</div>
<div class="line">        tell application &quot;Finder&quot;</div>
<div class="line">            set myFile to file myScript</div>
<div class="line">            set myParentFolder to container of myFile</div>
<div class="line">        end tell</div>
<div class="line">        display dialog (&quot;The folder containing the active script is: &quot; &amp; myParentFolder)</div>
</div><!-- fragment --><p> When you debug scripts using a script editor, the active script property returns an error. Only scripts run from the Scripts palette appear in the active script property.</p>
<h2><a class="anchor" id="id_as_script_versioning"></a>
Script Versioning</h2>
<p>InDesign can run scripts using earlier versions of the InDesign scripting object model. To run an older script in a newer version of InDesign, you must consider the following:</p>
<ul>
<li><b>Targeting</b> - Scripts must be targeted to the version of InDesign in which they are being run (i.e., the current version). The mechanics of targeting are language specific as described in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_targeting">Targeting</a>.</li>
<li><b>Compilation</b> - This involves mapping the names in the script to the underlying script IDs, which are what InDesign understands. The mechanics of compilation are language specific as described in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_compilation">Compilation</a>.</li>
<li><b>Interpretation</b> - This involves matching the IDs to the appropriate request handler within InDesign so that InDesign correctly interprets a script written for an earlier version of the scripting object model. To do this, either explicitly set the application's script preferences to the old object model within the script (as shown in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_interpretation">Interpretation</a>) or run the script from a folder in the Scripts panel folder as follows:</li>
</ul>
<table class="doxtable">
<tr>
<th>Folder </th><th>For InDesign version of scripts </th></tr>
<tr>
<td>Version 19.0 Scripts </td><td>2024 </td></tr>
<tr>
<td>Version 18.0 Scripts </td><td>2023 </td></tr>
<tr>
<td>Version 17.0 Scripts </td><td>2022 </td></tr>
<tr>
<td>Version 16.0 Scripts </td><td>2021 </td></tr>
<tr>
<td>Version 15.0 Scripts </td><td>2020 </td></tr>
<tr>
<td>Version 14.0 Scripts </td><td>CC 2019 </td></tr>
<tr>
<td>Version 13.0 Scripts </td><td>CC 2018 </td></tr>
<tr>
<td>Version 12.0 Scripts </td><td>CC 2017 </td></tr>
<tr>
<td>Version 11.0 Scripts </td><td>CC 2015 </td></tr>
<tr>
<td>Version 10.0 Scripts </td><td>CC 2014 </td></tr>
<tr>
<td>Version 9.0 Scripts </td><td>CC </td></tr>
<tr>
<td>Version 8.0 Scripts </td><td>CS6 </td></tr>
<tr>
<td>Version 7.0 Scripts </td><td>CS5 and CS5.5 </td></tr>
<tr>
<td>Version 6.0 Scripts </td><td>CS4 </td></tr>
<tr>
<td>Version 5.0 Scripts </td><td>CS3 </td></tr>
<tr>
<td>Version 2.0 Scripts </td><td>CS2 </td></tr>
</table>
<h3><a class="anchor" id="id_as_targeting"></a>
Targeting</h3>
<p>A script must always target the version of InDesign under which it is running (the current version), either explicitly or implicitly. Targeting is implicit when the script is launched from the Scripts panel.</p>
<p>Otherwise, explicit targeting for AppleScripts is done using the tell statement: </p>
<div class="fragment"><div class="line">--Target InDesign 2024</div>
<div class="line">tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
</div><!-- fragment --><h3><a class="anchor" id="id_as_compilation"></a>
Compilation</h3>
<p>Typically, AppleScripts are compiled using the targeted application's dictionary. This behavior may be overridden by means of the using terms from statement, which substitutes a different version of the InDesign dictionary for compilation purposes. For example, to use a CC 2017 script (version 12.0) within 2024 (version 19.0):</p>
<div class="fragment"><div class="line">tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">    --target CC</div>
<div class="line">    <span class="keyword">using</span> terms from application <span class="stringliteral">&quot;InDesign CC 2017&quot;</span> </div>
<div class="line">        --compile <span class="keyword">using</span> CC 2017</div>
<div class="line">        --InDesign CC 2017 version script goes here.</div>
<div class="line">    end <span class="keyword">using</span> terms from</div>
<div class="line">end tell</div>
</div><!-- fragment --><p>For this to work, you need to generate a CC 2015 version of the AppleScript dictionary, use the publish terminology command, which is exposed on the application object. The dictionary is generated into a folder (named with the version of the DOM) that is in the Scripting Support folder in your application's preferences folder. For example, to generate the CC 2015 dictionary into the /Users/&lt;username&gt;/Library/Preferences/Adobe InDesign/Version 13.0/&lt;locale&gt;/ScriptingSupport/12.0 folder:</p>
<div class="fragment"><div class="line">tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">    --publish the InDesign CC 2017 dictionary (version 12.0 DOM)</div>
<div class="line">    publish terminology version 12.0</div>
<div class="line">end tell</div>
</div><!-- fragment --><h3><a class="anchor" id="id_as_interpretation"></a>
Interpretation</h3>
<p>The InDesign application object contains a script preferences object, which allows a script to get/set the version of the scripting object model to use for interpreting scripts. The version defaults to the current version of the application and persists.</p>
<p>For example, to change the version of the scripting object model to CC 2017 (12.0):</p>
<div class="fragment"><div class="line">--Set to 12.0 scripting <span class="keywordtype">object</span> model</div>
<div class="line"><span class="keyword">set</span> version of script preferences to 12.0</div>
</div><!-- fragment --><h2><a class="anchor" id="id_as_using_the_do_script_method"></a>
Using the do script Method</h2>
<p>The do script method gives a script a way to execute another script. The script can be a string of valid scripting code or a file on disk. The script can be in the same scripting language as the current script or another scripting language. The available languages vary by platform: on Mac OS, you can run AppleScript or JavaScript; on Windows, VBScript or JavaScript.</p>
<p>The do script method has many possible uses:</p>
<ul>
<li>Running a script in another language that provides a feature missing in your main scripting language. For example, VBScript lacks the ability to display a file or folder browser, which JavaScript has. AppleScript can be very slow to compute trigonometric functions (sine and cosine), but JavaScript performs these calculations rapidly. JavaScript does not have a way to query Microsoft Excel for the contents of a specific spreadsheet cell, but both AppleScript and VBScript have this capability. In all these examples, the do script method can execute a snippet of scripting code in another language, to overcome a limitation of the language used for the body of the script.</li>
<li>Creating a script "on the fly." Your script can create a script (as a string) during its execution, which it can then execute using the do script method. This is a great way to create a custom dialog or panel based on the contents of the selection or the attributes of objects the script creates.</li>
<li>Embedding scripts in objects. Scripts can use the do script method to run scripts that were saved as strings in the label property of objects. Using this technique, an object can contain a script that controls its layout properties or updates its content according to certain parameters. Scripts also can be embedded in XML elements as an attribute of the element or as the contents of an element. See <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_running_scripts_at_startup">Running Scripts at Startup</a>.</li>
</ul>
<h3><a class="anchor" id="id_as_sending_parameters_to_do_script"></a>
Sending parameters to do script</h3>
<p>To send a parameter to a script executed by do script, use the following form (from the DoScriptParameters tutorial script):</p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        --Create a list of parameters.</div>
<div class="line">        <span class="keyword">set</span> myParameters to {<span class="stringliteral">&quot;Hello from do script&quot;</span>, <span class="stringliteral">&quot;Your message here.&quot;</span>}</div>
<div class="line">        --Create a JavaScript as a <span class="keywordtype">string</span>.</div>
<div class="line">        <span class="keyword">set</span> myJavaScript to <span class="stringliteral">&quot;alert(\&quot;First argument: \&quot; + arguments[0] + &quot;</span></div>
<div class="line">        <span class="keyword">set</span> myJavaScript to myJavaScript &amp; <span class="stringliteral">&quot;\&quot;\\rSecond argument: \&quot; + arguments[1])&quot;</span></div>
<div class="line">        --Run the JavaScript <span class="keyword">using</span> the <span class="keywordflow">do</span> script command.</div>
<div class="line">        <span class="keywordflow">do</span> script myJavaScript language javascript with arguments myParameters</div>
<div class="line">        --Create an AppleScript as a <span class="keywordtype">string</span>.</div>
<div class="line">        <span class="keyword">set</span> myAppleScript to <span class="stringliteral">&quot;tell application \&quot;Adobe InDesign 2024\&quot;&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myAppleScript to myAppleScript &amp; <span class="stringliteral">&quot;tell application \&quot;Adobe InDesign 2024\&quot;&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myAppleScript to myAppleScript &amp; <span class="stringliteral">&quot;display dialog (&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myAppleScript to myAppleScript &amp; <span class="stringliteral">&quot;\&quot;First argument: \&quot; &amp; item 1 of arguments &amp; return&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myAppleScript to myAppleScript &amp; <span class="stringliteral">&quot;&amp; \&quot;Second argument: \&quot; &amp; item 2 of arguments)&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myAppleScript to myAppleScript &amp; <span class="stringliteral">&quot;end tell&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myAppleScript to myAppleScript &amp; <span class="stringliteral">&quot;end tell&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        --Run the AppleScript <span class="keyword">using</span> the <span class="keywordflow">do</span> script command.</div>
<div class="line">        <span class="keywordflow">do</span> script myAppleScript language applescript language with arguments myParameters</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_returning_values_from_do_script"></a>
Returning values from do script</h3>
<p>The following script fragment shows how to return a value from a script executed by do script. This example uses a JavaScript that is executed as a string, but the same method works for script files. This example returns a single value, but you can return multiple values by returning an array (for the complete script, refer to the DoScriptReturnValues script).</p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to text frame 1 of myPage</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myDestinationPage to make page</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myPageIndex to name of myDestinationPage</div>
<div class="line">        <span class="keyword">set</span> myID to <span class="keywordtype">id</span> of myTextFrame</div>
<div class="line">        <span class="keyword">set</span> myJavaScript to <span class="stringliteral">&quot;var myDestinationPage = arguments[1];&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myJavaScript to myJavaScript &amp; <span class="stringliteral">&quot;myID = arguments[0];&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myJavaScript to myJavaScript &amp; <span class="stringliteral">&quot;var myX = arguments[2];&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myJavaScript to myJavaScript &amp; <span class="stringliteral">&quot;var myY = arguments[3];&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myJavaScript to myJavaScript &amp; <span class="stringliteral">&quot;var myPageItem = app.documents.item(0).pages.item(0).pageItems.itemByID(myID);&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myJavaScript to myJavaScript &amp; <span class="stringliteral">&quot;myPageItem.duplicate(app.documents.item(0).pages.item(myDestinationPage));&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        --Create an array <span class="keywordflow">for</span> the parameters we want to pass to the JavaScript.</div>
<div class="line">        <span class="keyword">set</span> myArguments to {myID, myPageIndex, 0, 0}</div>
<div class="line">        <span class="keyword">set</span> myDuplicate to <span class="keywordflow">do</span> script myJavaScript language javascript with arguments myArguments</div>
<div class="line">        --myDuplicate now contains a reference to the duplicated text frame.</div>
<div class="line">        --Change the text in the duplicated text frame.</div>
<div class="line">        <span class="keyword">set</span> contents of myDuplicate to <span class="stringliteral">&quot;Duplicated text frame.&quot;</span></div>
</div><!-- fragment --><p> Another way to get values from another script is to use the script args (short for "script arguments") object of the application. The following script fragment shows how to do this (for the complete script, see DoScriptScriptArgs):</p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> nameA to <span class="stringliteral">&quot;ScriptArgumentA&quot;</span></div>
<div class="line">        <span class="keyword">set</span> nameB to <span class="stringliteral">&quot;ScriptArgumentB&quot;</span></div>
<div class="line">        <span class="keyword">set</span> nAc to nameA &amp; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line">        <span class="keyword">set</span> nBc to nameB &amp; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line">        --Create a <span class="keywordtype">string</span> to be run as an AppleScript.</div>
<div class="line">        <span class="keyword">set</span> p1 to <span class="stringliteral">&quot;tell application \&quot;Adobe InDesign 2024\&quot;&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> p2 to <span class="stringliteral">&quot;tell script args&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> p3 to <span class="stringliteral">&quot;set value name \&quot;ScriptArgumentA\&quot; value &quot;</span></div>
<div class="line">        <span class="keyword">set</span> p4 to <span class="stringliteral">&quot;\&quot;This is the first AppleScript script argument value.\&quot;&quot;</span></div>
<div class="line">        <span class="keyword">set</span> p5 to <span class="stringliteral">&quot;set value name \&quot;ScriptArgumentB\&quot; value &quot;</span></div>
<div class="line">        <span class="keyword">set</span> p6 to <span class="stringliteral">&quot;\&quot;This is the second AppleScript script argument value.\&quot;&quot;</span></div>
<div class="line">        <span class="keyword">set</span> p7 to <span class="stringliteral">&quot;end tell&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> p8 to <span class="stringliteral">&quot;end tell&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myAppleScript to p1 &amp; p2 &amp; p3 &amp; p4 &amp; <span class="keywordflow">return</span> &amp; p5 &amp; p6 &amp; <span class="keywordflow">return</span> &amp; p7 &amp; p8</div>
<div class="line">        --Run the AppleScript <span class="keywordtype">string</span>.</div>
<div class="line">        <span class="keywordflow">do</span> script myAppleScript language applescript language</div>
<div class="line">        --Retrieve the script argument values <span class="keyword">set</span> by the script.</div>
<div class="line">        tell script args</div>
<div class="line">            <span class="keyword">set</span> myScriptArgumentA to <span class="keyword">get</span> value name nameA</div>
<div class="line">            <span class="keyword">set</span> myScriptArgumentB to <span class="keyword">get</span> value name nameB</div>
<div class="line">        end tell</div>
<div class="line">        --Display the script argument values in a dialog box.</div>
<div class="line">        display dialog nAc &amp; myScriptArgumentA &amp; <span class="keywordflow">return</span> &amp; nBc &amp; myScriptArgumentB</div>
<div class="line">        --Create a <span class="keywordtype">string</span> to be run as a JavaScript.</div>
<div class="line">        <span class="keyword">set</span> p1 to <span class="stringliteral">&quot;app.scriptArgs.setValue(\&quot;ScriptArgumentA\&quot;, &quot;</span></div>
<div class="line">        <span class="keyword">set</span> p2 to <span class="stringliteral">&quot;\&quot;This is the first JavaScript script argument value.\&quot;);&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> p3 to <span class="stringliteral">&quot;app.scriptArgs.setValue(\&quot;ScriptArgumentB\&quot;, &quot;</span></div>
<div class="line">        <span class="keyword">set</span> p4 to <span class="stringliteral">&quot;\&quot;This is the second JavaScript script argument value.\&quot;);&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myJavaScript to p1 &amp; p2 &amp; p3 &amp; p4</div>
<div class="line">        --Run the JavaScript <span class="keywordtype">string</span>.</div>
<div class="line">        <span class="keywordflow">do</span> script myJavaScript language javascript</div>
<div class="line">        --Retrieve the script argument values <span class="keyword">set</span> by the script.</div>
<div class="line">        tell script args</div>
<div class="line">            <span class="keyword">set</span> myScriptArgumentA to <span class="keyword">get</span> value name nameA</div>
<div class="line">            <span class="keyword">set</span> myScriptArgumentB to <span class="keyword">get</span> value name nameB</div>
<div class="line">        end tell</div>
<div class="line">        --Display the script argument values in a dialog box.</div>
<div class="line">        display dialog nAc &amp; myScriptArgumentA &amp; <span class="keywordflow">return</span> &amp; nBc &amp; myScriptArgumentB</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_controlling_undo_with_do_script"></a>
Controlling Undo with do Script</h2>
<p>InDesign gives you the ability to undo almost every action, but this comes at a price: for almost every action you make, InDesign writes to disk. For normal work you using the tools presented by the user interface, this does not present any problem. For scripts, which can perform thousands of actions in the time a human being can blink, the constant disk access can be a serious drag on performance.</p>
<p>The do script command offers a way around this performance bottleneck by providing two parameters that control the way that scripts are executed relative to InDesign's Undo behavior. These parameters are shown in the following examples:</p>
<div class="fragment"><div class="line">--Given a script <span class="stringliteral">&quot;myAppleScript&quot;</span> and an array of parameters <span class="stringliteral">&quot;myParameters&quot;</span>...</div>
<div class="line">tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line"><span class="keywordflow">do</span> script myJavaScript language javascript with arguments myArguments undo mode fast </div>
<div class="line">entire script undo name <span class="stringliteral">&quot;Script Action&quot;</span></div>
<div class="line">end tell</div>
<div class="line"></div>
<div class="line">--undo modes can be:</div>
<div class="line">--<span class="keyword">auto</span> unto: Add no events to the Undo queue.</div>
<div class="line">--entire script: Put a single <span class="keyword">event</span> in the Undo queue.</div>
<div class="line">--fast entire script: Put a single <span class="keyword">event</span> in the Undo queue.</div>
<div class="line">--script request: Undo each script action as a separate <span class="keyword">event</span>.</div>
<div class="line">--The last parameter is the text that appears in the Undo menu item.</div>
</div><!-- fragment --><h2><a class="anchor" id="id_as_working_with_script_labels"></a>
Working with Script Labels</h2>
<p>Many objects in InDesign scripting have a label property, including page items (rectangles, ovals, groups, polygons, text frames, and graphic lines), table cells, documents, stories, and pages. This property can store a very large amount of text.</p>
<p>The label of page items can be viewed, entered, or edited using the Script Label panel (choose Window &gt; Utilities &gt; Script Label to display this panel), shown below. You also can add a label to an object using scripting, and you can read the script label via scripting. For many objects, like stories, pages, and paragraph styles, you cannot set or view the label using the Script Label panel. </p>
<div class="image">
<img src="InDesign_ScriptingGuide-1.gif" alt="InDesign_ScriptingGuide-1.gif"/>
</div>
<p>The label property can contain any form of text data, such as tab- or comma-delimited text, HTML, or XML. Because scripts also are text, they can be stored in the label property.</p>
<p>Page items can be referred to by their label, just like named items (such as paragraph styles, colors, or layers) can be referred to by their name. The following script fragment demonstrates this special case of the label property (for the complete script, see ScriptLabels): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to make document</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myPageWidth to page width of document preferences of myDocument</div>
<div class="line">        <span class="keyword">set</span> myPageHeight to page height of document preferences of myDocument</div>
<div class="line">        --Create 10 random page items.</div>
<div class="line">        repeat with i from 1 to 10</div>
<div class="line">            <span class="keyword">set</span> myX1 to my myGetRandom(0, myPageWidth, <span class="keyword">false</span>)</div>
<div class="line">            set myY1 to my myGetRandom(0, myPageHeight, false)</div>
<div class="line">            set myX2 to my myGetRandom(0, myPageWidth, false)</div>
<div class="line">            set myY2 to my myGetRandom(0, myPageHeight, false)</div>
<div class="line">            tell myPage</div>
<div class="line">                set myRectangle to make rectangle �</div>
<div class="line">                    with properties {geometric bounds:{myY1, myX1, myY2, myX2}}</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keywordflow">if</span> my myGetRandom(0, 1, <span class="keyword">true</span>) = 1 then</div>
<div class="line">                <span class="keyword">set</span> label of myRectangle to <span class="stringliteral">&quot;myScriptLabel&quot;</span></div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">        end repeat</div>
<div class="line">        <span class="keyword">set</span> myCount to 0</div>
<div class="line">        repeat with i from 1 to count of page items of myPage</div>
<div class="line">            <span class="keywordflow">if</span> label of page item i of myPage is <span class="stringliteral">&quot;myScriptLabel&quot;</span> then</div>
<div class="line">                <span class="keyword">set</span> myCount to myCount + 1</div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">        end repeat</div>
<div class="line">        display dialog (<span class="stringliteral">&quot;Found &quot;</span> &amp; myCount &amp; <span class="stringliteral">&quot; page items with the label.&quot;</span>)</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">--This <span class="keyword">function</span> gets a random number in the range myStart to myEnd.</div>
<div class="line">on myGetRandom(myStart, myEnd, myInteger)</div>
<div class="line">    set myRange to myEnd - myStart</div>
<div class="line">    if myInteger = true then</div>
<div class="line">        set myRandom to myStart + (random number from myStart to myEnd)</div>
<div class="line">    else</div>
<div class="line">        set myRandom to myStart + (random number from myStart to myEnd) as integer</div>
<div class="line">    end if</div>
<div class="line">    return myRandom</div>
<div class="line">end myGetRandom</div>
</div><!-- fragment --><p> In addition, all objects that support the label property also support custom labels. A script can set a custom label using the insert label method, and extract the custom label using the extract label method, as shown in the following script fragment (from the CustomLabel tutorial script): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myRectangle to rectangle 1 of myPage</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myRectangle to make rectangle with properties {geometric bounds:{72, 72, 144, 144}}</div>
<div class="line">            --Insert a custom label <span class="keyword">using</span> insert label. The first parameter is the</div>
<div class="line">            --name of the label, the second is the text to add to the label.</div>
<div class="line">            tell myRectangle</div>
<div class="line">                insert label key <span class="stringliteral">&quot;CustomLabel&quot;</span> value <span class="stringliteral">&quot;This is some text stored in a custom label.&quot;</span></div>
<div class="line">                --Extract the text from the label and display it in an alert.</div>
<div class="line">                <span class="keyword">set</span> myString to extract label key <span class="stringliteral">&quot;CustomLabel&quot;</span></div>
<div class="line">            end tell</div>
<div class="line">            display dialog (<span class="stringliteral">&quot;Custom label contained: &quot;</span> &amp; myString)</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_running_scripts_at_startup"></a>
Running Scripts at Startup</h2>
<p>To run a script when InDesign starts, put the script in the Startup Scripts folder in the Scripts folder (for more information, see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing Scripts</a> in Adobe InDesign Scripting Tutorial).</p>
<h1><a class="anchor" id="id_as_documents"></a>
Documents</h1>
<p>The work you do in InDesign revolves around documents-creating them, saving them, printing or exporting them, and populating them with page items, colors, styles, and text. Almost every document-related task can be automated using InDesign scripting.</p>
<p>We assume that you have already read <a class="el" href="id_scripting_tutorial.html">Adobe InDesign Scripting Tutorial</a> and know how to create, install, and run a script.</p>
<h2><a class="anchor" id="id_as_basic_document_operations"></a>
Basic Document Operations</h2>
<p>Opening, closing, and saving documents are some of the most basic document tasks. This section shows how to do them using scripting.</p>
<h3><a class="anchor" id="id_as_creating_a_new_document"></a>
Creating a new document</h3>
<p>The following script shows how to make a new document using scripting. (For the complete script, see MakeDocument.) </p>
<div class="fragment"><div class="line">    --Creates a <span class="keyword">new</span> document.</div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to make document</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> To create a document using a document preset, the make command includes an optional parameter you can use to specify a document preset, as shown in the following script. (For the complete script, see MakeDocumentWithPreset.)</p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        --Replace <span class="stringliteral">&quot;myDocumentPreset&quot;</span> in the following line with the name </div>
<div class="line">        --of the document preset you want to use.</div>
<div class="line">        <span class="keyword">set</span> myDocument to make document with properties {document preset:<span class="stringliteral">&quot;myDocumentPreset&quot;</span>}</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> You can create a document without displaying it in a window, as shown in the following script fragment (from the MakeDocumentWithParameters tutorial script):</p>
<div class="fragment"><div class="line">    --Creates a <span class="keyword">new</span> document without showing the document window.</div>
<div class="line">    --The <span class="stringliteral">&quot;showing window&quot;</span> parameter controls the visibility of the document.</div>
<div class="line">    --Hidden documents are not minimized, and will remain invisible until</div>
<div class="line">    --you tell the document to create a <span class="keyword">new</span> window.</div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to make document with properties {showing window:<span class="keyword">false</span>}</div>
<div class="line">        --To show the window:</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myWindow to make window</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> Some script operations are much faster when the document window is hidden.</p>
<h3><a class="anchor" id="id_as_opening_a_document"></a>
Opening a document</h3>
<p>The following script shows how to open an existing document. (For the complete script, see OpenDocument.)</p>
<div class="fragment"><div class="line">        --Opens an existing document. You<span class="stringliteral">&#39;ll have to fill in your own file path</span></div>
<div class="line"><span class="stringliteral">        --in the variable &quot;myFile&quot;.</span></div>
<div class="line"><span class="stringliteral">        set myDocument to open myFile</span></div>
</div><!-- fragment --><p> You can choose to prevent the document from displaying (that is, hide it) by setting the showing window parameter of the open command to false (the default is true). You might want to do this to improve performance of a script. To show a hidden document, create a new window, as shown in the following script fragment (from the OpenDocumentInBackground tutorial script):</p>
<div class="fragment"><div class="line">        --Opens an existing document. You<span class="stringliteral">&#39;ll have to fill in your own file path</span></div>
<div class="line"><span class="stringliteral">        --in the variable &quot;myFile&quot;.</span></div>
<div class="line"><span class="stringliteral">        set myDocument to open myFile without showing window</span></div>
<div class="line"><span class="stringliteral">        --At this point, you can do things with the document without showing the</span></div>
<div class="line"><span class="stringliteral">        --document window. This can speed up many scripting</span></div>
<div class="line"><span class="stringliteral">        --operations, and makes it possible for a script to operate</span></div>
<div class="line"><span class="stringliteral">        --on a file in the background.</span></div>
<div class="line"><span class="stringliteral">        display dialog (&quot;Document is open but not visible&quot;)</span></div>
<div class="line"><span class="stringliteral">        --Show the document.</span></div>
<div class="line"><span class="stringliteral">        tell myDocument to make window</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_saving_a_document"></a>
Saving a document</h3>
<p>In the InDesign user interface, you save a file by choosing File &gt; Save, and you save a file to another file name by choosing File &gt; Save As. In InDesign scripting, the save command can do either operation, as shown in the following script fragment (from the SaveDocument tutorial script):</p>
<div class="fragment"><div class="line">        --Given a document myDocument...</div>
<div class="line">        --If the document has been changed since it was last saved, save it.</div>
<div class="line">        --If the file is untitled, InDesign will display the Save dialog box.</div>
<div class="line">        <span class="keywordflow">if</span> modified of myDocument is <span class="keyword">true</span> then</div>
<div class="line">            tell myDocument to save</div>
<div class="line">        end <span class="keywordflow">if</span></div>
</div><!-- fragment --><p> The save command has two optional parameters: The first (to) specifies the file to save to; the second (stationery) can be set to true to save the document as a template, as shown in the following script fragment (from the SaveDocumentAs tutorial script):</p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDesktopFolder to path to desktop as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFile to myDesktopFolder &amp; <span class="stringliteral">&quot;SaveDocumentAsDuplicate.indd&quot;</span></div>
<div class="line">        tell document 1 to save to myFile</div>
</div><!-- fragment --><p> You can save a document as a template, as shown in the following script fragment (from the SaveAsTemplate tutorial script):</p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            <span class="keywordflow">if</span> saved is <span class="keyword">true</span> then</div>
<div class="line">                --Convert the file name to a <span class="keywordtype">string</span>.</div>
<div class="line">                <span class="keyword">set</span> myFileName to full name</div>
<div class="line">                <span class="keyword">set</span> myFileName to my myReplace(myFileName, <span class="stringliteral">&quot;.indd&quot;</span>, <span class="stringliteral">&quot;.indt&quot;</span>)</div>
<div class="line">            else</div>
<div class="line">                --If the document has not been saved, then give it a default file</div>
<div class="line">                --name/file path. You&#39;ll have to fill in the file path in the variable &quot;myPath&quot;.</div>
<div class="line">                set myFileName to my myReplace(myPath, &quot;.indd&quot;, &quot;.indt&quot;)</div>
<div class="line">                set myFileName to myPath</div>
<div class="line">            end if</div>
<div class="line">            save to myFileName with stationery</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_closing_a_document"></a>
Closing a document</h3>
<p>The close command closes a document, as shown in the following script fragment (from the CloseDocument tutorial script):</p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        close document 1</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> The close command can take up to two optional parameters, as shown in the following script fragment (from the CloseWithParameters tutorial script):</p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        --Close the active document with parameters:</div>
<div class="line">        --Use <span class="stringliteral">&quot;saving yes&quot;</span> to save the document,</div>
<div class="line">        --or <span class="stringliteral">&quot;saving no&quot;</span>  to close the document without saving, </div>
<div class="line">        --or <span class="stringliteral">&quot;saving ask&quot;</span> to display a prompt.</div>
<div class="line">        --If you use <span class="stringliteral">&quot;saving yes&quot;</span>, you<span class="stringliteral">&#39;ll need to provide a reference </span></div>
<div class="line"><span class="stringliteral">        --to a file to save to in the second parameter.</span></div>
<div class="line"><span class="stringliteral">        --If the file has never been saved (it&#39;</span>s an untitled file), </div>
<div class="line">        --display a prompt. </div>
<div class="line">        <span class="keywordflow">if</span> saved of myDocument is not equal to <span class="keyword">true</span> then</div>
<div class="line">            close myDocument saving ask</div>
<div class="line">            --Or, to save to a specific file name </div>
<div class="line">            --(you<span class="stringliteral">&#39;ll have to fill in your own file path in the variable &quot;myPath&quot;):</span></div>
<div class="line"><span class="stringliteral">            --close myDocument saving yes saving in myPath</span></div>
<div class="line"><span class="stringliteral">        else</span></div>
<div class="line"><span class="stringliteral">            --If the file has already been saved to a file, save it.</span></div>
<div class="line"><span class="stringliteral">            close myDocument saving yes</span></div>
<div class="line"><span class="stringliteral">        end if</span></div>
<div class="line"><span class="stringliteral">    end tell</span></div>
</div><!-- fragment --><p> You can close all open documents without saving them, as shown in the following script fragment (from the CloseAll tutorial script): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        tell documents to close saving no</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_basic_page_layout"></a>
Basic Page Layout</h2>
<p>Each document has a default page size, assigned number of pages, bleed and slug working areas, and columns and margins to define the area into which material is placed. Again, all these parameters are accessible to scripting, as shown in the examples in this section.</p>
<h3><a class="anchor" id="id_as_defining_page_size_and_document_length"></a>
Defining page size and document length</h3>
<p>When you create a new document using the InDesign user interface, you can specify the default page size, number of pages, page orientation, and whether the document uses facing pages. To create a document using InDesign scripting, use the make document command, which does not specify these settings. After creating a document, you can use the document preferences object to control the settings, as shown in the following script fragment (from the DocumentPreferences tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell document preferences of myDocument</div>
<div class="line">            <span class="keyword">set</span> page height to <span class="stringliteral">&quot;800pt&quot;</span></div>
<div class="line">            <span class="keyword">set</span> page width to <span class="stringliteral">&quot;600pt&quot;</span></div>
<div class="line">            <span class="keyword">set</span> page orientation to landscape</div>
<div class="line">            <span class="keyword">set</span> pages per document to 16</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The application object also has a document preferences object. You can set the application defaults for page height, page width, and other properties by changing the properties of this object. You can also set individual page sizes; see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_adjusting_page_sizes_and_layout">Adjusting Page Sizes and Layout</a>.</dd></dl>
<h3><a class="anchor" id="id_as_defining_bleed_and_slug_areas"></a>
Defining bleed and slug areas</h3>
<p>Within InDesign, a bleed or a slug is an area outside the page margins that can be printed or included in an exported PDF. Typically, these areas are used for objects that extend beyond the page edges (bleed) and job/document information (slug). The two areas can be printed and exported independently; for example, you might want to omit slug information for the final printing of a document. The following script shows how to set up the bleed and slug for a new document. (For the complete script, see BleedAndSlug.) </p>
<div class="fragment"><div class="line">        --The bleed and slug properties belong to the document preferences <span class="keywordtype">object</span>.</div>
<div class="line">        tell document preferences of myDocument</div>
<div class="line">            --Bleed</div>
<div class="line">            <span class="keyword">set</span> document bleed bottom offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> document bleed top offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> document bleed inside or left offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> document bleed outside or right offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            --Slug</div>
<div class="line">            <span class="keyword">set</span> slug bottom offset to <span class="stringliteral">&quot;18p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> slug top offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> slug inside or left offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> slug right or outside offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> Alternately, if all the bleed distances are equal, as in the preceding example, you can use the document bleed uniform size property, as shown in the following script fragment (from the UniformBleed tutorial script): </p>
<div class="fragment"><div class="line">        --The bleed properties belong to the document preferences <span class="keywordtype">object</span>.</div>
<div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell document preferences of myDocument</div>
<div class="line">            --Bleed</div>
<div class="line">            <span class="keyword">set</span> document bleed top offset to <span class="stringliteral">&quot;2p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> document bleed uniform size to <span class="keyword">true</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> If all the slug distances are equal, you can use the document slug uniform size property, as shown in the following script fragment (from the UniformSlug tutorial script): </p>
<div class="fragment"><div class="line">        --The slug properties belong to the document preferences <span class="keywordtype">object</span>.</div>
<div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell document preferences of myDocument</div>
<div class="line">            --Bleed</div>
<div class="line">            <span class="keyword">set</span> slug top offset to <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> document slug uniform size to <span class="keyword">true</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> In addition to setting the bleed and slug widths and heights, you can control the color used to draw the guides defining the bleed and slug. This property is not in the document preferences object; instead, it is in the pasteboard preferences object, as shown in the following script fragment (from the BleedSlugGuideColors tutorial script): </p>
<div class="fragment"><div class="line">        --Given an open document...</div>
<div class="line">        tell pasteboard preferences of document 1</div>
<div class="line">            --Any of InDesign<span class="stringliteral">&#39;s guides can use the UIColors constants...</span></div>
<div class="line"><span class="stringliteral">            set bleed guide color to cute teal</span></div>
<div class="line"><span class="stringliteral">            set slug guide color to charcoal</span></div>
<div class="line"><span class="stringliteral">            --...or you can specify a list of RGB values (with values from 0 to 255)</span></div>
<div class="line"><span class="stringliteral">            set bleed guide color to {0, 198, 192}</span></div>
<div class="line"><span class="stringliteral">            set slug guide color to {192, 192, 192}</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_setting_page_margins_and_columns"></a>
Setting page margins and columns</h3>
<p>Each page in a document can have its own margin and column settings. With InDesign scripting, these properties are part of the margin preferences object for each page. This following sample script creates a new document, then sets the margins and columns for all pages in the master spread. (For the complete script, see PageMargins.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell view preferences of myDocument</div>
<div class="line">            <span class="keyword">set</span> horizontal measurement units to points</div>
<div class="line">            <span class="keyword">set</span> vertical measurement units to points</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell margin preferences of myPage</div>
<div class="line">            <span class="keyword">set</span> top to 56</div>
<div class="line">            <span class="keyword">set</span> bottom to 24</div>
<div class="line">            --When facingPages of document preferences of myDocument is <span class="keyword">true</span>,</div>
<div class="line">            --<span class="stringliteral">&quot;left&quot;</span> means inside and <span class="stringliteral">&quot;right&quot;</span> means outside.</div>
<div class="line">            <span class="keyword">set</span> left to 48</div>
<div class="line">            <span class="keyword">set</span> right to 10</div>
<div class="line">        end tell</div>
<div class="line">        --The following applies to <span class="keyword">new</span> pages when they are added.</div>
<div class="line">        tell margin preferences of myDocument</div>
<div class="line">            <span class="keyword">set</span> top to 56</div>
<div class="line">            <span class="keyword">set</span> bottom to 24</div>
<div class="line">            <span class="keyword">set</span> left to 48</div>
<div class="line">            <span class="keyword">set</span> right to 10</div>
<div class="line">        end tell</div>
<div class="line">        --The following works on all pages of your <span class="keywordflow">default</span> master spread.</div>
<div class="line">        tell master spread 1 of myDocument</div>
<div class="line">            tell margin preferences of pages</div>
<div class="line">                <span class="keyword">set</span> top to 56</div>
<div class="line">                <span class="keyword">set</span> bottom to 24</div>
<div class="line">                <span class="keyword">set</span> left to 48</div>
<div class="line">                <span class="keyword">set</span> right to 10</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> To set the page margins for an individual page, use the margin preferences for that page, as shown in the following script fragment (from the PageMarginsForOnePage tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell margin preferences of myPage</div>
<div class="line">            <span class="keyword">set</span> column count to 3</div>
<div class="line">            --column gutter can be a number or a measurement <span class="keywordtype">string</span>.</div>
<div class="line">            <span class="keyword">set</span> column gutter to <span class="stringliteral">&quot;1p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> top to <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> bottom to <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">            --When facingPages of document preferences of myDocument is <span class="keyword">true</span>,</div>
<div class="line">            --<span class="stringliteral">&quot;left&quot;</span> means inside and <span class="stringliteral">&quot;right&quot;</span> means outside.</div>
<div class="line">            <span class="keyword">set</span> left to <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> right to <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> InDesign does not allow you to create a page that is smaller than the sum of the relevant margins; that is, the width of the page must be greater than the sum of the left and right page margins, and the height of the page must be greater than the sum of the top and bottom margins. If you are creating very small pages (for example, for individual newspaper advertisements) using the InDesign user interface, you can easily set the correct margin sizes as you create the document, by entering new values in the document default page Margin fields in the New Document dialog box.</p>
<p>From scripting, however, the solution is not as clear: when you create a document, it uses the application's default-margin preferences. These margins are applied to all pages of the document, including master pages. Setting the document margin preferences affects only new pages and has no effect on existing pages. If you try to set the page height and page width to values smaller than the sum of the corresponding margins on any existing pages, InDesign does not change the page size.</p>
<p>There are two solutions. The first is to set the margins of the existing pages before you try to change the page size, as shown in the following script fragment (from the PageMarginsForSmallPages tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        --The following assumes that your document contains a single page.</div>
<div class="line">        tell margin preferences of myPage</div>
<div class="line">            <span class="keyword">set</span> top to 0</div>
<div class="line">            <span class="keyword">set</span> left to 0</div>
<div class="line">            <span class="keyword">set</span> bottom to 0</div>
<div class="line">            <span class="keyword">set</span> right to 0</div>
<div class="line">        end tell</div>
<div class="line">        --The following prevents errors when <span class="keyword">new</span> pages are added.</div>
<div class="line">        tell margin preferences of myDocument</div>
<div class="line">            <span class="keyword">set</span> top to 0</div>
<div class="line">            <span class="keyword">set</span> left to 0</div>
<div class="line">            <span class="keyword">set</span> bottom to 0</div>
<div class="line">            <span class="keyword">set</span> right to 0</div>
<div class="line">        end tell</div>
<div class="line">        --The following assumes that your <span class="keywordflow">default</span> master spread contains two pages.</div>
<div class="line">        tell master spread 1 of myDocument</div>
<div class="line">            tell margin preferences of pages</div>
<div class="line">                <span class="keyword">set</span> top to 0</div>
<div class="line">                <span class="keyword">set</span> left to 0</div>
<div class="line">                <span class="keyword">set</span> bottom to 0</div>
<div class="line">                <span class="keyword">set</span> right to 0</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">        --At <span class="keyword">this</span> point, you can <span class="keyword">set</span> your page size to a small width and height</div>
<div class="line">        ---(1x1 picas minimum).</div>
<div class="line">        <span class="keyword">set</span> page height of document preferences of myDocument to <span class="stringliteral">&quot;1p&quot;</span></div>
<div class="line">        <span class="keyword">set</span> page width of document preferences of myDocument to <span class="stringliteral">&quot;6p&quot;</span></div>
</div><!-- fragment --><p> Alternately, you can change the application's default-margin preferences before you create the document, as shown in the following script fragment (from the ApplicationPageMargins tutorial script): </p>
<div class="fragment"><div class="line">        tell margin preferences</div>
<div class="line">            --Save the current application <span class="keywordflow">default</span> margin preferences.</div>
<div class="line">            <span class="keyword">set</span> myY1 to top</div>
<div class="line">            <span class="keyword">set</span> myX1 to left</div>
<div class="line">            <span class="keyword">set</span> myY2 to bottom</div>
<div class="line">            <span class="keyword">set</span> myX2 to right</div>
<div class="line">            --Set the application <span class="keywordflow">default</span> margin preferences.</div>
<div class="line">            <span class="keyword">set</span> top to 0</div>
<div class="line">            <span class="keyword">set</span> left to 0</div>
<div class="line">            <span class="keyword">set</span> bottom to 0</div>
<div class="line">            <span class="keyword">set</span> right to 0</div>
<div class="line">        end tell</div>
<div class="line">        --Create a <span class="keyword">new</span> example document to demonstrate the change.</div>
<div class="line">        <span class="keyword">set</span> myDocument to make document</div>
<div class="line">        --At <span class="keyword">this</span> point, you can <span class="keyword">set</span> your page size to a small width and</div>
<div class="line">        --height (1x1 picas minimum).</div>
<div class="line">        <span class="keyword">set</span> page height of document preferences of myDocument to <span class="stringliteral">&quot;1p&quot;</span></div>
<div class="line">        <span class="keyword">set</span> page width of document preferences of myDocument to <span class="stringliteral">&quot;1p&quot;</span></div>
<div class="line">        --Reset the application <span class="keywordflow">default</span> margin preferences to their former state.</div>
<div class="line">        tell margin preferences</div>
<div class="line">            <span class="keyword">set</span> top to myY1</div>
<div class="line">            <span class="keyword">set</span> left to myX1</div>
<div class="line">            <span class="keyword">set</span> bottom to myY2</div>
<div class="line">            <span class="keyword">set</span> right to myX2</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_changing_the_appearance_of_the_pasteboard"></a>
Changing the appearance of the pasteboard</h3>
<p>The pasteboard is the area that surrounds InDesign pages and spreads. You can use it for temporary storage of page items or for job-tracking information. You can change the size of the pasteboard and its color using scripting. The preview background color property sets the color of the pasteboard in Preview mode, as shown in the following script fragment (from the PasteboardPreferences tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell pasteboard preferences of myDocument</div>
<div class="line">            --You can use either a number or a measurement <span class="keywordtype">string</span></div>
<div class="line">            --to <span class="keyword">set</span> minimum horizontal and vertical pasteboard margins</div>
<div class="line">            <span class="keyword">set</span> pasteboard margins to {<span class="stringliteral">&quot;12p&quot;</span>, <span class="stringliteral">&quot;15p&quot;</span>}</div>
<div class="line">            --You can <span class="keyword">set</span> the preview background color (which you<span class="stringliteral">&#39;ll only see</span></div>
<div class="line"><span class="stringliteral">            --in Preview mode) to any of the predefined UIColor constants...</span></div>
<div class="line"><span class="stringliteral">            set preview background color to gray</span></div>
<div class="line"><span class="stringliteral">            --...or you can specify an array of RGB values</span></div>
<div class="line"><span class="stringliteral">            --   (with values from 0 to 255)</span></div>
<div class="line"><span class="stringliteral">            set preview background color to {192, 192, 192}</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_guides_and_grids"></a>
Guides and grids</h3>
<p>Guides and grids make it easy to position objects on your document pages. These are very useful items to add when you are creating templates for others to use.</p>
<p><b>Defining guides</b></p>
<p>Guides in InDesign give you an easy way to position objects on the pages of your document. The following script fragment shows how to use guides. (For the complete script, see Guides.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myPageWidth to page width of document preferences of myDocument</div>
<div class="line">        <span class="keyword">set</span> myPageHeight to page height of document preferences of myDocument</div>
<div class="line">        <span class="keyword">set</span> myMarginPreferences to margin preferences of myPage</div>
<div class="line">        tell myPage</div>
<div class="line">            --Place guides at the margins of the page.)</div>
<div class="line">            set myLeft to left of myMarginPreferences</div>
<div class="line">            set myRight to right of myMarginPreferences</div>
<div class="line">            set myTop to top of myMarginPreferences</div>
<div class="line">            set myBottom to bottom of myMarginPreferences</div>
<div class="line">            set myHeight to myPageHeight</div>
<div class="line">            set myWidth to myPageWidth</div>
<div class="line">            --Left and right.</div>
<div class="line">            make guide with properties {orientation:vertical, location:myLeft}</div>
<div class="line">            make guide with properties {orientation:vertical, location:myWidth - myRight}</div>
<div class="line">            --Top and bottom.</div>
<div class="line">            make guide with properties {orientation:horizontal, location:myTop}</div>
<div class="line">            make guide with properties {orientation:horizontal, location:myHeight - myBottom}</div>
<div class="line">            --Place a guide at the vertical center of the page.</div>
<div class="line">            make guide with properties {orientation:vertical, location:myPageWidth / 2}</div>
<div class="line">            --Place a guide at the horizontal center of the page.</div>
<div class="line">            make guide with properties {orientation:horizontal, location:myPageHeight / 2}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> Horizontal guides can be limited to a given page or extend across all pages in a spread. From InDesign scripting, you can control this using the fit to page property. This property is ignored by vertical guides.</p>
<p>You can use scripting to change the layer, color, and visibility of guides, just as you can from the user interface, as shown in the following script fragment (from the GuideOptions tutorial script):</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myPage to page 1</div>
<div class="line">            --Create a layer named <span class="stringliteral">&quot;guide layer&quot;</span>.</div>
<div class="line">            <span class="keyword">set</span> myLayer to make layer with properties {name:<span class="stringliteral">&quot;guide layer&quot;</span>}</div>
<div class="line">            --Add a series of guides to page 1.</div>
<div class="line">            tell myPage</div>
<div class="line">                --Create a guide on the layer we created above.</div>
<div class="line">                make guide with properties {orientation:horizontal, location:<span class="stringliteral">&quot;12p&quot;</span>, item layer:myLayer}</div>
<div class="line">                make guide with properties {item layer:myLayer, orientation:horizontal, location:<span class="stringliteral">&quot;14p&quot;</span>}</div>
<div class="line">                --Make a locked guide.</div>
<div class="line">                make guide with properties {locked:<span class="keyword">true</span>, orientation:horizontal, location:<span class="stringliteral">&quot;16p&quot;</span>}</div>
<div class="line">                --Set the view threshold of a guide.</div>
<div class="line">                make guide with properties {view threshold:100, orientation:horizontal, location:<span class="stringliteral">&quot;18p&quot;</span>}</div>
<div class="line">                --Set the guide color of a guide <span class="keyword">using</span> a UIColors constant.</div>
<div class="line">                make guide with properties {guide color:gray, orientation:horizontal, location:<span class="stringliteral">&quot;20p&quot;</span>}</div>
<div class="line">                --Set the guide color of a guide <span class="keyword">using</span> an RGB array.</div>
<div class="line">                make guide with properties {guide color:{192, 192, 192}, orientation:horizontal, location:<span class="stringliteral">&quot;22p&quot;</span>}</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> You also can create guides using the create guides command on spreads and master spreads, as shown in the following script fragment (from the CreateGuides tutorial script):</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        <span class="keyword">set</span> myLayer to layer 1 of myDocument</div>
<div class="line">        tell spread 1 of myDocument</div>
<div class="line">            --Parameters (all optional): row count, column count, row gutter,</div>
<div class="line">            --column gutter, guide color, fit margins, remove existing, layer.</div>
<div class="line">            --Note that the createGuides method does not take an RGB array for</div>
<div class="line">            --the guide color parameter.</div>
<div class="line">            create guides number of rows 4 number of columns 4 row gutter <span class="stringliteral">&quot;1p&quot;</span> column gutter <span class="stringliteral">&quot;1p&quot;</span> guide color gray with fit margins and remove existing</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> <b>Setting grid preferences</b></p>
<p>To control the properties of the document and baseline grid, you set the properties of the grid preferences object, as shown in the following script fragment (from the DocumentAndBaselineGrid tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> horizontal measurement units of view preferences of myDocument to points</div>
<div class="line">        <span class="keyword">set</span> vertical measurement units of view preferences of myDocument to points</div>
<div class="line">        tell grid preferences of myDocument</div>
<div class="line">            <span class="keyword">set</span> baseline start to 56</div>
<div class="line">            <span class="keyword">set</span> baseline division to 14</div>
<div class="line">            <span class="keyword">set</span> baseline grid shown to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> horizontal gridline division to 14</div>
<div class="line">            <span class="keyword">set</span> horizontal grid subdivision to 5</div>
<div class="line">            <span class="keyword">set</span> vertical gridline division to 14</div>
<div class="line">            <span class="keyword">set</span> vertical grid subdivision to 5</div>
<div class="line">            <span class="keyword">set</span> document grid shown to <span class="keyword">true</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> <b>Snapping to guides and grids</b></p>
<p>All snap settings for a document's grids and guides are in the properties of the guide preferences and grid preferences objects. The following script fragment shows how to set guide and grid snap properties. (For the complete script, see GuideGridPreferences.)</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        --Guide Preferences</div>
<div class="line">        tell guide preferences of myDocument</div>
<div class="line">            <span class="keyword">set</span> guides in back to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> guides locked to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> guides shown to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> guides snapto to <span class="keyword">true</span></div>
<div class="line">            --Set the ruler guide color by UI color name:</div>
<div class="line">            <span class="keyword">set</span> ruler guides color to cute teal</div>
<div class="line">            --Set the ruler guide color <span class="keyword">using</span> a list of RGB values:</div>
<div class="line">            <span class="keyword">set</span> ruler guides color to {0, 198, 192}</div>
<div class="line">            --Set the ruler view threshold (magnification at which guides appear).</div>
<div class="line">            <span class="keyword">set</span> ruler guides view threshold to 50</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myBaselineStart to top of page of baseline grid relative option</div>
<div class="line">        <span class="keyword">set</span> myBaselineStart to top of margin of baseline grid relative option</div>
<div class="line">        --Grid Preferences</div>
<div class="line">        tell grid preferences of myDocument</div>
<div class="line">            --Baseline Grid</div>
<div class="line">            <span class="keyword">set</span> baseline start to <span class="stringliteral">&quot;2in&quot;</span></div>
<div class="line">            <span class="keyword">set</span> baseline grid relative option to myBaselineStart</div>
<div class="line">            --Set the ruler guide color by UI color name:</div>
<div class="line">            <span class="keyword">set</span> baseline color to light blue</div>
<div class="line">            --Set the ruler guide color <span class="keyword">using</span> a list of RGB values:</div>
<div class="line">            <span class="keyword">set</span> baseline color to [0, 198, 192]</div>
<div class="line">            <span class="keyword">set</span> baseline division to <span class="stringliteral">&quot;22pt&quot;</span></div>
<div class="line">            <span class="keyword">set</span> baseline grid shown to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> baseline view threshold to 75</div>
<div class="line">            --Document Grid</div>
<div class="line">            <span class="keyword">set</span> document grid snapto to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> document grid shown to <span class="keyword">false</span></div>
<div class="line">            --Set the grid color by UI color name:</div>
<div class="line">            <span class="keyword">set</span> grid color to charcoal</div>
<div class="line">            --Set the grid color <span class="keyword">using</span> a list of RGB values:</div>
<div class="line">            <span class="keyword">set</span> grid color to {192, 192, 192}</div>
<div class="line">            --Set spacing of the grid based on current measurement units (inches).</div>
<div class="line">            <span class="keyword">set</span> horizontal gridline division to 1</div>
<div class="line">            <span class="keyword">set</span> horizontal grid subdivision to 4</div>
<div class="line">            <span class="keyword">set</span> vertical gridline division to 1</div>
<div class="line">            <span class="keyword">set</span> vertical grid subdivision to 4</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_changing_measurement_units_and_ruler"></a>
Changing measurement units and ruler</h3>
<p>Thus far, the sample scripts used measurement strings, strings that force InDesign to use a specific measurement unit (for example, "8.5i" for 8.5 inches). They do this because you might be using a different measurement system when you run the script.</p>
<p>To specify the measurement system used in a script, use the document's view preferences object, as shown in the following script fragment (from the ViewPreferences tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell view preferences of myDocument</div>
<div class="line">            --Measurement unit choices are:</div>
<div class="line">            --picas, points, inches, inches decimal, </div>
<div class="line">            --millimeters, centimeters, or ciceros</div>
<div class="line">            --Set horizontal and vertical measurement units to points.</div>
<div class="line">            <span class="keyword">set</span> horizontal measurement units to points</div>
<div class="line">            <span class="keyword">set</span> vertical measurement units to points</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> If you are writing a script that needs to use a specific measurement system, you can change the measurement units at the beginning of the script, then restore the original measurement units at the end of the script. This is shown in the following script fragment (from the ResetMeasurementUnits tutorial script):</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell view preferences of myDocument</div>
<div class="line">            <span class="keyword">set</span> myOldXUnits to horizontal measurement units</div>
<div class="line">            <span class="keyword">set</span> myOldYUnits to vertical measurement units</div>
<div class="line">            <span class="keyword">set</span> horizontal measurement units to points</div>
<div class="line">            <span class="keyword">set</span> vertical measurement units to points</div>
<div class="line">        end tell</div>
<div class="line">        --At <span class="keyword">this</span> point, you can perform any series of script actions that depend on</div>
<div class="line">        --the measurement units you<span class="stringliteral">&#39;ve set. At the end of the script, reset</span></div>
<div class="line"><span class="stringliteral">        --the measurement units to their original state.</span></div>
<div class="line"><span class="stringliteral">        tell view preferences of myDocument</span></div>
<div class="line"><span class="stringliteral">            set horizontal measurement units to myOldXUnits</span></div>
<div class="line"><span class="stringliteral">            set vertical measurement units to myOldYUnits</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_defining_and_applying_document_presets"></a>
Defining and applying document presets</h3>
<p>InDesign document presets enable you to store and apply common document set-up information (page size, page margins, columns, and bleed and slug areas). When you create a new document, you can base the document on a document preset.</p>
<p><b>Creating a preset by copying values</b></p>
<p>To create a document preset using an existing document's settings as an example, open a document that has the document set-up properties you want to use in the document preset, then run the following script (from the DocumentPresetByExample tutorial script):</p>
<div class="fragment"><div class="line">            --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">            --If the document preset <span class="stringliteral">&quot;myDocumentPreset&quot;</span> does not already exist, create it.  </div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myDocumentPreset to document preset <span class="stringliteral">&quot;myDocumentPreset&quot;</span></div>
<div class="line">            on error</div>
<div class="line">                <span class="keyword">set</span> myDocumentPreset to make document preset with properties {name:<span class="stringliteral">&quot;myDocumentPreset&quot;</span>}</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            --Fill in the properties of the document preset with the corresponding</div>
<div class="line">            --properties of the active document.</div>
<div class="line">            tell myDocumentPreset</div>
<div class="line">                --Note that the following gets the page margins from the margin preferences</div>
<div class="line">                --of the document; to <span class="keyword">get</span> the margin preferences from the active page,</div>
<div class="line">                --replace <span class="stringliteral">&quot;myDocument&quot;</span> with <span class="stringliteral">&quot;active page of active window&quot;</span> in the</div>
<div class="line">                --following line (assuming the active window is a layout window).</div>
<div class="line">                <span class="keyword">set</span> myMarginPreferences to margin preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> left to left of myMarginPreferences</div>
<div class="line">                <span class="keyword">set</span> right to right of myMarginPreferences</div>
<div class="line">                <span class="keyword">set</span> top to top of myMarginPreferences</div>
<div class="line">                <span class="keyword">set</span> bottom to bottom of myMarginPreferences</div>
<div class="line">                <span class="keyword">set</span> column count to column count of myMarginPreferences</div>
<div class="line">                <span class="keyword">set</span> column gutter to column gutter of myMarginPreferences</div>
<div class="line">                <span class="keyword">set</span> document bleed bottom offset to document bleed bottom offset of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> document bleed top offset to document bleed top offset of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> document bleed inside or left offset to document bleed inside or left offset of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> document bleed outside or right offset to document bleed outside or right offset of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> facing pages to facing pages of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> page height to page height of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> page width to page width of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> page orientation to page orientation of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> pages per document to pages per document of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> slug bottom offset to slug bottom offset of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> slug top offset to slug top offset of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> slug inside or left offset to slug inside or left offset of document preferences of myDocument</div>
<div class="line">                <span class="keyword">set</span> slug right or outside offset to slug right or outside offset of document preferences of myDocument</div>
<div class="line">            end tell</div>
</div><!-- fragment --><p> <b>Creating a document preset</b></p>
<p>To create a document preset using explicit values, run the following script (from the DocumentPreset tutorial script):</p>
<div class="fragment"><div class="line">        --If the document preset <span class="stringliteral">&quot;myDocumentPreset&quot;</span> does not already exist, create it.  </div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">            <span class="keyword">set</span> myDocumentPreset to document preset <span class="stringliteral">&quot;myDocumentPreset&quot;</span></div>
<div class="line">        on error</div>
<div class="line">            <span class="keyword">set</span> myDocumentPreset to make document preset with properties {name:<span class="stringliteral">&quot;myDocumentPreset&quot;</span>}</div>
<div class="line">        end <span class="keywordflow">try</span></div>
<div class="line">        --Fill in the properties of the document preset.</div>
<div class="line">        tell myDocumentPreset</div>
<div class="line">            <span class="keyword">set</span> page height to <span class="stringliteral">&quot;9i&quot;</span></div>
<div class="line">            <span class="keyword">set</span> page width to <span class="stringliteral">&quot;7i&quot;</span></div>
<div class="line">            <span class="keyword">set</span> left to <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> right to <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> top to <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> bottom to <span class="stringliteral">&quot;9p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> column count to 1</div>
<div class="line">            <span class="keyword">set</span> document bleed bottom offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> document bleed top offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> document bleed inside or left offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> document bleed outside or right offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> facing pages to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> page orientation to portrait</div>
<div class="line">            <span class="keyword">set</span> pages per document to 1</div>
<div class="line">            <span class="keyword">set</span> slug bottom offset to <span class="stringliteral">&quot;18p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> slug top offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> slug inside or left offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">            <span class="keyword">set</span> slug right or outside offset to <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_setting_up_master_spreads"></a>
Setting up master spreads</h3>
<p>After setting up the basic document page size, slug, and bleed, you probably will want to define the document's master spreads. The following script shows how to do that. (For the complete script, see MasterSpread.)</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        --Set the document<span class="stringliteral">&#39;s ruler origin to page origin. This is very important.</span></div>
<div class="line"><span class="stringliteral">        --If you don&#39;</span>t <span class="keywordflow">do</span> <span class="keyword">this</span>, getting objects to the correct position on the</div>
<div class="line">        --page is much more difficult.</div>
<div class="line">        <span class="keyword">set</span> ruler origin of view preferences of myDocument to page origin</div>
<div class="line">        tell master spread 1 of myDocument</div>
<div class="line">            --Set up the left page (verso).</div>
<div class="line">            tell margin preferences of page 1</div>
<div class="line">                <span class="keyword">set</span> column count to 3</div>
<div class="line">                <span class="keyword">set</span> column gutter to <span class="stringliteral">&quot;1p&quot;</span></div>
<div class="line">                <span class="keyword">set</span> bottom to <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">                --<span class="stringliteral">&quot;left&quot;</span> means inside, <span class="stringliteral">&quot;right&quot;</span> means outside.</div>
<div class="line">                <span class="keyword">set</span> left to <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">                <span class="keyword">set</span> right to <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">                <span class="keyword">set</span> top to <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">            end tell</div>
<div class="line">            --Add a simple footer with a section number and page number.</div>
<div class="line">            tell page 1</div>
<div class="line">                <span class="keyword">set</span> myBounds to {<span class="stringliteral">&quot;61p&quot;</span>, <span class="stringliteral">&quot;4p&quot;</span>, <span class="stringliteral">&quot;62p&quot;</span>, <span class="stringliteral">&quot;45p&quot;</span>}</div>
<div class="line">                <span class="keyword">set</span> myTextFrame to make text frame with properties {geometric bounds:myBounds}</div>
<div class="line">                tell myTextFrame</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 to section marker</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 to Em space</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 to <span class="keyword">auto</span> page number</div>
<div class="line">                    <span class="keyword">set</span> justification of paragraph 1 to left align</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">            --Set up the right page (recto).</div>
<div class="line">            tell margin preferences of page 2</div>
<div class="line">                <span class="keyword">set</span> column count to 3</div>
<div class="line">                <span class="keyword">set</span> column gutter to <span class="stringliteral">&quot;1p&quot;</span></div>
<div class="line">                <span class="keyword">set</span> bottom to <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">                --<span class="stringliteral">&quot;left&quot;</span> means inside, <span class="stringliteral">&quot;right&quot;</span> means outside.</div>
<div class="line">                <span class="keyword">set</span> left to <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">                <span class="keyword">set</span> right to <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">                <span class="keyword">set</span> top to <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">            end tell</div>
<div class="line">            --Add a simple footer with a section number and page number.</div>
<div class="line">            tell page 2</div>
<div class="line">                <span class="keyword">set</span> myB to {<span class="stringliteral">&quot;61p&quot;</span>, <span class="stringliteral">&quot;6p&quot;</span>, <span class="stringliteral">&quot;62p&quot;</span>, <span class="stringliteral">&quot;47p&quot;</span>}</div>
<div class="line">                <span class="keyword">set</span> myTextFrame to make text frame with properties {geometric bounds:myBounds}</div>
<div class="line">                tell myTextFrame</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 to <span class="keyword">auto</span> page number</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 to Em space</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 to section marker</div>
<div class="line">                    <span class="keyword">set</span> justification of paragraph 1 to right align</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> To apply a master spread to a document page, use the applied master property of the document page, as shown in the following script fragment (from the ApplyMaster tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myPage to make page</div>
<div class="line">            <span class="keyword">set</span> applied master of myPage to master spread <span class="stringliteral">&quot;B-Master&quot;</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> Use the same property to apply a master spread to a master spread page, as shown in the following script fragment (from the ApplyMasterToMaster tutorial script):</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myMasterSpread to master spread 1</div>
<div class="line">            --Create a <span class="keyword">new</span> master spread.</div>
<div class="line">            <span class="keyword">set</span> myNewMasterSpread to make master spread</div>
<div class="line">            --Apply the first (<span class="keywordflow">default</span>) master spread to the first page of the new master spread.</div>
<div class="line">            set myMasterPage to page 1 of myNewMasterSpread</div>
<div class="line">            set applied master of myMasterPage to myMasterSpread</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_adding_xmp_metadata"></a>
Adding XMP metadata</h3>
<p>Metadata is information that describes the content, origin, or other attributes of a file. In the InDesign user interface, you enter, edit, and view metadata using the File Info dialog (choose File &gt; File Info). This metadata includes the document's creation and modification dates, author, copyright status, and other information. All this information is stored using XMP (Adobe Extensible Metadata Platform), an open standard for embedding metadata in a document.</p>
<p>To learn more about XMP, see the XMP specification at <a href="http://partners.adobe.com/asn/developer/pdf/MetadataFramework.pdf">http://partners.adobe.com/asn/developer/pdf/MetadataFramework.pdf </a>.</p>
<p>You also can add XMP information to a document using InDesign scripting. All XMP properties for a document are in the document's metadataPreferences object. The example below fills in the standard XMP data for a document.</p>
<p>This example also shows that XMP information is extensible. If you need to attach metadata to a document and the data does not fall into a category provided by the metadata preferences object, you can create your own metadata container (email, in this example). (For the complete script, see MetadataExample.)</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell metadata preferences of myDocument</div>
<div class="line">            <span class="keyword">set</span> author to <span class="stringliteral">&quot;Adobe&quot;</span></div>
<div class="line">            <span class="keyword">set</span> copyright info URL to <span class="stringliteral">&quot;http://www.adobe.com&quot;</span></div>
<div class="line">            <span class="keyword">set</span> copyright notice to <span class="stringliteral">&quot;This document is copyrighted.&quot;</span></div>
<div class="line">            <span class="keyword">set</span> copyright status to yes</div>
<div class="line">            <span class="keyword">set</span> description to <span class="stringliteral">&quot;Example of xmp metadata scripting in InDesign CC&quot;</span></div>
<div class="line">            <span class="keyword">set</span> document title to <span class="stringliteral">&quot;XMP Example&quot;</span></div>
<div class="line">            <span class="keyword">set</span> job name to <span class="stringliteral">&quot;XMP_Example_2008&quot;</span></div>
<div class="line">            <span class="keyword">set</span> keywords to {<span class="stringliteral">&quot;animal&quot;</span>, <span class="stringliteral">&quot;mineral&quot;</span>, <span class="stringliteral">&quot;vegetable&quot;</span>}</div>
<div class="line">            --The metadata preferences <span class="keywordtype">object</span> also includes the read-only</div>
<div class="line">            --creator, format, creationDate, modificationDate, and server URL</div>
<div class="line">            --properties that are automatically entered and maintained by</div>
<div class="line">            --InDesign.</div>
<div class="line">            --Create a custom XMP container, <span class="stringliteral">&quot;email&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myS to <span class="stringliteral">&quot;http://ns.adobe.com/xap/1.0/&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myNewContainer to create container item <span class="keyword">namespace </span>myS path &quot;email&quot;</div>
<div class="line">            set property namespace myS path &quot;email<span class="comment">/*[1]&quot; value &quot;someone@adobe.com&quot;</span></div>
<div class="line"><span class="comment">        end tell</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_creating_a_document_template"></a>
Creating a document template</h3>
<p>This example creates a new document, defines slug and bleed areas, adds information to the document's XMP metadata, sets up master pages, adds page footers, and adds job information to a table in the slug area. (For the complete script, see DocumentTemplate.)</p>
<div class="fragment"><div class="line">        --Set the application <span class="keywordflow">default</span> margin preferences.</div>
<div class="line">        tell margin preferences</div>
<div class="line">            <span class="keyword">set</span> myY1 to top</div>
<div class="line">            <span class="keyword">set</span> myX1 to left</div>
<div class="line">            <span class="keyword">set</span> myY2 to bottom</div>
<div class="line">            <span class="keyword">set</span> myX2 to right</div>
<div class="line">            --Set the application <span class="keywordflow">default</span> margin preferences.</div>
<div class="line">            --Document baseline grid will be based on 14 points, and</div>
<div class="line">            --all margins are <span class="keyword">set</span> in increments of 14 points.</div>
<div class="line">            <span class="keyword">set</span> top to ((14 * 4) &amp; <span class="stringliteral">&quot;pt&quot;</span>) as <span class="keywordtype">string</span></div>
<div class="line">            set left to ((14 * 4) &amp; &quot;pt&quot;) as <span class="keywordtype">string</span></div>
<div class="line">            set bottom to &quot;74pt&quot;</div>
<div class="line">            set right to ((14 * 5) &amp; &quot;pt&quot;) as <span class="keywordtype">string</span></div>
<div class="line">        end tell</div>
<div class="line">        --Make a new document.</div>
<div class="line">        set myDocument to make document</div>
<div class="line">        --Reset the application default margin preferences.</div>
<div class="line">        tell margin preferences</div>
<div class="line">            set top to myY1</div>
<div class="line">            set left to myX1</div>
<div class="line">            set bottom to myY2</div>
<div class="line">            set right to myX2</div>
<div class="line">        end tell</div>
<div class="line">        tell myDocument</div>
<div class="line">            tell document preferences</div>
<div class="line">                set page width to &quot;7i&quot;</div>
<div class="line">                set page height to &quot;9i&quot;</div>
<div class="line">                set page orientation to portrait</div>
<div class="line">            end tell</div>
<div class="line">            --Set up the bleed and slug areas.</div>
<div class="line">            tell document preferences</div>
<div class="line">                --Bleed</div>
<div class="line">                set document bleed bottom offset to &quot;3p&quot;</div>
<div class="line">                set document bleed top offset to &quot;3p&quot;</div>
<div class="line">                set document bleed inside or left offset to &quot;3p&quot;</div>
<div class="line">                set document bleed outside or right offset to &quot;3p&quot;</div>
<div class="line">                --Slug</div>
<div class="line">                set slug bottom offset to &quot;18p&quot;</div>
<div class="line">                set slug top offset to &quot;3p&quot;</div>
<div class="line">                set slug inside or left offset to &quot;3p&quot;</div>
<div class="line">                set slug right or outside offset to &quot;3p&quot;</div>
<div class="line">            end tell</div>
<div class="line">            --Create a color.</div>
<div class="line">            try</div>
<div class="line">                set myColor to color &quot;PageNumberRed&quot;</div>
<div class="line">            on error</div>
<div class="line">                set myColor to make color with properties {name:<span class="stringliteral">&quot;PageNumberRed&quot;</span>, model:process, color value:{20, 100, 80, 10}}</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            --Next, <span class="keyword">set</span> up some <span class="keywordflow">default</span> styles.</div>
<div class="line">            --Create up a character style <span class="keywordflow">for</span> the page numbers.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myCharacterStyle to character style <span class="stringliteral">&quot;page_number&quot;</span></div>
<div class="line">            on error</div>
<div class="line">                <span class="keyword">set</span> myCharacterStyle to make character style with properties {name:<span class="stringliteral">&quot;page_number&quot;</span>}</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            <span class="keyword">set</span> fill color of myCharacterStyle to color <span class="stringliteral">&quot;PageNumberRed&quot;</span></div>
<div class="line">            --Create a pair of paragraph styles <span class="keywordflow">for</span> the page footer text.</div>
<div class="line">            --These styles have only basic formatting.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myParagraphStyle to paragraph style <span class="stringliteral">&quot;footer_left&quot;</span></div>
<div class="line">            on error</div>
<div class="line">                <span class="keyword">set</span> myParagraphStyle to make paragraph style with properties {name:<span class="stringliteral">&quot;footer_left&quot;</span>}</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            --Create a paragraph style <span class="keywordflow">for</span> the page footer text.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myParagraphStyle to paragraph style <span class="stringliteral">&quot;footer_right&quot;</span></div>
<div class="line">            on error</div>
<div class="line">                <span class="keyword">set</span> myParagraphStyle to make paragraph style with properties {name:<span class="stringliteral">&quot;footer_right&quot;</span>, based on:paragraph style <span class="stringliteral">&quot;footer_left&quot;</span>, justification:right align}</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            --Create a layer <span class="keywordflow">for</span> guides.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myLayer to layer <span class="stringliteral">&quot;GuideLayer&quot;</span></div>
<div class="line">            on error</div>
<div class="line">                <span class="keyword">set</span> myLayer to make layer with properties {name:<span class="stringliteral">&quot;GuideLayer&quot;</span>}</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            --Create a layer <span class="keywordflow">for</span> the footer items.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myLayer to layer <span class="stringliteral">&quot;Footer&quot;</span></div>
<div class="line">            on error</div>
<div class="line">                <span class="keyword">set</span> myLayer to make layer with properties {name:<span class="stringliteral">&quot;Footer&quot;</span>}</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            --Create a layer <span class="keywordflow">for</span> the slug items.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myLayer to layer <span class="stringliteral">&quot;Slug&quot;</span></div>
<div class="line">            on error</div>
<div class="line">                <span class="keyword">set</span> myLayer to make layer with properties {name:<span class="stringliteral">&quot;Slug&quot;</span>}</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            --Create a layer <span class="keywordflow">for</span> the body text.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myLayer to layer <span class="stringliteral">&quot;BodyText&quot;</span></div>
<div class="line">            on error</div>
<div class="line">                <span class="keyword">set</span> myLayer to make layer with properties {name:<span class="stringliteral">&quot;BodyText&quot;</span>}</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            tell view preferences</div>
<div class="line">                <span class="keyword">set</span> ruler origin to page origin</div>
<div class="line">                <span class="keyword">set</span> horizontal measurement units to points</div>
<div class="line">                <span class="keyword">set</span> vertical measurement units to points</div>
<div class="line">            end tell</div>
<div class="line">            --Document baseline grid and document grid</div>
<div class="line">            tell grid preferences</div>
<div class="line">                <span class="keyword">set</span> baseline start to 56</div>
<div class="line">                <span class="keyword">set</span> baseline division to 14</div>
<div class="line">                <span class="keyword">set</span> baseline grid shown to <span class="keyword">false</span></div>
<div class="line">                <span class="keyword">set</span> horizontal gridline division to 14</div>
<div class="line">                <span class="keyword">set</span> horizontal grid subdivision to 5</div>
<div class="line">                <span class="keyword">set</span> vertical gridline division to 14</div>
<div class="line">                <span class="keyword">set</span> vertical grid subdivision to 5</div>
<div class="line">                <span class="keyword">set</span> document grid shown to <span class="keyword">false</span></div>
<div class="line">            end tell</div>
<div class="line">            --Document XMP information.</div>
<div class="line">            tell metadata preferences</div>
<div class="line">                <span class="keyword">set</span> author to <span class="stringliteral">&quot;Olav Martin Kvern&quot;</span></div>
<div class="line">                <span class="keyword">set</span> copyright info URL to <span class="stringliteral">&quot;http:--www.adobe.com&quot;</span></div>
<div class="line">                <span class="keyword">set</span> copyright notice to <span class="stringliteral">&quot;This document is not copyrighted.&quot;</span></div>
<div class="line">                <span class="keyword">set</span> copyright status to no</div>
<div class="line">                <span class="keyword">set</span> description to <span class="stringliteral">&quot;Example 7 x 9 book layout&quot;</span></div>
<div class="line">                <span class="keyword">set</span> document title to <span class="stringliteral">&quot;Example&quot;</span></div>
<div class="line">                <span class="keyword">set</span> job name to <span class="stringliteral">&quot;7 x 9 book layout template&quot;</span></div>
<div class="line">                <span class="keyword">set</span> keywords to {<span class="stringliteral">&quot;7 x 9&quot;</span>, <span class="stringliteral">&quot;book&quot;</span>, <span class="stringliteral">&quot;template&quot;</span>}</div>
<div class="line">                <span class="keyword">set</span> myNewContainer to create container item <span class="keyword">namespace </span>&quot;http:<span class="comment">//ns.adobe.com/xap/1.0/&quot; path &quot;email&quot;</span></div>
<div class="line">                set property namespace &quot;http:<span class="comment">//ns.adobe.com/xap/1.0/&quot; path &quot;email/*[1]&quot; value &quot;okvern@adobe.com&quot;</span></div>
<div class="line">            end tell</div>
<div class="line">            set myPageHeight to page height of document preferences</div>
<div class="line">            set myPageWidth to page width of document preferences</div>
<div class="line">            --Set up the master spread.</div>
<div class="line">            tell master spread 1</div>
<div class="line">                tell page 1</div>
<div class="line">                    tell margin preferences</div>
<div class="line">                        --For a facing pages spread, the &quot;left&quot; margin is the inside</div>
<div class="line">                        --margin; the &quot;right&quot; margin is the outside margin.</div>
<div class="line">                        set myInsideMargin to left</div>
<div class="line">                        set myOutsideMargin to right</div>
<div class="line">                        set myTopMargin to top</div>
<div class="line">                        set myBottomMargin to bottom</div>
<div class="line">                    end tell</div>
<div class="line">                    set myBottomMargin to myPageHeight - myBottomMargin</div>
<div class="line">                    set myInsideMargin to myPageWidth - myInsideMargin</div>
<div class="line">                    make guide with properties {orientation:vertical, location:myInsideMargin, item layer:layer <span class="stringliteral">&quot;GuideLayer&quot;</span> of myDocument}</div>
<div class="line">                    make guide with properties {orientation:vertical, location:myOutsideMargin, item layer:layer <span class="stringliteral">&quot;GuideLayer&quot;</span> of myDocument}</div>
<div class="line">                    make guide with properties {orientation:horizontal, location:myTopMargin, item layer:layer <span class="stringliteral">&quot;GuideLayer&quot;</span> of myDocument, fit to page:<span class="keyword">false</span>}</div>
<div class="line">                    make guide with properties {orientation:horizontal, location:myBottomMargin, item layer:layer <span class="stringliteral">&quot;GuideLayer&quot;</span> of myDocument, fit to page:<span class="keyword">false</span>}</div>
<div class="line">                    make guide with properties {orientation:horizontal, location:myBottomMargin + 14, item layer:layer <span class="stringliteral">&quot;GuideLayer&quot;</span> of myDocument, fit to page:<span class="keyword">false</span>}</div>
<div class="line">                    make guide with properties {orientation:horizontal, location:myBottomMargin + 28, item layer:layer <span class="stringliteral">&quot;GuideLayer&quot;</span> of myDocument, fit to page:<span class="keyword">false</span>}</div>
<div class="line">                    <span class="keyword">set</span> myLeftFooter to make text frame with properties {item layer:layer <span class="stringliteral">&quot;Footer&quot;</span> of myDocument, geometric bounds:{myBottomMargin + 14, myOutsideMargin, myBottomMargin + 28, myInsideMargin}}</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 of parent story of myLeftFooter to section marker</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 of parent story of myLeftFooter to Em space</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 of parent story of myLeftFooter to <span class="keyword">auto</span> page number</div>
<div class="line">                    <span class="keyword">set</span> applied character style of character 1 of parent story of myLeftFooter to character style <span class="stringliteral">&quot;page_number&quot;</span> of myDocument</div>
<div class="line">                    <span class="keyword">set</span> applied paragraph style of paragraph 1 of parent story of myLeftFooter to paragraph style <span class="stringliteral">&quot;footer_left&quot;</span> of myDocument</div>
<div class="line">                    --Slug information.</div>
<div class="line">                    tell metadata preferences of myDocument</div>
<div class="line">                        <span class="keyword">set</span> myEmail to <span class="keyword">get</span> <span class="keyword">property</span> <span class="keyword">namespace </span>&quot;http:<span class="comment">//ns.adobe.com/xap/1.0/&quot; path &quot;email/*[1]&quot;</span></div>
<div class="line">                        set myDate to current date</div>
<div class="line">                        set myString to &quot;Author:&quot; &amp; tab &amp; author &amp; tab &amp; &quot;Description:&quot; &amp; tab &amp; description &amp; return &amp; &quot;Creation Date:&quot; &amp; tab &amp; myDate &amp; tab &amp; &quot;Email Contact&quot; &amp; tab &amp; myEmail</div>
<div class="line">                    end tell</div>
<div class="line">                    set myLeftSlug to make text frame with properties {item layer:layer <span class="stringliteral">&quot;Slug&quot;</span> of myDocument, geometric bounds:{myPageHeight + 36, myOutsideMargin, myPageHeight + 144, myInsideMargin}, contents:myString}</div>
<div class="line">                    tell parent story of myLeftSlug</div>
<div class="line">                        convert to table text 1</div>
<div class="line">                    end tell</div>
<div class="line">                    --Body text master text frame.</div>
<div class="line">                    <span class="keyword">set</span> myLeftFrame to make text frame with properties {item layer:layer <span class="stringliteral">&quot;BodyText&quot;</span> of myDocument, geometric bounds:{myTopMargin, myOutsideMargin, myBottomMargin, myInsideMargin}}</div>
<div class="line">                end tell</div>
<div class="line">                tell page 2</div>
<div class="line">                    tell margin preferences</div>
<div class="line">                        --For a facing pages spread, the <span class="stringliteral">&quot;left&quot;</span> margin is the inside</div>
<div class="line">                        --margin; the <span class="stringliteral">&quot;right&quot;</span> margin is the outside margin.</div>
<div class="line">                        <span class="keyword">set</span> myOutsideMargin to left</div>
<div class="line">                        <span class="keyword">set</span> myInsideMargin to right</div>
<div class="line">                    end tell</div>
<div class="line">                    <span class="keyword">set</span> myOutsideMargin to myPageWidth - myOutsideMargin</div>
<div class="line">                    make guide with properties {orientation:vertical, location:myInsideMargin, item layer:layer <span class="stringliteral">&quot;GuideLayer&quot;</span> of myDocument}</div>
<div class="line">                    make guide with properties {orientation:vertical, location:myOutsideMargin, item layer:layer <span class="stringliteral">&quot;GuideLayer&quot;</span> of myDocument}</div>
<div class="line">                    <span class="keyword">set</span> myRightFooter to make text frame with properties {item layer:layer <span class="stringliteral">&quot;Footer&quot;</span> of myDocument, geometric bounds:{myBottomMargin + 14, myInsideMargin, myBottomMargin + 28, myOutsideMargin}}</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 of parent story of myRightFooter to <span class="keyword">auto</span> page number</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 of parent story of myRightFooter to Em space</div>
<div class="line">                    <span class="keyword">set</span> contents of insertion point 1 of parent story of myRightFooter to section marker</div>
<div class="line">                    <span class="keyword">set</span> applied character style of character -1 of parent story of myRightFooter to character style <span class="stringliteral">&quot;page_number&quot;</span> of myDocument</div>
<div class="line">                    <span class="keyword">set</span> applied paragraph style of paragraph 1 of parent story of myRightFooter to paragraph style <span class="stringliteral">&quot;footer_right&quot;</span> of myDocument</div>
<div class="line">                    --Slug information.</div>
<div class="line">                    <span class="keyword">set</span> myRightSlug to make text frame with properties {item layer:layer <span class="stringliteral">&quot;Slug&quot;</span> of myDocument, geometric bounds:{myPageHeight + 36, myInsideMargin, myPageHeight + 144, myOutsideMargin}, contents:myString}</div>
<div class="line">                    tell parent story of myRightSlug</div>
<div class="line">                        convert to table text 1</div>
<div class="line">                    end tell</div>
<div class="line">                    --Body text master text frame.</div>
<div class="line">                    <span class="keyword">set</span> myRightFrame to make text frame with properties {item layer:layer <span class="stringliteral">&quot;BodyText&quot;</span> of myDocument, geometric bounds:{myTopMargin, myInsideMargin, myBottomMargin, myOutsideMargin}}</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">            --Add section marker text--<span class="keyword">this</span> text will appear in the footer.</div>
<div class="line">            <span class="keyword">set</span> marker of section 1 of myDocument to <span class="stringliteral">&quot;Section 1&quot;</span></div>
<div class="line">            --When you link the master page text frames, one of the frames sometimes becomes selected. Deselect it.</div>
<div class="line">            select nothing</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_creating_watermarks"></a>
Creating watermarks</h3>
<p>You can apply watermarks to documents in InDesign or InDesign Server using scripting. Currently, no user interface component exists in InDesign for managing watermarks.</p>
<p>A document's watermark preferences can be set in two ways using scripting:</p>
<ul>
<li>Application-level watermark preferences, if any are set, are applied to the document watermark preferences for each new document created by InDesign. This setting has no effect on existing documents.</li>
<li>Document-level watermark preferences apply only to that document. Setting or changing a document's watermark preferences replaces any previous watermark settings for the document.</li>
</ul>
<p>Both the document and application watermark preference settings persist after the document or application is closed until a script changes them.</p>
<p>The same group of watermark preferences exist for both the document and the application objects.</p>
<p><b>Setting watermark preferences</b></p>
<p>The following script fragment shows how to set watermarks at the application level. A watermark will be applied to all documents created after this code finishes. (For the complete script for setting application preferences, see ApplicationWatermark.) </p>
<div class="fragment"><div class="line">        tell watermark preferences</div>
<div class="line">            <span class="keyword">set</span> watermark visibility to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> watermark <span class="keywordflow">do</span> print to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> watermark draw in back to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> watermark text to <span class="stringliteral">&quot;Confidential&quot;</span></div>
<div class="line">            <span class="keyword">set</span> watermark font family to <span class="stringliteral">&quot;Arial&quot;</span></div>
<div class="line">            <span class="keyword">set</span> watermark font style to <span class="stringliteral">&quot;Bold&quot;</span></div>
<div class="line">            <span class="keyword">set</span> watermark font point size to 72</div>
<div class="line">            <span class="keyword">set</span> watermark font color to red</div>
<div class="line">            <span class="keyword">set</span> watermark opacity to 60</div>
<div class="line">            <span class="keyword">set</span> watermark rotation to -45</div>
<div class="line">            <span class="keyword">set</span> watermark horizontal position to watermark h center</div>
<div class="line">            <span class="keyword">set</span> watermark horizontal offset to 0</div>
<div class="line">            <span class="keyword">set</span> watermark vertical position to watermark v center</div>
<div class="line">            <span class="keyword">set</span> watermark vertical offset to 0</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The same preferences can be applied to a document object by referring to a document, rather than to the application. (For the complete script for setting document preferences, see DocumentWatermark.) </p>
<div class="fragment"><div class="line">        tell watermark preferences of document 1</div>
<div class="line">            <span class="keyword">set</span> watermark visibility to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> watermark <span class="keywordflow">do</span> print to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> watermark draw in back to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> watermark text to <span class="stringliteral">&quot;Confidential&quot;</span></div>
<div class="line">            <span class="keyword">set</span> watermark font family to <span class="stringliteral">&quot;Arial&quot;</span></div>
<div class="line">            <span class="keyword">set</span> watermark font style to <span class="stringliteral">&quot;Bold&quot;</span></div>
<div class="line">            <span class="keyword">set</span> watermark font point size to 72</div>
<div class="line">            <span class="keyword">set</span> watermark font color to blue</div>
<div class="line">            <span class="keyword">set</span> watermark opacity to 60</div>
<div class="line">            <span class="keyword">set</span> watermark rotation to -45</div>
<div class="line">            <span class="keyword">set</span> watermark horizontal position to watermark h center</div>
<div class="line">            <span class="keyword">set</span> watermark horizontal offset to 0</div>
<div class="line">            <span class="keyword">set</span> watermark vertical position to watermark v center</div>
<div class="line">            <span class="keyword">set</span> watermark vertical offset to 0</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> <b>Disabling watermarks</b></p>
<p>After turning off the application setting for watermarks, InDesign no longer turns on the watermark settings for new documents by default. However, you can still set watermarks for individual documents. The following script fragment shows how to turn off application-level watermarks. </p>
<div class="fragment"><div class="line"><span class="keyword">set</span> watermark visibility of watermark preferences to <span class="keyword">false</span></div>
</div><!-- fragment --><p>You can turn off watermarks in an individual document at any time, as shown in the following script fragment. </p>
<div class="fragment"><div class="line">tell document 1</div>
<div class="line">    <span class="keyword">set</span> watermark visibility of watermark preferences to <span class="keyword">false</span></div>
<div class="line">end tell</div>
</div><!-- fragment --><h2><a class="anchor" id="id_as_adjusting_page_sizes_and_layout"></a>
Adjusting Page Sizes and Layout</h2>
<p>InDesign allows different page sizes within a single InDesign document. For information on setting the default page size, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_defining_page_size_and_document_length">Defining page size and document length</a>.</p>
<p>You can also apply geometric transformations to individual pages.</p>
<h3><a class="anchor" id="id_as_selecting_pages"></a>
Selecting pages</h3>
<p>Before changing a page's size or applying a transformation to the page, you must select the page. In the InDesign user interface, you do this using the Page Tool on the Tools Panel. You can also select a page using scripting. The following script shows how. (For the complete script, see PageSelect.) </p>
<div class="fragment"><div class="line">        --Given a document with four pages (1, 2, 3, 4)...</div>
<div class="line">        <span class="keyword">set</span> myPages to pages of active document</div>
<div class="line">        --Select page 2 and 3.</div>
<div class="line">        select item 2 of myPages</div>
<div class="line">        select item 3 of myPages existing selection add to</div>
<div class="line">        --Select last page.</div>
<div class="line">        select item -1 of myPages existing selection add to</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_resizing_and_reframing_pages"></a>
Resizing and reframing pages</h3>
<p>You can resize or reframe page items on a page by scripting. You can also apply the resize and reframe operations to pages to change their sizes.</p>
<dl class="section note"><dt>Note</dt><dd>Your minimum page size is determined by the page's margins. See <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_setting_page_margins_and_columns">Setting page margins and columns</a> for more information.</dd></dl>
<p>The following script shows how to change a page's size using the resize method. (For the complete script, see PageResize.)</p>
<div class="fragment"><div class="line">        --Given a document with four pages (1, 2, 3, 4)...</div>
<div class="line">        tell pages of active document</div>
<div class="line">            --Resize page to two times bigger</div>
<div class="line">            resize item 2 in inner coordinates from center anchor by multiplying current dimensions by values {2, 2}</div>
<div class="line">            --Resize page to 400 points width and 600 points height.</div>
<div class="line">            resize item 3 in inner coordinates from center anchor by replacing current dimensions with values {400, 600}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> Reframing changes the bounding box of a page, so reframing can be used to change a page's size by making the bounding box larger or smaller. The following script shows how to change a page's size using the reframe method. (For the complete script, see PageReframe.)</p>
<div class="fragment"><div class="line">        --Given a document with four pages (1, 2, 3, 4)...</div>
<div class="line">        tell item 2 of pages of active document</div>
<div class="line">            --Make the page one inch wider and one inch higher.</div>
<div class="line">            <span class="keyword">set</span> myBounds to bounds</div>
<div class="line">            <span class="keyword">set</span> myY1 to item 1 of myBounds</div>
<div class="line">            <span class="keyword">set</span> myX1 to item 2 of myBounds</div>
<div class="line">            <span class="keyword">set</span> myY2 to (item 3 of myBounds) + 72</div>
<div class="line">            <span class="keyword">set</span> myX2 to (item 4 of myBounds) + 72</div>
<div class="line">            reframe in inner coordinates opposing corners {{myX1, myY1}, {myX2, myY2}}</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_transforming_pages"></a>
Transforming pages</h3>
<p>Operations that change the geometry of objects are called transformations. The transform method can rotate, scale, shear, and move (translate) page items on a page and can also be used on pages. For technical details about transformation architecture, refer to <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_transforming_page_items">Transforming Page Items</a>.</p>
<p>To transform a page:</p>
<ol type="1">
<li>Create a transformation matrix.</li>
<li>Apply the transformation matrix to the page using the transform method.</li>
</ol>
<p>The following script shows how to transform a page with scripting. (For the complete script, see PageTransform.)</p>
<div class="fragment"><div class="line">        --Given a document with four pages (1, 2, 3, 4)...</div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myPages to pages of myDocument</div>
<div class="line">        </div>
<div class="line">        --Rotate a page around its center point.</div>
<div class="line">        <span class="keyword">set</span> myRotateMatrix to make transformation matrix with properties {counterclockwise rotation angle:27}</div>
<div class="line">        my myTransform(item 1 of myPages, myRotateMatrix)</div>
<div class="line">        </div>
<div class="line">        --Scale a page around its center point.</div>
<div class="line">        <span class="keyword">set</span> myScaleMatrix to make transformation matrix with properties {horizontal scale factor:0.8, vertical scale factor:0.8}</div>
<div class="line">        my myTransform(item 2 of myPages, myScaleMatrix)</div>
<div class="line">        </div>
<div class="line">        --Shear a page around its center point.</div>
<div class="line">        <span class="keyword">set</span> myShearMatrix to make transformation matrix with properties {clockwise shear angle:30}</div>
<div class="line">        my myTransform(item 3 of myPages, myShearMatrix)</div>
</div><!-- fragment --><div class="fragment"><div class="line">on myTransform(myPage, myTransformationMatrix)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        transform myPage in pasteboard coordinates from center anchor with matrix myTransformationMatrix</div>
<div class="line">    end tell</div>
<div class="line">end myTransform</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_master_page_overlay"></a>
Master page overlay</h3>
<p>Because pages can have multiple sizes, it is possible for a page and its master page to be different sizes. In addition to tracking which master is applied, pages also maintain a matrix that determines how the master page draws on the page. This is called the Master Page Overlay. When you select a page using the Page Tool on the Tools Panel, you can see how the master page is positioned by checking the Show Master Page Overlay checkbox on the control panel. You can move the overlay around with the mouse. InDesign achieves this by applying a transform to the master overlay matrix. Although the user interface allows only translation (moving x and y), you can do more by scripting. The following script shows how to transform a master page overlay. (For the complete script, see MasterPageTransform.) </p>
<div class="fragment"><div class="line">        --Given a document with four pages (1, 2, 3, 4)...</div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myPages to pages of myDocument</div>
<div class="line">        </div>
<div class="line">        --Rotate master page overlay around its top-left corner.</div>
<div class="line">        <span class="keyword">set</span> myRotateMatrix to make transformation matrix with properties {counterclockwise rotation angle:27}</div>
<div class="line">        <span class="keyword">set</span> master page transform of item 1 of myPages to myRotateMatrix</div>
<div class="line">        </div>
<div class="line">        --Scale master page overlay around its top-left corner.</div>
<div class="line">        <span class="keyword">set</span> myScaleMatrix to make transformation matrix with properties {horizontal scale factor:0.5, vertical scale factor:0.5}</div>
<div class="line">        <span class="keyword">set</span> master page transform of item 2 of myPages to myScaleMatrix</div>
<div class="line">        </div>
<div class="line">        --Shear master page overlay around its top-left corner.</div>
<div class="line">        <span class="keyword">set</span> myShearMatrix to make transformation matrix with properties {clockwise shear angle:30}</div>
<div class="line">        <span class="keyword">set</span> master page transform of item 3 of myPages to myShearMatrix</div>
<div class="line">        </div>
<div class="line">        --Translate master page overlay 1 inch right and 2 inches down.</div>
<div class="line">        <span class="keyword">set</span> myTranslateMatrix to make transformation matrix with properties {horizontal translation:72, vertical translation:144}</div>
<div class="line">        <span class="keyword">set</span> master page transform of item 4 of myPages to myTranslateMatrix</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_making_an_adaptive_layout"></a>
Making an Adaptive Layout</h2>
<p>Using InDesign's layout adaptation workflow, you create your primary layout the same way that you would create it for a document that will be printed, but then you can quickly adapt that layout to another orientation, to another dimension or aspect ratio, or to a completely different device class. This workflow mainly involves two features: Liquid Layout makes the layout flexible, and Create Alternate Layout creates alternative layouts for different orientations and device classes.</p>
<h3><a class="anchor" id="id_as_making_a_flexible_layout"></a>
Making a flexible layout</h3>
<p>Using layout rules, a designer can create one InDesign file with one set of physical pages that can display their content suitably on different devices with different sizes and orientations. You can optionally control the pages' appearance for each size and orientation. The following example script shows how to do this. (For the complete script, see LiquidLayout.) </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to make document</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        -- Set layout rule to <span class="keywordtype">object</span> rule</div>
<div class="line">        tell myPage</div>
<div class="line">            --Reposition and resize objects on the page as it resizes.</div>
<div class="line">            <span class="keyword">set</span> layout rule to <span class="keywordtype">object</span> based</div>
<div class="line">            --Create a text frame on the first page.</div>
<div class="line">            <span class="keyword">set</span> myTextFrame to make text frame</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myTextFrame to my myGetBounds(myDocument, myPage)</div>
<div class="line">            set contents of myTextFrame to &quot;This is <span class="keywordtype">object</span> based layoutrule sample doc.&quot;</div>
<div class="line">            --Create a rectangle</div>
<div class="line">            set myItem to make rectangle</div>
<div class="line">            set geometric bounds of myItem to {20, 20, 70, 70}</div>
<div class="line">            <span class="keyword">set</span> vertical layout constraints of myItem to {flexible dimension, �</div>
<div class="line">                flexible dimension, flexible dimension}</div>
<div class="line">            <span class="keyword">set</span> horizontal layout constraints of myItem to {fixed dimension, �</div>
<div class="line">                flexible dimension, �</div>
<div class="line">                flexible dimension}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument2 to make document</div>
<div class="line">        <span class="keyword">set</span> myPage2 to page 1 of myDocument2</div>
<div class="line">        -- Set layout rule to scale</div>
<div class="line">        tell myPage2</div>
<div class="line">            --Scale objects on the page as it resizes.</div>
<div class="line">            <span class="keyword">set</span> layout rule to scale</div>
<div class="line">            --Create a text frame on the first page.</div>
<div class="line">            <span class="keyword">set</span> myTextFrame2 to make text frame</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myTextFrame2 to my myGetBounds(myDocument2, myPage2)</div>
<div class="line">            set contents of myTextFrame2 to &quot;This is scale layoutrule sample doc.&quot;</div>
<div class="line">            set myItem2 to make rectangle</div>
<div class="line">            set geometric bounds of myItem2 to {20, 20, 70, 70}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument3 to make document</div>
<div class="line">        <span class="keyword">set</span> myPage3 to page 1 of myDocument3</div>
<div class="line">        -- Set layout rule to recenter</div>
<div class="line">        tell myPage3</div>
<div class="line">            --Recenter objects on the page as it resizes.</div>
<div class="line">            <span class="keyword">set</span> layout rule to recenter</div>
<div class="line">            --Create a text frame on the first page.</div>
<div class="line">            <span class="keyword">set</span> myTextFrame3 to make text frame</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myTextFrame3 to my myGetBounds(myDocument3, myPage3)</div>
<div class="line">            set contents of myTextFrame3 to &quot;This is recenter layoutrule sample doc.&quot;</div>
<div class="line">            set myItem3 to make rectangle</div>
<div class="line">            set geometric bounds of myItem3 to {20, 20, 70, 70}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument4 to make document</div>
<div class="line">        <span class="keyword">set</span> myPage4 to page 1 of myDocument4</div>
<div class="line">        -- Set layout rule to guide based</div>
<div class="line">        tell myPage4</div>
<div class="line">            --objects based on the page as it resizes.</div>
<div class="line">            <span class="keyword">set</span> layout rule to guide based</div>
<div class="line">            --Create a text frame on the first page.</div>
<div class="line">            <span class="keyword">set</span> myTextFrame4 to make text frame</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myTextFrame4 to my myGetBounds(myDocument4, myPage4)</div>
<div class="line">            set contents of myTextFrame4 to &quot;This is guide based layoutrule sample doc.&quot;</div>
<div class="line">            set myItem4 to make rectangle</div>
<div class="line">            set geometric bounds of myItem4 to {20, 20, 70, 70}</div>
<div class="line">            make guide with properties {orientation:horizontal, location:<span class="stringliteral">&quot;20p&quot;</span>, guide type:liquid}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument5 to make document</div>
<div class="line">        <span class="keyword">set</span> myPage5 to page 1 of myDocument5</div>
<div class="line">        -- Set layout rule to use master</div>
<div class="line">        tell myPage5</div>
<div class="line">            --Use master on the page as it resizes.</div>
<div class="line">            <span class="keyword">set</span> layout rule to use master</div>
<div class="line">            --Create a text frame on the first page.</div>
<div class="line">            <span class="keyword">set</span> myTextFrame5 to make text frame</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myTextFrame5 to my myGetBounds(myDocument5, myPage5)</div>
<div class="line">            set contents of myTextFrame5 to &quot;This is master page layoutrule sample doc.&quot;</div>
<div class="line">            set myItem5 to make rectangle</div>
<div class="line">            set geometric bounds of myItem5 to {20, 20, 70, 70}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_adding_guides_for_a_guide-based_layout"></a>
Adding guides for a guide-based layout</h3>
<p>The following example script shows how to add guide slices for guide-based layout rules. (For the complete script, see AddGuides.) </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to make document</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> layout rule to guide based</div>
<div class="line">            <span class="keyword">set</span> myTextFrame to make text frame</div>
<div class="line">            --Set the bounds of the text frame.</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myTextFrame to my myGetBounds(myDocument, myPage)</div>
<div class="line">            --Enter text in the text frame.</div>
<div class="line">            <span class="keyword">set</span> contents of myTextFrame to <span class="stringliteral">&quot;This is guide-based layoutrule sample doc.&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myItem to make rectangle</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myItem to {20, 20, 70, 70}</div>
<div class="line">        end tell</div>
<div class="line">        tell myPage</div>
<div class="line">            make guide with properties {orientation:horizontal, location:<span class="stringliteral">&quot;20p&quot;</span>, guide type:liquid}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_setting_constraints_for_an_object-based_layout"></a>
Setting constraints for an object-based layout</h3>
<p>The following example script shows how to set constraints for object-based layout rules. (For the complete script, see SetConstraints.) </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to make document</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> layout rule to <span class="keywordtype">object</span> based</div>
<div class="line">            <span class="keyword">set</span> myTextFrame to make text frame</div>
<div class="line">            --Set the bounds of the text frame.</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myTextFrame to my myGetBounds(myDocument, myPage)</div>
<div class="line">            --Enter text in the text frame.</div>
<div class="line">            <span class="keyword">set</span> contents of myTextFrame to <span class="stringliteral">&quot;This is object-based layoutrule sample doc.&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myItem to make rectangle</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myItem to {20, 20, 70, 70}</div>
<div class="line">            <span class="keyword">set</span> vertical layout constraints of myItem to {flexible dimension, flexible dimension, flexible dimension}</div>
<div class="line">            <span class="keyword">set</span> horizontal layout constraints of myItem to {fixed dimension, flexible dimension, flexible dimension}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_creating_alternative_layouts"></a>
Creating alternative layouts</h3>
<p>Create Alternate Layout takes a range of existing pages with content and automatically creates linked copies of the content on a set of new pages within the same document. Use this when you need to create unique layouts for different orientations and device classes. (For the complete script, see CreateAlternateLayout.) </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to make document</div>
<div class="line">        tell document preferences of myDocument</div>
<div class="line">            <span class="keyword">set</span> facing pages to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> pages per document to 1</div>
<div class="line">            <span class="keyword">set</span> page width to 1024</div>
<div class="line">            <span class="keyword">set</span> page height to 768</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> layout rule to <span class="keywordtype">object</span> based</div>
<div class="line">            <span class="keyword">set</span> myItem to make rectangle</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myItem to {50, 50, 100, 100}</div>
<div class="line">        end tell</div>
<div class="line">        tell myDocument</div>
<div class="line">                create alternate layout spread items spreads</div>
<div class="line">                    name <span class="stringliteral">&quot;new layout&quot;</span></div>
<div class="line">                    width page height of document preferences</div>
<div class="line">                    height page width of document preferences</div>
<div class="line">                    layout rule preserve existing</div>
<div class="line">                    with create text styles and link text stories</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_collecting_and_dropping_content"></a>
Collecting and Dropping Content</h2>
<p>With Content Dropper, you can copy the content from a file designed for printing and paste it into another document.</p>
<p>The following script shows how to collect content in a document using scripting. (For the complete script, see ContentCollectorAndPlacer.) </p>
<div class="fragment"><div class="line">        --Invoke load with full parameters, then invoke Page.contentPlace with <span class="keywordflow">default</span> parameters</div>
<div class="line">        tell content placer <span class="keywordtype">object</span> 1</div>
<div class="line">            load page items myPolygon </div>
<div class="line">                with link page items, link stories, map styles and showing options</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script shows how to place collected content into another document. (For the complete script, see ContentCollectorAndPlacer.) </p>
<div class="fragment"><div class="line">        --Invoke Page.contentPlace with full parameters</div>
<div class="line">        tell myPage1</div>
<div class="line">            content place page items check boxes of myPage </div>
<div class="line">                with link page items, link stories, map styles and showing options</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_printing_a_document"></a>
Printing a Document</h2>
<p>The following script prints the active document using the current print preferences. (For the complete script, see PrintDocument.) </p>
<div class="fragment"><div class="line">        --The print statement has two optional varients:</div>
<div class="line">        --without print dialog -- <span class="keywordflow">do</span> not display the Print dialog box.</div>
<div class="line">        --<span class="keyword">using</span> <span class="stringliteral">&quot;presetName&quot;</span> -- use a named printer preset.</div>
<div class="line">        --The following line prints the document <span class="keyword">using</span> the <span class="keywordflow">default</span></div>
<div class="line">        --settings without displaying the Print dialog box.</div>
<div class="line">        print myDocument without print dialog</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_printing_using_page_ranges"></a>
Printing using page ranges</h3>
<p>To specify a page range to print, set the page range property of the document's print preferences object before printing, as shown in the following script fragment (from the PrintPageRange tutorial script): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            --The page range can be either all pages or a page range <span class="keywordtype">string</span>.</div>
<div class="line">            --A page number entered in the page range must correspond to a</div>
<div class="line">            --page name in the document (i.e., not the page index). If the page</div>
<div class="line">            -- name is not found, InDesign will display an error message.</div>
<div class="line">            <span class="keyword">set</span> page range of print preferences to <span class="stringliteral">&quot;1-3, 6&quot;</span></div>
<div class="line">            print without print dialog</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_setting_print_preferences"></a>
Setting print preferences</h3>
<p>The print preferences object contains properties corresponding to the options in the panels of the Print dialog. The following script shows how to set print preferences using scripting. (For the complete script, see PrintPreferences.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        --Get the bleed amounts from the document<span class="stringliteral">&#39;s bleed and add a bit.</span></div>
<div class="line"><span class="stringliteral">        tell document preferences of myDocument</span></div>
<div class="line"><span class="stringliteral">            set myX1Offset to document bleed inside or left offset + 3</span></div>
<div class="line"><span class="stringliteral">            set myY1Offset to document bleed top offset + 3</span></div>
<div class="line"><span class="stringliteral">            set myX2Offset to document bleed outside or right offset + 3</span></div>
<div class="line"><span class="stringliteral">            set myY2Offset to document bleed bottom offset + 3</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">        tell print preferences of myDocument</span></div>
<div class="line"><span class="stringliteral">            --Properties corresponding to the controls in the General panel of the</span></div>
<div class="line"><span class="stringliteral">            --Print dialog box. The active printer preset is ignored in this</span></div>
<div class="line"><span class="stringliteral">            --example--we&#39;</span>ll <span class="keyword">set</span> our own print preferences.</div>
<div class="line">            --printer can be either a string (the name of the printer) or</div>
<div class="line">            --postscript file.</div>
<div class="line">            <span class="keyword">set</span> printer to postscript file</div>
<div class="line">            --Here<span class="stringliteral">&#39;s an example of setting the printer to a specific printer.</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                --set printer to &quot;AGFA-SelectSet 5000SF v2013.108&quot;</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            --If the printer property is the name of a printer, then the ppd</span></div>
<div class="line"><span class="stringliteral">            --property is locked (and will return an error if you try to set it).</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                --set PPD to &quot;AGFA SelectSet 7000-X&quot;</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            --If the printer property is set to postscript file, the copies</span></div>
<div class="line"><span class="stringliteral">            --property is unavailable. Attempting to set it will generate an error.</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set copies to 1</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            --If the printer property is set to Printer.postscript file, or if the</span></div>
<div class="line"><span class="stringliteral">            --selected printer does not support collation, then the collating</span></div>
<div class="line"><span class="stringliteral">            --property is unavailable. Attempting to set it will generate an error.</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set collating to false</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            set reverse order to false</span></div>
<div class="line"><span class="stringliteral">            --The setting of color output determines the settings available</span></div>
<div class="line"><span class="stringliteral">            --to almost all other properties in the print preferences.</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set color output to separations</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            --pageRange can be either PageRange.allPages or a page range string.</span></div>
<div class="line"><span class="stringliteral">            set page range to all pages</span></div>
<div class="line"><span class="stringliteral">            set print spreads to false</span></div>
<div class="line"><span class="stringliteral">            set print master pages to false</span></div>
<div class="line"><span class="stringliteral">            --If the printer property is set to postScript file, then</span></div>
<div class="line"><span class="stringliteral">            --the print file property contains the file path to the output file.</span></div>
<div class="line"><span class="stringliteral">            --You&#39;</span>ll have to fill in your own file path.</div>
<div class="line">            <span class="keyword">set</span> printFile to <span class="stringliteral">&quot;yukino:test.ps&quot;</span></div>
<div class="line">            <span class="keyword">set</span> sequence to all</div>
<div class="line">            --If trapping is on, setting the following properties will produce an</div>
<div class="line">            --error.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keywordflow">if</span> trapping is off then</div>
<div class="line">                    <span class="keyword">set</span> print blank pages to <span class="keyword">false</span></div>
<div class="line">                    <span class="keyword">set</span> print guides grids to <span class="keyword">false</span></div>
<div class="line">                    <span class="keyword">set</span> print nonprinting to <span class="keyword">false</span></div>
<div class="line">                end <span class="keywordflow">if</span></div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            -------------------------------------------------------------------------</div>
<div class="line">            --Properties corresponding to the controls in the Setup panel of the</div>
<div class="line">            --Print dialog box.</div>
<div class="line">            -------------------------------------------------------------------------</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> paper size to custom</div>
<div class="line">                <span class="keyword">set</span> paper height to 1200</div>
<div class="line">                <span class="keyword">set</span> paper width to 1200</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> print page orientation to portrait</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> page position to centered</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> paper gap to 0</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> paper offset to 0</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> paper transverse to <span class="keyword">false</span></div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> scale height to 100</div>
<div class="line">                <span class="keyword">set</span> scale width to 100</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> scale mode to scale width height</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> scale proportional to <span class="keyword">true</span></div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            --If trapping is on (application built in or Adobe inRip), attempting to</div>
<div class="line">            --<span class="keyword">set</span> the following properties will produce an error.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keywordflow">if</span> trapping is off then</div>
<div class="line">                    <span class="keyword">set</span> thumbnails to <span class="keyword">false</span></div>
<div class="line">                    --The following <span class="keyword">property</span> is not needed because thumbnails is <span class="keyword">set</span></div>
<div class="line">                    --to <span class="keyword">false</span>.</div>
<div class="line">                    --<span class="keyword">set</span> thumbnails per page to 4</div>
<div class="line">                    <span class="keyword">set</span> tile to <span class="keyword">false</span></div>
<div class="line">                    --The following properties are not needed because tile is <span class="keyword">set</span> to</div>
<div class="line">                    --<span class="keyword">false</span>.</div>
<div class="line">                    --<span class="keyword">set</span> tiling overlap to 12</div>
<div class="line">                    --<span class="keyword">set</span> tiling type to <span class="keyword">auto</span></div>
<div class="line">                end <span class="keywordflow">if</span></div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            -------------------------------------------------------------------------</div>
<div class="line">            --Properties corresponding to the controls in the Marks and Bleed panel</div>
<div class="line">            --of the Print dialog box.</div>
<div class="line">            -------------------------------------------------------------------------</div>
<div class="line">            --Set the following <span class="keyword">property</span> to <span class="keyword">true</span> to print all printer<span class="stringliteral">&#39;s marks.</span></div>
<div class="line"><span class="stringliteral">            --set all Printer Marks to true;</span></div>
<div class="line"><span class="stringliteral">            set use document bleed to print to false</span></div>
<div class="line"><span class="stringliteral">            --If use document bleed to print is true then setting any of the  bleed</span></div>
<div class="line"><span class="stringliteral">            --properties will result in an error.</span></div>
<div class="line"><span class="stringliteral">            set bleed bottom to myY2Offset</span></div>
<div class="line"><span class="stringliteral">            set bleed top to myY1Offset</span></div>
<div class="line"><span class="stringliteral">            set bleed inside to myX1Offset</span></div>
<div class="line"><span class="stringliteral">            set bleed outside to myX2Offset</span></div>
<div class="line"><span class="stringliteral">            if (myY2Offset + myY1Offset + myX1Offset + myX2Offset) is not equal to 0 then</span></div>
<div class="line"><span class="stringliteral">                set bleed marks to true</span></div>
<div class="line"><span class="stringliteral">            else</span></div>
<div class="line"><span class="stringliteral">                set bleed marks to false</span></div>
<div class="line"><span class="stringliteral">            end if</span></div>
<div class="line"><span class="stringliteral">            set color bars to true</span></div>
<div class="line"><span class="stringliteral">            set crop marks to true</span></div>
<div class="line"><span class="stringliteral">            set include slug to print to false</span></div>
<div class="line"><span class="stringliteral">            set mark line weight to p125pt</span></div>
<div class="line"><span class="stringliteral">            set mark offset to 6</span></div>
<div class="line"><span class="stringliteral">            --set mark Type to default</span></div>
<div class="line"><span class="stringliteral">            set page information marks to true</span></div>
<div class="line"><span class="stringliteral">            set registration marks to true</span></div>
<div class="line"><span class="stringliteral">            -------------------------------------------------------------------------</span></div>
<div class="line"><span class="stringliteral">            --Properties corresponding to the controls in the Output panel of the</span></div>
<div class="line"><span class="stringliteral">            --Print dialog box.</span></div>
<div class="line"><span class="stringliteral">            -------------------------------------------------------------------------</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set negative to true</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set color output to separations</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            --Note the lowercase &quot;i&quot; in &quot;Builtin&quot;</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set trapping to application builtin</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set screening to &quot;175 lpi/2400 dpi&quot;</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set flip to none</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            --If trapping is on, attempting to set the following properties will</span></div>
<div class="line"><span class="stringliteral">            --generate an error.</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                if trapping is off then</span></div>
<div class="line"><span class="stringliteral">                    set print black to true</span></div>
<div class="line"><span class="stringliteral">                    set print cyan to true</span></div>
<div class="line"><span class="stringliteral">                    set print magenta to true</span></div>
<div class="line"><span class="stringliteral">                    set print yellow to true</span></div>
<div class="line"><span class="stringliteral">                end if</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            --Only change the ink angle and frequency when you want to override the</span></div>
<div class="line"><span class="stringliteral">            --screening set by the screening property.</span></div>
<div class="line"><span class="stringliteral">            --set black angle to 45</span></div>
<div class="line"><span class="stringliteral">            --set black frequency to 175</span></div>
<div class="line"><span class="stringliteral">            --set cyan angle to 15</span></div>
<div class="line"><span class="stringliteral">            --set cyan frequency to 175</span></div>
<div class="line"><span class="stringliteral">            --set magenta angle to 75</span></div>
<div class="line"><span class="stringliteral">            --set magenta frequency to 175</span></div>
<div class="line"><span class="stringliteral">            --set yellow angle to 0</span></div>
<div class="line"><span class="stringliteral">            --set yellow frequency to 175</span></div>
<div class="line"><span class="stringliteral">            --The following properties are not needed (because colorOutput is set to</span></div>
<div class="line"><span class="stringliteral">            --separations).</span></div>
<div class="line"><span class="stringliteral">            --set composite angle to 45</span></div>
<div class="line"><span class="stringliteral">            --set composite frequency to 175</span></div>
<div class="line"><span class="stringliteral">            --set simulate overprint to false</span></div>
<div class="line"><span class="stringliteral">            -------------------------------------------------------------------------</span></div>
<div class="line"><span class="stringliteral">            --Properties corresponding to the controls in the Graphics panel of the</span></div>
<div class="line"><span class="stringliteral">            --Print dialog box.</span></div>
<div class="line"><span class="stringliteral">            -------------------------------------------------------------------------</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set send image data to all image data</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            set font downloading to complete</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set download PPD fonts to true</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set data format to binary</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set PostScript level to level 3</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            -------------------------------------------------------------------------</span></div>
<div class="line"><span class="stringliteral">            --Properties corresponding to the controls in the Color Management panel</span></div>
<div class="line"><span class="stringliteral">            --of the Print dialog box.</span></div>
<div class="line"><span class="stringliteral">            -------------------------------------------------------------=-----------</span></div>
<div class="line"><span class="stringliteral">            --If the use color management property of color settings is false,</span></div>
<div class="line"><span class="stringliteral">            --attempting to set the following properties will return an error.</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set source space to use document</span></div>
<div class="line"><span class="stringliteral">                set intent to use color settings</span></div>
<div class="line"><span class="stringliteral">                set CRD to use document</span></div>
<div class="line"><span class="stringliteral">                set profile to PostScript CMS</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            -------------------------------------------------------------------------</span></div>
<div class="line"><span class="stringliteral">            --Properties corresponding to the controls in the Advanced panel of the</span></div>
<div class="line"><span class="stringliteral">            --Print dialog box.</span></div>
<div class="line"><span class="stringliteral">            -------------------------------------------------------------------------</span></div>
<div class="line"><span class="stringliteral">            set OPI image replacement to false</span></div>
<div class="line"><span class="stringliteral">            set omit bitmaps to false</span></div>
<div class="line"><span class="stringliteral">            set omit EPS to false</span></div>
<div class="line"><span class="stringliteral">            set omit PDF to false</span></div>
<div class="line"><span class="stringliteral">            --The following line assumes that you have a flattener preset named</span></div>
<div class="line"><span class="stringliteral">            --&quot;high quality flattener&quot;.</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set flattener preset name to &quot;high quality flattener&quot;</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            set ignore spread overrides to false</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_printing_with_printer_presets"></a>
Printing with printer presets</h3>
<p>To print a document using a printer preset, include the printer preset in the print command. </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a printer preset named <span class="stringliteral">&quot;myPrinterPreset&quot;</span>...</div>
<div class="line">        <span class="keyword">set</span> myPrinterPreset to printer preset <span class="stringliteral">&quot;myPrinterPreset&quot;</span></div>
<div class="line">        print myDocument <span class="keyword">using</span> myPrinterPreset without print dialog</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_exporting_a_document_as_pdf"></a>
Exporting a Document as PDF</h2>
<p>InDesign scripting offers full control over the creation of PDF files from your page-layout documents.</p>
<h3><a class="anchor" id="id_as_exporting_to_pdf"></a>
Exporting to PDF</h3>
<p>The following script exports the current document as PDF, using the current PDF export options. (For the complete script, see ExportPDF.) </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDesktopFolder to path to desktop as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFile to myDesktopFolder &amp; <span class="stringliteral">&quot;ExportAsPDF.pdf&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        tell myDocument</div>
<div class="line">            export format PDF type to myFile without showing options</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script fragment shows how to export to PDF using a PDF export preset. (For the complete script, see ExportPDFWithPreset.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument,&quot;</span> export a PDF to the desktop.</div>
<div class="line">        <span class="keyword">set</span> myDesktopFolder to path to desktop as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFile to myDesktopFolder &amp; <span class="stringliteral">&quot;ExportPDFWithPreset.pdf&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myPreset to <span class="stringliteral">&quot;[High Quality Print]&quot;</span></div>
<div class="line">        tell myDocument</div>
<div class="line">            export format PDF type to myFile <span class="keyword">using</span> myPreset without showing options</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_setting_pdf_export_options"></a>
Setting PDF export options</h3>
<p>The following script sets the PDF export options before exporting. (For the complete script, see ExportPDFWithOptions.)</p>
<div class="fragment"><div class="line">        --Get the bleed amounts from the document<span class="stringliteral">&#39;s bleed.</span></div>
<div class="line"><span class="stringliteral">        tell document preferences of myDocument</span></div>
<div class="line"><span class="stringliteral">            set myX1Offset to document bleed inside or left offset</span></div>
<div class="line"><span class="stringliteral">            set myY1Offset to document bleed top offset</span></div>
<div class="line"><span class="stringliteral">            set myX2Offset to document bleed outside or right offset</span></div>
<div class="line"><span class="stringliteral">            set myY2Offset to document bleed bottom offset</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">        tell PDF export preferences</span></div>
<div class="line"><span class="stringliteral">            --Basic PDF output options.</span></div>
<div class="line"><span class="stringliteral">            set page range to all pages</span></div>
<div class="line"><span class="stringliteral">            set acrobat compatibility to acrobat 6</span></div>
<div class="line"><span class="stringliteral">            set export guides and grids to false</span></div>
<div class="line"><span class="stringliteral">            set export layers to false</span></div>
<div class="line"><span class="stringliteral">            set export nonprinting objects to false</span></div>
<div class="line"><span class="stringliteral">            set export reader spreads to false</span></div>
<div class="line"><span class="stringliteral">            set generate thumbnails to false</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set ignore spread overrides to false</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            set include bookmarks to true</span></div>
<div class="line"><span class="stringliteral">            set include hyperlinks to true</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set include ICC profiles to true</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            set include slug with PDF to false</span></div>
<div class="line"><span class="stringliteral">            set include structure to false</span></div>
<div class="line"><span class="stringliteral">            set interactive elements option to do not include</span></div>
<div class="line"><span class="stringliteral">            --Setting subset fonts below to zero disallows font subsetting</span></div>
<div class="line"><span class="stringliteral">            --set subset fonts below to some other value to use font subsetting.</span></div>
<div class="line"><span class="stringliteral">            set subset fonts below to 0</span></div>
<div class="line"><span class="stringliteral">            --Bitmap compression/sampling/quality options.</span></div>
<div class="line"><span class="stringliteral">            set color bitmap compression to zip</span></div>
<div class="line"><span class="stringliteral">            set color bitmap quality to eight bit</span></div>
<div class="line"><span class="stringliteral">            set color bitmap sampling to none</span></div>
<div class="line"><span class="stringliteral">            --threshold to compress color is not needed in this example.</span></div>
<div class="line"><span class="stringliteral">            --color bitmap sampling dpi is not needed when color bitmap sampling is</span></div>
<div class="line"><span class="stringliteral">            --set to none.</span></div>
<div class="line"><span class="stringliteral">            set grayscale bitmap compression to zip</span></div>
<div class="line"><span class="stringliteral">            set grayscale bitmap quality to eight bit</span></div>
<div class="line"><span class="stringliteral">            set grayscale bitmap sampling to none</span></div>
<div class="line"><span class="stringliteral">            --threshold to compress gray is not needed in this example.</span></div>
<div class="line"><span class="stringliteral">            --grayscale bitmap sampling dpi is not needed when grayscale bitmap</span></div>
<div class="line"><span class="stringliteral">            --sampling is set to none.</span></div>
<div class="line"><span class="stringliteral">            set monochrome bitmap compression to zip</span></div>
<div class="line"><span class="stringliteral">            set monochrome bitmap sampling to none</span></div>
<div class="line"><span class="stringliteral">            --threshold to compress monochrome is not needed in this example.</span></div>
<div class="line"><span class="stringliteral">            --monochrome bitmap sampling dpi is not needed when monochrome bitmap</span></div>
<div class="line"><span class="stringliteral">            --sampling is set to none.</span></div>
<div class="line"><span class="stringliteral">            --Other compression options.</span></div>
<div class="line"><span class="stringliteral">            set compression type to Compress None</span></div>
<div class="line"><span class="stringliteral">            set compress text and line art to true</span></div>
<div class="line"><span class="stringliteral">            set crop images to frames to true</span></div>
<div class="line"><span class="stringliteral">            set optimize PDF to true</span></div>
<div class="line"><span class="stringliteral">            --Printers marks and prepress options.</span></div>
<div class="line"><span class="stringliteral">            set bleed bottom to myY2Offset</span></div>
<div class="line"><span class="stringliteral">            set bleed top to myY1Offset</span></div>
<div class="line"><span class="stringliteral">            set bleed inside to myX1Offset</span></div>
<div class="line"><span class="stringliteral">            set bleed outside to myX2Offset</span></div>
<div class="line"><span class="stringliteral">            --If any bleed area is greater than zero, then export the bleed marks.</span></div>
<div class="line"><span class="stringliteral">            set b1 to bleed bottom is equal to 0</span></div>
<div class="line"><span class="stringliteral">            set b2 to bleed top is equal to 0</span></div>
<div class="line"><span class="stringliteral">            set b3 to bleed inside is equal to 0</span></div>
<div class="line"><span class="stringliteral">            set b4 to bleed outside is equal to 0</span></div>
<div class="line"><span class="stringliteral">            if b1 and b2 and b3 and b4 then</span></div>
<div class="line"><span class="stringliteral">                set bleed marks to false</span></div>
<div class="line"><span class="stringliteral">            else</span></div>
<div class="line"><span class="stringliteral">                set bleed marks to true</span></div>
<div class="line"><span class="stringliteral">            end if</span></div>
<div class="line"><span class="stringliteral">            set color bars to true</span></div>
<div class="line"><span class="stringliteral">            --Color tile size and gray tile size are not used</span></div>
<div class="line"><span class="stringliteral">            --unless the compression method chosen is JPEG 2000.</span></div>
<div class="line"><span class="stringliteral">            --set color tile size to 256</span></div>
<div class="line"><span class="stringliteral">            --set Gray tile size to 256</span></div>
<div class="line"><span class="stringliteral">            set crop marks to true</span></div>
<div class="line"><span class="stringliteral">            set omit bitmaps to false</span></div>
<div class="line"><span class="stringliteral">            set omit EPS to false</span></div>
<div class="line"><span class="stringliteral">            set omit PDF to false</span></div>
<div class="line"><span class="stringliteral">            set page information marks to true</span></div>
<div class="line"><span class="stringliteral">            set page marks offset to &quot;12 pt&quot;</span></div>
<div class="line"><span class="stringliteral">            set PDF color space to unchanged color space</span></div>
<div class="line"><span class="stringliteral">            set PDF mark type to default</span></div>
<div class="line"><span class="stringliteral">            set printer mark weight to p125pt</span></div>
<div class="line"><span class="stringliteral">            set registration marks to true</span></div>
<div class="line"><span class="stringliteral">            --simulate overprint is only available when the export standard is</span></div>
<div class="line"><span class="stringliteral">            --PDF/X-1a or PDF/X-3</span></div>
<div class="line"><span class="stringliteral">            --set simulate overprint to false</span></div>
<div class="line"><span class="stringliteral">            set use document bleed with PDF to true</span></div>
<div class="line"><span class="stringliteral">            --Set viewPDF to true to open the PDF in Acrobat or Adobe Reader.</span></div>
<div class="line"><span class="stringliteral">            set view PDF to false</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">        --Now export the document to the desktop.</span></div>
<div class="line"><span class="stringliteral">        set myDesktopFolder to path to desktop as string</span></div>
<div class="line"><span class="stringliteral">        set myFile to myDesktopFolder &amp; &quot;ExportPDFWithOptions.pdf&quot;</span></div>
<div class="line"><span class="stringliteral">        tell myDocument</span></div>
<div class="line"><span class="stringliteral">            export format PDF type to myFile without showing options</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">    end tell</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_exporting_to_grayscale_pdf"></a>
Exporting to grayscale PDF</h3>
<p>An InDesign document that contains colors can be exported to a color PDF or to a grayscale PDF. You can modify the script in the preceding <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_setting_pdf_export_options">Setting PDF export options</a> section to export in grayscale by changing the PDF color space option from unchanged color space to gray. For example: </p>
<div class="fragment"><div class="line">tell PDF export preferences</div>
<div class="line">    <span class="keyword">set</span> PDF color space to gray</div>
<div class="line">end tell</div>
</div><!-- fragment --><p>(For a different script that creates a small document containing color and exports it to PDF in grayscale, see GreyscalePDF.)</p>
<h3><a class="anchor" id="id_as_exporting_a_range_of_pages_to_pdf"></a>
Exporting a range of pages to PDF</h3>
<p>The following script shows how to export a specified page range as PDF. (For the complete script, see ExportPageRangeAsPDF.)</p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDesktopFolder to path to desktop as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFile to myDesktopFolder &amp; <span class="stringliteral">&quot;ExportPageRangeAsPDF.pdf&quot;</span></div>
<div class="line">        tell PDF export preferences</div>
<div class="line">            --Enter the names of the pages you want to export in the following line.</div>
<div class="line">            --Note that the page name is not necessarily the index of the page in</div>
<div class="line">            --the document (e.g., the first page of a document whose page numbering</div>
<div class="line">            --starts with page 21 will be <span class="stringliteral">&quot;21&quot;</span>, not 1).</div>
<div class="line">            <span class="keyword">set</span> page range to <span class="stringliteral">&quot;1, 3, 5-6&quot;</span></div>
<div class="line">        end tell</div>
<div class="line">        tell document 1</div>
<div class="line">            export format PDF type to myFile without showing options</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_exporting_individual_pages_to_pdf"></a>
Exporting individual pages to PDF</h3>
<p>The following script exports each page from a document as an individual PDF file. (For the complete script, see ExportEachPageAsPDF.) </p>
<div class="fragment"><div class="line">    --Exports each page of an InDesign document as a separate PDF to a</div>
<div class="line">    --selected folder <span class="keyword">using</span> the current PDF export settings.</div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myFolder to my myChooseFolder()</div>
<div class="line">        if myFolder is not equal to &quot;&quot; then</div>
<div class="line">            my myExportPages(myFolder)</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">on myChooseFolder()</div>
<div class="line">    set myFolder to choose folder with prompt &quot;Choose a Folder&quot;</div>
<div class="line">    --Get the folder name (it&#39;ll be returned as a Unicode <span class="keywordtype">string</span>)</div>
<div class="line">    set myFolder to myFolder as <span class="keywordtype">string</span></div>
<div class="line">    return myFolder</div>
<div class="line">end myChooseFolder</div>
<div class="line">on myExportPages(myFolder)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myDocument to document 1</div>
<div class="line">        set myDocumentName to name of myDocument</div>
<div class="line">        set myDialog to make dialog with properties {name:<span class="stringliteral">&quot;File Naming Options&quot;</span>}</div>
<div class="line">        tell myDialog</div>
<div class="line">            tell (make dialog column)</div>
<div class="line">                tell (make dialog row)</div>
<div class="line">                    make <span class="keyword">static</span> text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Base Name:&quot;</span>}</div>
<div class="line">                    <span class="keyword">set</span> myBaseNameField to make text editbox with properties {edit contents:myDocumentName, min width:160}</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myResult to show myDialog</div>
<div class="line">        <span class="keywordflow">if</span> myResult is <span class="keyword">true</span> then</div>
<div class="line">            --The name of the exported files will be the base name + the value of the counter + <span class="stringliteral">&quot;.pdf&quot;</span>.</div>
<div class="line">            <span class="keyword">set</span> myBaseName to edit contents of myBaseNameField</div>
<div class="line">            --Remove the dialog box from memory.</div>
<div class="line">            destroy myDialog</div>
<div class="line">            repeat with myCounter from 1 to (count pages in myDocument)</div>
<div class="line">                <span class="keyword">set</span> myPageName to name of page myCounter of myDocument</div>
<div class="line">                <span class="keyword">set</span> page range of PDF export preferences to name of page myCounter of myDocument</div>
<div class="line">                --Generate a file path from the folder name, the base document name, and the page name.</div>
<div class="line">                --Replace any colons in the page name (e.g., <span class="stringliteral">&quot;Sec1:1&quot;</span>) so that they</div>
<div class="line">                --don&#39;t cause problems with file naming.</div>
<div class="line">                set myPageName to my myReplace(myPageName, &quot;:&quot;, &quot;_&quot;)</div>
<div class="line">                set myFilePath to myFolder &amp; myBaseName &amp; &quot;_&quot; &amp; myPageName &amp; &quot;.pdf&quot;</div>
<div class="line">                tell myDocument</div>
<div class="line">                    export format PDF type to myFilePath</div>
<div class="line">                end tell</div>
<div class="line">            end repeat</div>
<div class="line">        else</div>
<div class="line">            destroy myDialog</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
<div class="line">end myExportPages</div>
<div class="line">on myReplace(myString, myFindString, myChangeString)</div>
<div class="line">    set AppleScript&#39;s text item delimiters to myFindString</div>
<div class="line">    set myTextList to every text item of myString</div>
<div class="line">    set AppleScript&#39;s text item delimiters to myChangeString</div>
<div class="line">    set myString to myTextList as <span class="keywordtype">string</span></div>
<div class="line">    set AppleScript&#39;s text item delimiters to &quot;&quot;</div>
<div class="line">    return myString</div>
<div class="line">end myReplace</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_exporting_pdf_with_interactive_features"></a>
Exporting PDF with interactive features</h3>
<p>The following script exports a document with interactive features as a PDF. (For the complete script, see ExportInteractivePDF.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing at least two spreads...</div>
<div class="line">        repeat with myCounter from 1 to (count spreads of myDocument)</div>
<div class="line">            <span class="keyword">set</span> page transition type of spread myCounter of myDocument to wipe transition</div>
<div class="line">            <span class="keyword">set</span> page transition direction of spread myCounter of myDocument to left to right</div>
<div class="line">            <span class="keyword">set</span> page transition duration of spread myCounter of myDocument to medium</div>
<div class="line">        end repeat</div>
<div class="line">        <span class="keyword">set</span> myDesktopFolder to path to desktop as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFile to myDesktopFolder &amp; <span class="stringliteral">&quot;InteractivePDF.pdf&quot;</span></div>
<div class="line">        tell myDocument</div>
<div class="line">            export format interactive PDF to myFile without showing options</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_exporting_as_a_pdf_form"></a>
Exporting as a PDF form</h3>
<p>To create a PDF that contains form fields, you can either save the InDesign document as PDF, then open it in Acrobat and apply form fields, or apply text fields, radio buttons, signature fields, and so on directly in InDesign and export the document to PDF as a form with no additional Acrobat editing required.</p>
<p>The following script applies form elements to an InDesign document and exports the document as a PDF form. (For the complete script, see ExportInteractivePDFForm.) </p>
<div class="fragment"><div class="line">        tell page 1 of myDocument</div>
<div class="line">            --Create a textframe as firstname label</div>
<div class="line">            <span class="keyword">set</span> myTextFrame to make text frame with properties {geometric bounds:{15, 15, 20, 35}, contents:<span class="stringliteral">&quot;FirstName: &quot;</span>}</div>
<div class="line">            --Create a textbox as firstname input box</div>
<div class="line">            <span class="keyword">set</span> myTextBox to make text box with properties {geometric bounds:{15, 40, 20, 75}}</div>
<div class="line">            --Create another textframe as lastname label</div>
<div class="line">            <span class="keyword">set</span> myTextFrame1 to make text frame with properties {geometric bounds:{30, 15, 25, 35}, contents:<span class="stringliteral">&quot;LastName: &quot;</span>}</div>
<div class="line">            --Create another textbox as lastname input box</div>
<div class="line">            <span class="keyword">set</span> myTextBox to make text box with properties {geometric bounds:{30, 40, 25, 75}}</div>
<div class="line">            --Create a TextFrame to introduce the following checkbox</div>
<div class="line">            <span class="keyword">set</span> myTextFrame2 to make text frame with properties {geometric bounds:{15, 80, 20, 95}, contents:<span class="stringliteral">&quot;Hobby:&quot;</span>}</div>
<div class="line">            --Create some CheckBoxes</div>
<div class="line">            <span class="keyword">set</span> myCheckBox to make check box with properties {geometric bounds:{15, 100, 20, 105}, name:<span class="stringliteral">&quot;Football&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> myTextFrame3 to make text frame with properties {geometric bounds:{15, 107, 20, 125}, contents:<span class="stringliteral">&quot;Football&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> myCheckBox1 to make check box with properties {geometric bounds:{15, 130, 20, 135}, name:<span class="stringliteral">&quot;Basketball&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> myTextFrame4 to make text frame with properties {geometric bounds:{15, 137, 20, 160}, contents:<span class="stringliteral">&quot;Basketball&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> myCheckBox2 to make check box with properties {geometric bounds:{15, 165, 20, 170}, name:<span class="stringliteral">&quot;Pingpong&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> myTextFrame5 to make text frame with properties {geometric bounds:{15, 172, 20, 193}, contents:<span class="stringliteral">&quot;Pingpong&quot;</span>}</div>
<div class="line">            --Create a button <span class="keywordflow">for</span> submit</div>
<div class="line">            <span class="keyword">set</span> submitButton to make button with properties {geometric:{45, 15, 35, 35}, name:<span class="stringliteral">&quot;Submit&quot;</span>}</div>
<div class="line">        end tell</div>
<div class="line">        tell state 1 of submitButton</div>
<div class="line">            <span class="keyword">set</span> myRightArrow1 to make polygon with properties {fill color:color <span class="stringliteral">&quot;Green&quot;</span> of myDocument, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myRightArrow1 to {{15, 35}, {35, 40}, {15, 45}}</div>
<div class="line">        end tell</div>
<div class="line">        --Add the Rollover state.</div>
<div class="line">        tell submitButton</div>
<div class="line">            <span class="keyword">set</span> myRolloverState1 to make state</div>
<div class="line">        end tell</div>
<div class="line">        tell myRolloverState1</div>
<div class="line">            <span class="keyword">set</span> myRolloverArrow1 to make polygon with properties {fill color:color <span class="stringliteral">&quot;Green&quot;</span> of myDocument, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myRolloverArrow1 to {{15, 35}, {35, 40}, {15, 45}}</div>
<div class="line">            --Add a shadow to the polygon in the Rollover state.</div>
<div class="line">        end tell</div>
<div class="line">        tell drop shadow settings of fill transparency settings of myRolloverArrow1</div>
<div class="line">            <span class="keyword">set</span> mode to drop</div>
<div class="line">            <span class="keyword">set</span> angle to 90</div>
<div class="line">            <span class="keyword">set</span> x offset to 0</div>
<div class="line">            <span class="keyword">set</span> y offset to 0</div>
<div class="line">            <span class="keyword">set</span> size to 6</div>
<div class="line">        end tell</div>
<div class="line">        tell submitButton</div>
<div class="line">            <span class="keyword">set</span> myClickState1 to make state</div>
<div class="line">        end tell</div>
<div class="line">        tell myClickState1</div>
<div class="line">            <span class="keyword">set</span> myClickArrow1 to make polygon with properties {fill color:color <span class="stringliteral">&quot;Blue&quot;</span> of myDocument, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myClickArrow1 to {{15, 35}, {35, 40}, {15, 45}}</div>
<div class="line">        end tell</div>
<div class="line">        --Set the behavior <span class="keywordflow">for</span> the button.</div>
<div class="line">        tell submitButton</div>
<div class="line">            <span class="keyword">set</span> submitForm to make submit form behaviors with properties {behavior <span class="keyword">event</span>:mouse up}</div>
<div class="line">        end tell</div>
<div class="line">        </div>
<div class="line">        tell page 1 of myDocument</div>
<div class="line">            --Create a button <span class="keywordflow">for</span> print</div>
<div class="line">            <span class="keyword">set</span> printButton to make button with properties {geometric:{45, 15, 35, 35}, name:<span class="stringliteral">&quot;Submit&quot;</span>}</div>
<div class="line">        end tell</div>
<div class="line">        tell state 1 of printButton</div>
<div class="line">            <span class="keyword">set</span> myRightArrow2 to make polygon with properties {fill color:color <span class="stringliteral">&quot;Red&quot;</span> of myDocument, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myRightArrow2 to {{40, 35}, {60, 40}, {40, 45}}</div>
<div class="line">        end tell</div>
<div class="line">        --Add the Rollover state.</div>
<div class="line">        tell printButton</div>
<div class="line">            <span class="keyword">set</span> myRolloverState2 to make state</div>
<div class="line">        end tell</div>
<div class="line">        tell myRolloverState2</div>
<div class="line">            <span class="keyword">set</span> myRolloverArrow2 to make polygon with properties {fill color:color <span class="stringliteral">&quot;Red&quot;</span> of myDocument, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myRolloverArrow2 to {{40, 35}, {60, 40}, {40, 45}}</div>
<div class="line">            --Add a shadow to the polygon in the Rollover state.</div>
<div class="line">        end tell</div>
<div class="line">        tell drop shadow settings of fill transparency settings of myRolloverArrow2</div>
<div class="line">            <span class="keyword">set</span> mode to drop</div>
<div class="line">            <span class="keyword">set</span> angle to 90</div>
<div class="line">            <span class="keyword">set</span> x offset to 0</div>
<div class="line">            <span class="keyword">set</span> y offset to 0</div>
<div class="line">            <span class="keyword">set</span> size to 6</div>
<div class="line">        end tell</div>
<div class="line">        tell printButton</div>
<div class="line">            <span class="keyword">set</span> myClickState2 to make state</div>
<div class="line">        end tell</div>
<div class="line">        tell myClickState2</div>
<div class="line">            <span class="keyword">set</span> myClickArrow2 to make polygon with properties {fill color:color <span class="stringliteral">&quot;Blue&quot;</span> of myDocument, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myClickArrow2 to {{40, 35}, {60, 40}, {40, 45}}</div>
<div class="line">        end tell</div>
<div class="line">        --Set the behavior <span class="keywordflow">for</span> the button.</div>
<div class="line">        tell printButton</div>
<div class="line">            <span class="keyword">set</span> PrintForm to make print form behaviors with properties {behavior <span class="keyword">event</span>:mouse up}</div>
<div class="line">        end tell</div>
<div class="line">        --Export the document to PDF.</div>
<div class="line">        <span class="keyword">set</span> myDesktopFolder to path to desktop as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFile to myDesktopFolder &amp; <span class="stringliteral">&quot;SubmitForm.pdf&quot;</span></div>
<div class="line">        tell myDocument</div>
<div class="line">            export format interactive PDF to myFile without showing options</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_exporting_pages_as_eps"></a>
Exporting Pages as EPS</h2>
<p>When you export a document as EPS, InDesign saves each page of the file as a separate EPS graphic (an EPS, by definition, can contain only a single page). If you export more than a single page, InDesign appends the index of the page to the filename. The index of the page in the document is not necessarily the name of the page (as defined by the section options for the section containing the page).</p>
<h3><a class="anchor" id="id_as_exporting_all_pages_to_eps"></a>
Exporting all pages to EPS</h3>
<p>The following script exports the pages of the active document to one or more EPS files. (For the complete script, see ExportAsEPS.) </p>
<div class="fragment"><div class="line">    --Exports all of the pages in the active document to a series of EPS files</div>
<div class="line">    --(an EPS, by definition, can contain only a single page).</div>
<div class="line">    <span class="keyword">set</span> myDesktopFolder to path to desktop as <span class="keywordtype">string</span></div>
<div class="line">    <span class="keyword">set</span> myFile to myDesktopFolder &amp; <span class="stringliteral">&quot;ExportAsEPS.eps&quot;</span></div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> page range of EPS export preferences to all pages</div>
<div class="line">        tell document 1</div>
<div class="line">            export format EPS type to myFile without showing options</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_exporting_a_range_of_pages_to_eps"></a>
Exporting a range of pages to EPS</h3>
<p>To control which pages are exported as EPS, set the page range property of the EPS export preferences to a page-range string containing the page or pages you want to export, before exporting. (For the complete script, see ExportPageRangeAsEPS.) </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDesktopFolder to path to desktop as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFile to myDesktopFolder &amp; <span class="stringliteral">&quot;ExportPageRangeAsEPS.eps&quot;</span></div>
<div class="line">        tell EPS export preferences</div>
<div class="line">            --Enter the names of the pages you want to export in the following line.</div>
<div class="line">            --Note that the page name is not necessarily the index of the page in</div>
<div class="line">            --the document (e.g., the first page of a document whose page numbering</div>
<div class="line">            --starts with page 21 will be <span class="stringliteral">&quot;21&quot;</span>, not 1).</div>
<div class="line">            <span class="keyword">set</span> page range to <span class="stringliteral">&quot;1, 3,6&quot;</span></div>
<div class="line">        end tell</div>
<div class="line">        tell document 1</div>
<div class="line">            export format EPS type to myFile without showing options</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_exporting_as_eps_with_file_naming"></a>
Exporting as EPS with file naming</h3>
<p>The following script exports each page as an EPS, but it offers more control over file naming than the earlier example. (For the complete script, see ExportEachPageAsEPS.) </p>
<div class="fragment"><div class="line">    --Exports each page of an InDesign document as a separate PDF to a</div>
<div class="line">    --selected folder <span class="keyword">using</span> the current PDF export settings.</div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myFolder to my myChooseFolder()</div>
<div class="line">        if myFolder is not equal to &quot;&quot; then</div>
<div class="line">            my myExportPages(myFolder)</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">on myChooseFolder()</div>
<div class="line">    set myFolder to choose folder with prompt &quot;Choose a Folder&quot;</div>
<div class="line">    --Get the folder name (it&#39;ll be returned as a Unicode <span class="keywordtype">string</span>)</div>
<div class="line">    set myFolder to myFolder as <span class="keywordtype">string</span></div>
<div class="line">    return myFolder</div>
<div class="line">end myChooseFolder</div>
<div class="line">on myExportPages(myFolder)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myDocument to document 1</div>
<div class="line">        set myDocumentName to name of myDocument</div>
<div class="line">        set myDialog to make dialog with properties {name:<span class="stringliteral">&quot;ExportPages&quot;</span>}</div>
<div class="line">        tell myDialog</div>
<div class="line">            tell (make dialog column)</div>
<div class="line">                tell (make dialog row)</div>
<div class="line">                    make <span class="keyword">static</span> text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Base Name:&quot;</span>}</div>
<div class="line">                    <span class="keyword">set</span> myBaseNameField to make text editbox with properties {edit contents:myDocumentName, min width:160}</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myResult to show myDialog</div>
<div class="line">        <span class="keywordflow">if</span> myResult is <span class="keyword">true</span> then</div>
<div class="line">            --The name of the exported files will be the base name + the value of</div>
<div class="line">            --the counter + <span class="stringliteral">&quot;.pdf&quot;</span>.</div>
<div class="line">            <span class="keyword">set</span> myBaseName to edit contents of myBaseNameField</div>
<div class="line">            --Remove the dialog box from memory.</div>
<div class="line">            destroy myDialog</div>
<div class="line">            repeat with myCounter from 1 to (count pages in myDocument)</div>
<div class="line">                --Get the name of the page and assign it to the variable <span class="stringliteral">&quot;myPageName&quot;</span></div>
<div class="line">                <span class="keyword">set</span> myPageName to name of page myCounter of myDocument</div>
<div class="line">                --Set the page range to the name of the specific page.</div>
<div class="line">                <span class="keyword">set</span> page range of EPS export preferences to myPageName</div>
<div class="line">                --Generate a file path from the folder name, the base document name,</div>
<div class="line">                --and the page name.</div>
<div class="line">                --Replace any colons in the page name (e.g., <span class="stringliteral">&quot;Sec1:1&quot;</span>) so that they</div>
<div class="line">                --don&#39;t cause problems with file naming.</div>
<div class="line">                set myPageName to my myReplace(myPageName, &quot;:&quot;, &quot;_&quot;)</div>
<div class="line">                set myFilePath to myFolder &amp; myBaseName &amp; &quot;_&quot; &amp; myPageName &amp; &quot;.eps&quot;</div>
<div class="line">                tell myDocument</div>
<div class="line">                    export format EPS type to myFilePath without showing options</div>
<div class="line">                end tell</div>
<div class="line">            end repeat</div>
<div class="line">        else</div>
<div class="line">            destroy myDialog</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
<div class="line">end myExportPages</div>
<div class="line">on myReplace(myString, myFindString, myChangeString)</div>
<div class="line">    set AppleScript&#39;s text item delimiters to myFindString</div>
<div class="line">    set myTextList to every text item of myString</div>
<div class="line">    set AppleScript&#39;s text item delimiters to myChangeString</div>
<div class="line">    set myString to myTextList as <span class="keywordtype">string</span></div>
<div class="line">    set AppleScript&#39;s text item delimiters to &quot;&quot;</div>
<div class="line">    return myString</div>
<div class="line">end myReplace</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_exporting_to_epub"></a>
Exporting to EPub</h2>
<p>InDesign scripting offers full control over the creation of EPub files from your page-layout documents.</p>
<h3><a class="anchor" id="id_as_exporting_the_current_document"></a>
Exporting the current document</h3>
<p>The following script exports the current document as EPub, using default options. (For the complete script, see ExportEPub.) </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            export format EPUB to myFile without showing options</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> To give the user more control over the creation of EPub files, specify true for the third parameter. This opens the EPub export options dialog.</p>
<h3><a class="anchor" id="id_as_setting_epub_export_options"></a>
Setting EPub export options</h3>
<p>The following script sets the EPub export options before exporting. (For the complete script, see ExportEPubWithOptions.) </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            tell EPub export preferences</div>
<div class="line">                --Apply image alignment to anchored <span class="keywordtype">object</span> settings.</div>
<div class="line">                <span class="keyword">set</span> apply image alignment to anchored <span class="keywordtype">object</span> settings to <span class="keyword">false</span></div>
<div class="line">                </div>
<div class="line">                --Bottom margin of the epub.</div>
<div class="line">                <span class="keyword">set</span> bottom margin to 5</div>
<div class="line">                --Left margin of the epub.</div>
<div class="line">                <span class="keyword">set</span> left margin to 5</div>
<div class="line">                --Right margin of the epub.</div>
<div class="line">                <span class="keyword">set</span> right margin to 5</div>
<div class="line">                --Top margin of the epub.</div>
<div class="line">                <span class="keyword">set</span> top margin to 5</div>
<div class="line">                </div>
<div class="line">                --If <span class="keyword">true</span>, <span class="keywordflow">break</span> InDesign document into smaller pieces when generating epub.</div>
<div class="line">                <span class="keyword">set</span> <span class="keywordflow">break</span> document to <span class="keyword">true</span></div>
<div class="line">                -- The name of paragraph style to <span class="keywordflow">break</span> InDesign document.</div>
<div class="line">                <span class="keyword">set</span> paragraph style name to <span class="stringliteral">&quot;&quot;</span></div>
<div class="line">                </div>
<div class="line">                --The buttet export option.</div>
<div class="line">                <span class="keyword">set</span> bullet export option to as text</div>
<div class="line">                </div>
<div class="line">                <span class="keyword">set</span> custom image size option to size relative to page width</div>
<div class="line">                </div>
<div class="line">                <span class="keyword">set</span> embed font to <span class="keyword">true</span></div>
<div class="line"></div>
<div class="line">                <span class="keyword">set</span> epub cover to first page</div>
<div class="line">                --This will take effect only when epub cover is <span class="keyword">set</span> to external image.</div>
<div class="line">                --<span class="keyword">set</span> cover image file to <span class="stringliteral">&quot;cover.jpg&quot;</span></div>
<div class="line">                </div>
<div class="line">                <span class="keyword">set</span> epub publisher to <span class="stringliteral">&quot;Adobe Devtech&quot;</span></div>
<div class="line">                </div>
<div class="line">                --The export order.</div>
<div class="line">                <span class="keyword">set</span> export order to layout order</div>
<div class="line">                </div>
<div class="line">                --If <span class="keyword">true</span>, output footnote immediately after its paragraph.</div>
<div class="line">                <span class="keyword">set</span> footnote follow paragraph to <span class="keyword">false</span></div>
<div class="line">                </div>
<div class="line">                <span class="keyword">set</span> GIF options interlaced to <span class="keyword">true</span></div>
<div class="line">                <span class="keyword">set</span> GIF options palette to windows palette</div>
<div class="line">                </div>
<div class="line">                --The epub unique identifier, like ISBN.</div>
<div class="line">                <span class="keyword">set</span> <span class="keywordtype">id</span> to <span class="stringliteral">&quot;123&quot;</span></div>
<div class="line">                </div>
<div class="line">                --Ignore <span class="keywordtype">object</span> level image conversion settings.</div>
<div class="line">                <span class="keyword">set</span> ignore <span class="keywordtype">object</span> conversion settings to <span class="keyword">true</span></div>
<div class="line">                </div>
<div class="line">                --Alignment applied to images.</div>
<div class="line">                <span class="keyword">set</span> image alignment to align center</div>
<div class="line">                --The file format to use <span class="keywordflow">for</span> converted images.</div>
<div class="line">                <span class="keyword">set</span> image conversion to automatic</div>
<div class="line">                <span class="keyword">set</span> image export resolution to ppi 150</div>
<div class="line">                --Image page <span class="keywordflow">break</span> settings to be used with objects.</div>
<div class="line">                <span class="keyword">set</span> image page <span class="keywordflow">break</span> to page <span class="keywordflow">break</span> after</div>
<div class="line">                --Space After applied to images.</div>
<div class="line">                <span class="keyword">set</span> image space after to 2</div>
<div class="line">                --Space Before applied to images.</div>
<div class="line">                <span class="keyword">set</span> image space before to 2</div>
<div class="line">                </div>
<div class="line">                --If <span class="keyword">true</span>, output document metadata into epub.</div>
<div class="line">                <span class="keyword">set</span> include document metadata to <span class="keyword">true</span></div>
<div class="line">                </div>
<div class="line">                <span class="keyword">set</span> JPEG options format to baseline encoding</div>
<div class="line">                <span class="keyword">set</span> JPEG options quality to high</div>
<div class="line">                </div>
<div class="line">                --The PNG compression level.</div>
<div class="line">                <span class="keyword">set</span> level to 5</div>
<div class="line">                </div>
<div class="line">                <span class="keyword">set</span> numbered list export option to as text</div>
<div class="line">                </div>
<div class="line">                --If <span class="keyword">true</span>, format image based on layout appearence.</div>
<div class="line">                <span class="keyword">set</span> preserve layout appearence to <span class="keyword">true</span></div>
<div class="line">                --If <span class="keyword">true</span>, output local style <span class="keyword">override</span>.</div>
<div class="line">                <span class="keyword">set</span> preserve local <span class="keyword">override</span> to <span class="keyword">true</span></div>
<div class="line">                </div>
<div class="line">                <span class="keyword">set</span> strip soft <span class="keywordflow">return</span> to <span class="keyword">true</span></div>
<div class="line">                --If <span class="keyword">true</span>, image page <span class="keywordflow">break</span> settings will be used in objects.</div>
<div class="line">                <span class="keyword">set</span> use image page <span class="keywordflow">break</span> to <span class="keyword">true</span></div>
<div class="line">                --Use a defined TOC style to generate epub TOC.</div>
<div class="line">                --<span class="keyword">set</span> use toc style name to <span class="stringliteral">&quot;MyTOCStyle&quot;</span></div>
<div class="line">                </div>
<div class="line">                <span class="keyword">set</span> view document after export to <span class="keyword">false</span></div>
<div class="line">            end tell</div>
<div class="line">            </div>
<div class="line">            export format EPUB to myFile without showing options</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_as_working_with_layers"></a>
Working with Layers</h1>
<p>InDesign's layers are the key to controlling the stacking order of objects in your layout. You can think of layers as transparent planes stacked on top of each other. You also can use layers as an organizational tool, putting one type of content on a given layer or set of layers.</p>
<p>A document can contain one or more layers, and each document includes at least one layer. Layers are document wide, not bound to specific pages or spreads.</p>
<p>This section covers scripting techniques related to layers in an InDesign layout and discusses common operations involving layers.</p>
<h2><a class="anchor" id="id_as_understanding_the_layer_object_model"></a>
Understanding the Layer Object Model</h2>
<p>The following figure shows the layer object model. Note the following about the diagram:</p>
<ul>
<li>It focuses on the location of a layer and its contents in the context of the object hierarchy of a document; it does not attempt to show all the other ways a script might work with the content of a layer (e.g., you can get a reference to a text-frame object from a story, text object, page, or spread, in addition to finding it inside a layer object).</li>
<li>It uses the JavaScript form of the object names; however, the object hierarchy is the same in all scripting languages.</li>
<li>The basic properties of a layer are shown in the column at the left of the figure; the objects that may be contained by the layer object, at the right.</li>
</ul>
<p>It is important to note the distinction between the page-items collection and the all page items collection. The former is a collection containing only the top-level page items in a layer. If a page item is inside a group, for example, it will not appear in the page items collection. In contrast, the all page items collection is a flattened collection of all page items assigned to the layer, regardless of their location in the object hierarchy. A page item inside a group on the layer would appear in the all page items collection.</p>
<p>Similarly, the all graphics property contains all graphics stored in page items assigned to the layer, regardless of their location in the object hierarchy.</p>
<div class="image">
<img src="InDesign_ScriptingGuide-2.gif" alt="InDesign_ScriptingGuide-2.gif"/>
</div>
<h2><a class="anchor" id="id_as_scripting_layers"></a>
Scripting Layers</h2>
<p>In InDesign's user interface, you add, delete, rearrange, duplicate, and merge layers using the Layers panel. You also can change the layer to which a selected page item is assigned by dragging and dropping the layer proxy in the Layers panel. (For more on assigning objects to a layer, see the InDesign online help.) This section shows how to accomplish these tasks using InDesign scripting.</p>
<h3><a class="anchor" id="id_as_creating_layers"></a>
Creating layers</h3>
<p>The following script fragment shows how to create a new layer. (For the complete script, see AddLayer.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...      </div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myLayer to make layer</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> When you create a new layer, the layer appears above all other layers in the document.</p>
<h3><a class="anchor" id="id_as_referring_to_layers"></a>
Referring to layers</h3>
<p>InDesign scripting offers several ways to refer to a layer object. This section describes the most common ways to refer to layers.</p>
<p><b>Getting the active layer</b></p>
<p>The active layer is the layer on which new objects are created. You can get the active layer using scripting, as shown in the following script fragment. (For the complete script, see ActiveLayer.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myLayer to active layer</div>
<div class="line">            display dialog (<span class="stringliteral">&quot;Active layer: &quot;</span> &amp; name of myLayer)</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> <b>Referring to layers by layer index</b></p>
<p>You can get a reference to a layer using the index of the layer in the layers collection of a document. The script fragment below uses the layer index to iterate through layers. (For the complete script, see HideOtherLayers.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myTargetLayer to active layer</div>
<div class="line">            <span class="keyword">set</span> myLayerName to name of myTargetLayer</div>
<div class="line">            repeat with myCounter from 1 to (count layers)</div>
<div class="line">                <span class="keyword">set</span> myName to name of layer myCounter</div>
<div class="line">                <span class="keywordflow">if</span> myName is not equal to myLayerName then</div>
<div class="line">                    <span class="keyword">set</span> visible of layer myCounter to <span class="keyword">false</span></div>
<div class="line">                end <span class="keywordflow">if</span></div>
<div class="line">            end repeat</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> Note that you can use negative numbers to refer to the layers in the layers collection of a document. Layer -1 refers to the last (bottom) layer in the collection.</p>
<p><b>Referring to layers by layer name</b></p>
<p>You also can get a reference to a layer using the name of the layer, as shown in the following script fragment. (For the complete script, see LayerName.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myLayer to layer <span class="stringliteral">&quot;Text Layer&quot;</span></div>
<div class="line">            display dialog (<span class="stringliteral">&quot;Text Layer ID: &quot;</span> &amp; <span class="keywordtype">id</span> of myLayer)</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_deleting_layers"></a>
Deleting layers</h3>
<p>Use the delete method to delete a layer from a specific document, as shown in the following script fragment. (For the complete script, see DeleteLayer.) You cannot delete the last remaining layer in a document. </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing a layer named <span class="stringliteral">&quot;Delete This Layer&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myLayer to layer <span class="stringliteral">&quot;Delete This Layer&quot;</span></div>
<div class="line">            tell myLayer</div>
<div class="line">                <span class="keyword">delete</span></div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_moving_layers"></a>
Moving layers</h3>
<p>Use the move method to change the stacking order of layers in a document, as shown in the following script fragment. (For the complete script, see MoveLayer.)</p>
<div class="fragment"><div class="line">        --Given a layer <span class="stringliteral">&quot;myLayer&quot;</span>, move the layer behind the <span class="keywordflow">default</span> layer.</div>
<div class="line">        tell document 1</div>
<div class="line">            move myLayer to end of layers of document 1</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_duplicating_layers"></a>
Duplicating layers</h3>
<p>Use the duplicate method to create a copy of a layer, as shown in the following script fragment. (For the complete script, see DuplicateLayer.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...      </div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myLayer to layer 1</div>
<div class="line">            tell myLayer</div>
<div class="line">                <span class="keyword">set</span> myLayer1 to duplicate</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_merging_layers"></a>
Merging layers</h3>
<p>The following script fragment shows how to merge two or more layers, including the page items assigned to them, into a single layer. (For the complete script, see MergeLayers.)</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing at least two layers...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myLayerA to layer 1</div>
<div class="line">            <span class="keyword">set</span> myLayerB to layer 2</div>
<div class="line">            tell myLayerA</div>
<div class="line">                merge with myLayerB</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_assigning_page_items_to_layers"></a>
Assigning page items to layers</h3>
<p>You can assign a page item to a layer by either referring to the layer when you create the page item or setting the item layer property of an existing page item. The following script fragment shows how to assign a page item to a layer using both techniques. (For the complete script, see AssignPageItemsToLayers.) </p>
<div class="fragment"><div class="line">        --Given a reference to a page <span class="stringliteral">&quot;myPage,&quot;</span> and a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myPage</div>
<div class="line">            --Create a text frame on a layer named <span class="stringliteral">&quot;TextFrames&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myTextFrame to make text frame with properties {itemLayer:layer <span class="stringliteral">&quot;TextFrames&quot;</span>, geometric bounds:{72, 72, 144, 144}}</div>
<div class="line">            --Create a rectangle on the current target layer.</div>
<div class="line">            <span class="keyword">set</span> myRectangle to make rectangle with properties {geometric bounds:{72, 144, 144, 216}}</div>
<div class="line">            --Move the rectangle to a specific layer.</div>
<div class="line">            <span class="keyword">set</span> item layer of myRectangle to layer <span class="stringliteral">&quot;Rectangles&quot;</span> of myDocument</div>
<div class="line">            --Create a series of ovals.</div>
<div class="line">            repeat with myCounter from 72 to 172 by 10</div>
<div class="line">                make oval with properties {geometric bounds:{216, myCounter, 226, myCounter + 10}}</div>
<div class="line">            end repeat</div>
<div class="line">            --Move all of the ovals on the page to a specific layer.</div>
<div class="line">            repeat with myCounter from 1 to (count ovals)</div>
<div class="line">                <span class="keyword">set</span> item layer of oval myCounter to layer <span class="stringliteral">&quot;Ovals&quot;</span> of myDocument</div>
<div class="line">            end repeat</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_setting_layer_properties"></a>
Setting layer properties</h3>
<p>Layer properties control the layer name, color, visibility, and other attributes of a layer. This section shows how to work with layer properties.</p>
<p><b>Setting basic layer properties</b></p>
<p>Basic layer properties include the name of the layer, the highlight color of the layer, the visibility of the layer, and whether text objects on the layer ignore text-wrap settings. The following script fragment shows how to set these basic properties of a layer. (For the complete script, see BasicLayerProperties.)</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myLayer to make layer</div>
<div class="line">            <span class="keyword">set</span> name of myLayer to <span class="stringliteral">&quot;myLayer&quot;</span></div>
<div class="line">            <span class="keyword">set</span> layer color of myLayer to charcoal</div>
<div class="line">            <span class="keyword">set</span> ignore wrap of myLayer to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> visible of myLayer to <span class="keyword">true</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> <b>Working with layer guides</b></p>
<p>Guides can be assigned to a specific layer, just like page items. You can choose to show or hide the guides for a layer, and you can lock or unlock the guides on a layer. The following script fragment shows how to work with the guides on a layer. (For the complete script, see LayerGuides.)</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> containing at least one guide...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myLayer to make layer</div>
<div class="line">            --Move all of the guides on the page to the <span class="keyword">new</span> layer.</div>
<div class="line">            tell myPage</div>
<div class="line">                repeat with myCounter from (count guides) to 1 by -1</div>
<div class="line">                    <span class="keyword">set</span> item layer of guide myCounter to myLayer</div>
<div class="line">                end repeat</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> lock guides of myLayer to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> show guides of myLayer to <span class="keyword">true</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> <b>Controlling layer printing and visibility</b></p>
<p>You can control the printing and visibility of objects on a layer, as shown in the following script fragment. (For the complete script, see LayerControl.)</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing layers named <span class="stringliteral">&quot;Background,&quot;</span></div>
<div class="line">        --<span class="stringliteral">&quot;Language A,&quot;</span>, <span class="stringliteral">&quot;Language B,&quot;</span> and <span class="stringliteral">&quot;Language C,&quot;</span> export the <span class="stringliteral">&quot;Background&quot;</span></div>
<div class="line">        --layer and each <span class="stringliteral">&quot;Language&quot;</span> layer to PDF as separate PDF files...</div>
<div class="line">        <span class="keyword">set</span> myList to {<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>}</div>
<div class="line">        <span class="keyword">set</span> myPath to path to desktop as <span class="keywordtype">string</span></div>
<div class="line">        tell myDocument</div>
<div class="line">            repeat with myCounter from 1 to 3</div>
<div class="line">                <span class="keyword">set</span> myVersion to <span class="stringliteral">&quot;Language &quot;</span> &amp; item myCounter of myList</div>
<div class="line">                repeat with myLayerCounter from 1 to (count layers)</div>
<div class="line">                    <span class="keywordflow">if</span> name of layer myLayerCounter is equal to myVersion or name of layer myLayerCounter is equal to <span class="stringliteral">&quot;Background&quot;</span> then</div>
<div class="line">                        <span class="keyword">set</span> visible of layer myLayerCounter to <span class="keyword">true</span></div>
<div class="line">                        <span class="keyword">set</span> printable of layer myLayerCounter to <span class="keyword">true</span></div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                        <span class="keyword">set</span> visible of layer myLayerCounter to <span class="keyword">false</span></div>
<div class="line">                        <span class="keyword">set</span> printable of layer myLayerCounter to <span class="keyword">false</span></div>
<div class="line">                    end <span class="keywordflow">if</span></div>
<div class="line">                end repeat</div>
<div class="line">                <span class="keyword">set</span> myFilePath to myPath &amp; myVersion &amp; <span class="stringliteral">&quot;.pdf&quot;</span></div>
<div class="line">                export to myFilePath format PDF type</div>
<div class="line">            end repeat</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> <b>Locking layers</b></p>
<p>Layers can be locked, which means the page items on the layers cannot be edited. The following script fragment shows how to lock and unlock layers. (For the complete script, see LockLayersBelow.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myLayer to active layer</div>
<div class="line">            repeat with myCounter from ((index of myLayer) + 1) to (count layers)</div>
<div class="line">                set locked of layer myCounter to true</div>
<div class="line">            end repeat</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_as_text_and_type"></a>
Text and Type</h1>
<p>Entering, editing, and formatting text are the tasks that make up the bulk of the time spent working on most InDesign documents. Because of this, automating text and type operations can result in large productivity gains.</p>
<p>This section shows how to script the most common operations involving text and type. The sample scripts in this section are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script. We also assume that you have some knowledge of working with text in InDesign and understand basic typesetting terms.</p>
<h2><a class="anchor" id="id_as_entering_and_importing_text"></a>
Entering and Importing Text</h2>
<p>This section covers the process of getting text into your InDesign documents. Just as you can type text into text frames and place text files using the InDesign user interface, you can create text frames, insert text into a story, or place text files on pages using scripting.</p>
<h3><a class="anchor" id="id_as_creating_a_text_frame"></a>
Creating a text frame</h3>
<p>The following script creates a text frame, sets the bounds (size) of the frame, then enters text in the frame (for the complete script, see the MakeTextFrame tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrame to make text frame</div>
<div class="line">            --Set the bounds of the text frame.</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myTextFrame to {72, 72, 288, 288}</div>
<div class="line">            --Enter text in the text frame.</div>
<div class="line">            <span class="keyword">set</span> contents of myTextFrame to <span class="stringliteral">&quot;This is some example text.&quot;</span></div>
<div class="line">            --Note that you could also use a properties record</div>
<div class="line">            --to <span class="keyword">set</span> the bounds and contents of the text in a </div>
<div class="line">            --single line:</div>
<div class="line">            --<span class="keyword">set</span> myTextFrame to make text frame with properties{geometric bounds:{72, 72, 288, 288}, contents:<span class="stringliteral">&quot;This is some example text.&quot;</span>}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script shows how to create a text frame that is the size of the area defined by the page margins. myGetBounds is a useful function that you can add to your own scripts, and it appears in many other examples in this section. (For the complete script, see MakeTextFrameWithinMargins.) </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrame to make text frame</div>
<div class="line">            --Set the bounds of the text frame.</div>
<div class="line">            <span class="keyword">set</span> geometric bounds of myTextFrame to my myGetBounds(myDocument, myPage)</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script fragment shows the myGetBounds handler. </p>
<div class="fragment"><div class="line">on myGetBounds(myDocument, myPage)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        tell document preferences of myDocument</div>
<div class="line">            set myPageWidth to page width</div>
<div class="line">            set myPageHeight to page height</div>
<div class="line">        end tell</div>
<div class="line">        tell margin preferences of myPage</div>
<div class="line">            if side of myPage is left hand then</div>
<div class="line">                set myX2 to left</div>
<div class="line">                set myX1 to right</div>
<div class="line">            else</div>
<div class="line">                set myX1 to left</div>
<div class="line">                set myX2 to right</div>
<div class="line">            end if</div>
<div class="line">            set myY1 to top</div>
<div class="line">            set myY2 to bottom</div>
<div class="line">        end tell</div>
<div class="line">        set myX2 to myPageWidth - myX2</div>
<div class="line">        set myY2 to myPageHeight - myY2</div>
<div class="line">        return {myY1, myX1, myY2, myX2}</div>
<div class="line">    end tell</div>
<div class="line">end myGetBounds</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_adding_text"></a>
Adding text</h3>
<p>To add text to a story, use the contents property of the insertion point at the location where you want to insert the text. The following sample script uses this technique to add text at the end of a story (for the complete script, see AddText): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> with a text frame on page 1</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to text frame 1 of page 1 of myDocument</div>
<div class="line">        --Add text to the end of the text frame. To <span class="keywordflow">do</span> <span class="keyword">this</span>,</div>
<div class="line">        --We<span class="stringliteral">&#39;ll use the last insertion point in the story.</span></div>
<div class="line"><span class="stringliteral">        set myNewText to &quot;This is a new paragraph of example text.&quot;</span></div>
<div class="line"><span class="stringliteral">        tell parent story of myTextFrame</span></div>
<div class="line"><span class="stringliteral">            set contents of insertion point -1 to return &amp; myNewText</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_stories_and_text_frames"></a>
Stories and text frames</h3>
<p>All text in an InDesign layout is part of a story, and every story can contain one or more text frames. Creating a text frame creates a story, and stories can contain multiple text frames.</p>
<p>In the preceding script, we added text at the end of the parent story rather than at the end of the text frame. This is because the end of the text frame might not be the end of the story; that depends on the length and formatting of the text. By adding the text to the end of the parent story, we can guarantee that the text is added, regardless of the composition of the text in the text frame.</p>
<p>You always can get a reference to the story using the parent text frame property of a text frame. It can be useful to work with the text of a story instead of the text of a text frame; the following script demonstrates the difference. The alerts shows that the text frame does not contain the overset text, but the story does (for the complete script, see StoryAndTextFrame). </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> with a text frame on page 1...</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to text frame 1 of myDocument</div>
<div class="line">        --Now add text beyond the end of the text frame.</div>
<div class="line">        <span class="keyword">set</span> myString to <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;This is some overset text&quot;</span></div>
<div class="line">        tell insertion point -1 of myTextFrame to <span class="keyword">set</span> contents to myString</div>
<div class="line">        <span class="keyword">set</span> myString to contents of text 1 of myTextFrame</div>
<div class="line">        display dialog (<span class="stringliteral">&quot;The last paragraph in this dialog should be \&quot;This is some overset text\&quot;. Is it?&quot;</span> &amp; <span class="keywordflow">return</span> &amp; myString)</div>
<div class="line">        <span class="keyword">set</span> myString to contents of parent story of myTextFrame</div>
<div class="line">        display dialog (<span class="stringliteral">&quot;The last paragraph in this alert should be \&quot;This is some overset text\&quot;. Is it?&quot;</span> &amp; <span class="keywordflow">return</span> &amp; myString)</div>
</div><!-- fragment --><p> For more on understanding the relationships between text objects in an InDesign document, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_understanding_text_objects">Understanding Text Objects</a>.</p>
<h3><a class="anchor" id="id_as_replacing_text"></a>
Replacing text</h3>
<p>The following script replaces a word with a phrase by changing the contents of the appropriate object (for the complete script, see ReplaceWord): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> with a text frame on page 1...</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to text frame 1 of page 1 of myDocument</div>
<div class="line">        --Replace the third word with the phrase <span class="stringliteral">&quot;a little bit of&quot;</span>.</div>
<div class="line">        tell word 3 of parent story of myTextFrame</div>
<div class="line">            <span class="keyword">set</span> contents to <span class="stringliteral">&quot;a little bit of&quot;</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script replaces the text in a paragraph (for the complete script, see ReplaceText): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> with a text frame on page 1...</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to text frame 1 of page 1 of myDocument</div>
<div class="line">        --Replace the text in the second paragraph without</div>
<div class="line">        --replacing the <span class="keywordflow">return</span> character at the end of the paragraph</div>
<div class="line">        --(character -2 is the character before the <span class="keywordflow">return</span>).</div>
<div class="line">        tell parent story of myTextFrame</div>
<div class="line">            <span class="keyword">set</span> myText to <span class="keywordtype">object</span> reference of text from character 1 to character -2 of paragraph 2</div>
<div class="line">            <span class="keyword">set</span> contents of myText to <span class="stringliteral">&quot;This text replaces the text in paragraph 2.&quot;</span></div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> In the preceding script, we excluded the return character because deleting the return might change the paragraph style applied to the paragraph. To do this, we supplied a character range-from the first character of the paragraph to the last character before the return character that ends the paragraph.</p>
<h3><a class="anchor" id="id_as_inserting_special_characters"></a>
Inserting special characters</h3>
<p>Because the Script Editor supports Unicode, you can simply enter Unicode characters in text strings that you send to InDesign. The following script shows several ways to enter special characters. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_creating_a_text_frame">Creating a text frame</a> or in the SpecialCharacters tutorial script.) </p>
<div class="fragment"><div class="line">--Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing a story...</div>
<div class="line">set myStory to story 1 of myDocument</div>
<div class="line">--Entering special characters directly:</div>
<div class="line"><span class="keyword">set</span> contents of myStory to <span class="stringliteral">&quot;Registered trademark: ?&quot;</span> &amp; <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;Copyright:  &amp;copy;&quot;</span> &amp; <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;Trademark: Ÿ&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">--Entering special characters by their Unicode glyph ID value:</div>
<div class="line"><span class="keyword">set</span> contents of insertion point -1 of myStory to <span class="stringliteral">&quot;Not equal to: &lt;2260&gt;&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line"><span class="keyword">set</span> contents of insertion point -1 of myStory to <span class="stringliteral">&quot;Square root: &lt;221A&gt;&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line"><span class="keyword">set</span> contents of insertion point -1 of myStory to <span class="stringliteral">&quot;Square root: &lt;00B6&gt;&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">--Entering special characters by their enumerations:</div>
<div class="line"><span class="keyword">set</span> contents of insertion point -1 of myStory to <span class="stringliteral">&quot;Automatic page number marker: &quot;</span></div>
<div class="line"><span class="keyword">set</span> contents of insertion point -1 of myStory to <span class="keyword">auto</span> page number</div>
<div class="line"><span class="keyword">set</span> contents of insertion point -1 of myStory to <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;Section symbol: &quot;</span></div>
<div class="line"><span class="keyword">set</span> contents of insertion point -1 of myStory to section symbol</div>
<div class="line"><span class="keyword">set</span> contents of insertion point -1 of myStory to <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;En dash: &quot;</span></div>
<div class="line"><span class="keyword">set</span> contents of insertion point -1 of myStory to En dash</div>
<div class="line"><span class="keyword">set</span> contents of insertion point -1 of myStory to <span class="keywordflow">return</span></div>
</div><!-- fragment --><p>The easiest way to find the Unicode ID for a character is to use InDesign's Glyphs palette: move the cursor over a character in the palette, and InDesign displays its Unicode value. To learn more about Unicode, visit <a href="http://www.unicode.org">http://www.unicode.org </a>.</p>
<h2><a class="anchor" id="id_as_placing_text_and_setting_text-import_preferences"></a>
Placing Text and Setting Text-Import Preferences</h2>
<p>In addition to entering text strings, you can place text files created using word processors and text editors. The following script shows how to place a text file on a document page (for the complete script, see PlaceTextFile): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        --Get the top and left margins to use as a place point.</div>
<div class="line">        tell margin preferences of myPage</div>
<div class="line">            <span class="keyword">set</span> myX to left</div>
<div class="line">            <span class="keyword">set</span> myY to right</div>
<div class="line">        end tell</div>
<div class="line">        --Autoflow a text file on the current page.</div>
<div class="line">        --Parameters <span class="keywordflow">for</span> the place command of a page:</div>
<div class="line">        --file as file or <span class="keywordtype">string</span></div>
<div class="line">        --[place point as list {x, y}</div>
<div class="line">        --[destination layer as layer <span class="keywordtype">object</span> or string]</div>
<div class="line">        --[showing options as Boolean (<span class="keywordflow">default</span> is <span class="keyword">false</span>)]</div>
<div class="line">        --[autoflowing as Boolean (<span class="keywordflow">default</span> is <span class="keyword">false</span>)]</div>
<div class="line">        --You<span class="stringliteral">&#39;ll have to fill in a valid  file path on your system.</span></div>
<div class="line"><span class="stringliteral">        tell myPage</span></div>
<div class="line"><span class="stringliteral">            --Note that if the PlacePoint parameter is inside a column, only the vertical (y)</span></div>
<div class="line"><span class="stringliteral">            --coordinate will be honored--the text frame will expand horizontally to fit the column.</span></div>
<div class="line"><span class="stringliteral">            set myStory to place alias &quot;Macintosh HD:scripting:test.txt&quot; place point {myX, myY} autoflowing yes without showing options</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --><p> The following script shows how to place a text file in an existing text frame. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_creating_a_text_frame">Creating a text frame</a>, or see the PlaceTextFileInFrame tutorial script.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> with a text frame on page 1...</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to text frame 1 of page 1 of myDocument</div>
<div class="line">        tell insertion point -1 of myTextFrame</div>
<div class="line">            --You<span class="stringliteral">&#39;ll need to fill in a valid file path for your system.</span></div>
<div class="line"><span class="stringliteral">            place alias &quot;Macintosh HD:scripting:test.txt&quot; without showing options</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --><p> The following script shows how to insert a text file at a specific location in text. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_creating_a_text_frame">Creating a text frame</a>, or see the InsertTextFile tutorial script.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> with a text frame on page 1...</div>
<div class="line">        --Place a text file at the end of the text.</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to text frame 1 of page 1 of myDocument</div>
<div class="line">        tell insertion point -1 of parent story of myTextFrame</div>
<div class="line">            --You<span class="stringliteral">&#39;ll need to fill in a valid file path for your system.</span></div>
<div class="line"><span class="stringliteral">            place &quot;yukino:test.txt&quot; without showing options</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --><p> To specify the import options for the specific type of text file you are placing, use the corresponding import-preferences object. The following script shows how to set text-import preferences (for the complete script, see TextImportPreferences). The comments in the script show the possible values for each property. </p>
<div class="fragment"><div class="line">        tell text <span class="keyword">import</span> preferences</div>
<div class="line">            --Options <span class="keywordflow">for</span> character <span class="keyword">set</span>:</div>
<div class="line">            <span class="keyword">set</span> character <span class="keyword">set</span> to UTF8</div>
<div class="line">            <span class="keyword">set</span> convert spaces into tabs to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> spaces into tabs count to 3</div>
<div class="line">            --The dictionary <span class="keyword">property</span> can take many values, such as French, Italian.</div>
<div class="line">            <span class="keyword">set</span> dictionary to <span class="stringliteral">&quot;English: USA&quot;</span></div>
<div class="line">            --platform options:</div>
<div class="line">            --macintosh</div>
<div class="line">            --pc</div>
<div class="line">            <span class="keyword">set</span> platform to macintosh</div>
<div class="line">            <span class="keyword">set</span> strip returns between lines to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> strip returns between paragraphs to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> use typographers quotes to <span class="keyword">true</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script shows how to set tagged text import preferences (for the complete script, see TaggedTextImportPreferences): </p>
<div class="fragment"><div class="line">        tell tagged text <span class="keyword">import</span> preferences</div>
<div class="line">            <span class="keyword">set</span> <span class="keyword">remove</span> text formatting to <span class="keyword">false</span></div>
<div class="line">            --Options <span class="keywordflow">for</span> style conflict are:</div>
<div class="line">            --publication definition</div>
<div class="line">            --tag file definition</div>
<div class="line">            <span class="keyword">set</span> style conflict to publication definition</div>
<div class="line">            <span class="keyword">set</span> use typographers quotes to <span class="keyword">true</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script shows how to set Word and RTF import preferences (for the complete script, see WordRTFImportPreferences): </p>
<div class="fragment"><div class="line">        tell word RTF <span class="keyword">import</span> preferences</div>
<div class="line">            --convert page breaks <span class="keyword">property</span> can be:</div>
<div class="line">            --column <span class="keywordflow">break</span></div>
<div class="line">            --none</div>
<div class="line">            --page <span class="keywordflow">break</span></div>
<div class="line">            <span class="keyword">set</span> convert page breaks to none</div>
<div class="line">            --convert tables to <span class="keyword">property</span> can be:</div>
<div class="line">            --unformatted tabbed text</div>
<div class="line">            --unformatted table</div>
<div class="line">            <span class="keyword">set</span> convert tables to to Unformatted Table</div>
<div class="line">            <span class="keyword">set</span> <span class="keyword">import</span> endnotes to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> <span class="keyword">import</span> footnotes to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> <span class="keyword">import</span> index to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> <span class="keyword">import</span> TOC to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> <span class="keyword">import</span> unused styles to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> preserve graphics to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> preserve local overrides to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> preserve track changes to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> <span class="keyword">remove</span> formatting to <span class="keyword">false</span></div>
<div class="line">            --resolve character style clash and resolve paragraph style clash properties can be:</div>
<div class="line">            --resolve clash <span class="keyword">auto</span> rename</div>
<div class="line">            --resolve clash use existing</div>
<div class="line">            --resolve clash use <span class="keyword">new</span></div>
<div class="line">            <span class="keyword">set</span> resolve character style clash to resolve clash use existing</div>
<div class="line">            <span class="keyword">set</span> resolve paragraph style clash to resolve clash use existing</div>
<div class="line">            <span class="keyword">set</span> use typographers quotes to <span class="keyword">true</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script shows how to set Excel import preferences (for the complete script, see ExcelImportPreferences): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        tell excel <span class="keyword">import</span> preferences</div>
<div class="line">            --alignment Style <span class="keyword">property</span> can be:</div>
<div class="line">            --center align</div>
<div class="line">            --left align</div>
<div class="line">            --right align</div>
<div class="line">            --spreadsheet</div>
<div class="line">            <span class="keyword">set</span> alignment style to spreadsheet</div>
<div class="line">            <span class="keyword">set</span> decimal places to 4</div>
<div class="line">            <span class="keyword">set</span> preserve graphics to <span class="keyword">false</span></div>
<div class="line">            --Enter the range you want to <span class="keyword">import</span> as <span class="stringliteral">&quot;start cell:end cell&quot;</span>.</div>
<div class="line">            <span class="keyword">set</span> range name to <span class="stringliteral">&quot;A1:B16&quot;</span></div>
<div class="line">            <span class="keyword">set</span> sheet index to 1</div>
<div class="line">            <span class="keyword">set</span> sheet name to <span class="stringliteral">&quot;pathpoints&quot;</span></div>
<div class="line">            <span class="keyword">set</span> show hidden cells to <span class="keyword">false</span></div>
<div class="line">            --table formatting <span class="keyword">property</span> can be:</div>
<div class="line">            --excel formatted table</div>
<div class="line">            --excel unformatted tabbed text</div>
<div class="line">            --excel unformatted table</div>
<div class="line">            <span class="keyword">set</span> table formatting to excel formatted table</div>
<div class="line">            <span class="keyword">set</span> use typographers quotes to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> view name to <span class="stringliteral">&quot;&quot;</span></div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_exporting_text_and_setting_text-export_preferences"></a>
Exporting Text and Setting Text-Export Preferences</h2>
<p>The following script shows how to export text from an InDesign document. Note that you must use text or story objects to export into text file formats; you cannot export all text in a document in one operation. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_creating_a_text_frame">Creating a text frame</a>, " or see the ExportTextFile tutorial script.) </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrame to make text frame with properties {geometric bounds:my myGetBounds(myDocument, myPage), contents:placeholder text}</div>
<div class="line">        end tell</div>
<div class="line">        --Text export method parameters:</div>
<div class="line">        --format as enumeration</div>
<div class="line">        --to alias as <span class="keywordtype">string</span></div>
<div class="line">        --showing options <span class="keywordtype">boolean</span> </div>
<div class="line">        --version comments <span class="keywordtype">string</span> </div>
<div class="line">        --force save <span class="keywordtype">boolean</span> </div>
<div class="line">        --Format parameter can be:</div>
<div class="line">        --InCopy Markup</div>
<div class="line">        --html</div>
<div class="line">        --epub</div>
<div class="line">        --rtf</div>
<div class="line">        --tagged text</div>
<div class="line">        --text type</div>
<div class="line">        --Export the story as text. You<span class="stringliteral">&#39;ll have to fill in a valid file path on your system.</span></div>
<div class="line"><span class="stringliteral">        tell parent story of myTextFrame</span></div>
<div class="line"><span class="stringliteral">            export to &quot;yukino:test.txt&quot; format text type</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">    end tell</span></div>
</div><!-- fragment --><p> The following example shows how to export a specific range of text. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_creating_a_text_frame">Creating a text frame</a>," or see the ExportTextRange tutorial script.) </p>
<div class="fragment"><div class="line">        --Given a document with a text frame on page 1...</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to text frame 1 of page 1 of active document</div>
<div class="line">        <span class="keyword">set</span> myStory to parent story of myTextFrame</div>
<div class="line">        <span class="keyword">set</span> myStartCharacter to index of character 1 of paragraph 1 of myStory</div>
<div class="line">        <span class="keyword">set</span> myEndCharacter to the index of last character of paragraph 1 of myStory</div>
<div class="line">        <span class="keyword">set</span> myText to <span class="keywordtype">object</span> reference of text from character myStartCharacter to character myEndCharacter of myStory</div>
<div class="line">        --Export the text range. You<span class="stringliteral">&#39;ll have to fill in a valid file path on your system.</span></div>
<div class="line"><span class="stringliteral">        tell myText to export to &quot;Macintosh HD:scripting:test.txt&quot; format text type</span></div>
</div><!-- fragment --><p> To specify the export options for the specific type of text file you're exporting, use the corresponding export preferences object. The following script sets text-export preferences (for the complete script, see TextExportPreferences): </p>
<div class="fragment"><div class="line">        tell text export preferences</div>
<div class="line">            --Options <span class="keywordflow">for</span> character <span class="keyword">set</span>:</div>
<div class="line">            --UTF8</div>
<div class="line">            --UTF16</div>
<div class="line">            --platform</div>
<div class="line">            <span class="keyword">set</span> character <span class="keyword">set</span> to UTF8</div>
<div class="line">            --platform options:</div>
<div class="line">            --macintosh</div>
<div class="line">            --pc</div>
<div class="line">            <span class="keyword">set</span> platform to macintosh</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script sets tagged text export preferences (for the complete script, see TaggedTextExportPreferences): </p>
<div class="fragment"><div class="line">        tell tagged text export preferences</div>
<div class="line">            --Options <span class="keywordflow">for</span> character <span class="keyword">set</span>:</div>
<div class="line">            --ansi</div>
<div class="line">            --ascii</div>
<div class="line">            --gb18030</div>
<div class="line">            --ksc5601</div>
<div class="line">            --shiftJIS</div>
<div class="line">            --unicode</div>
<div class="line">            <span class="keyword">set</span> character <span class="keyword">set</span> to unicode</div>
<div class="line">            --tag form options:</div>
<div class="line">            --abbreviated</div>
<div class="line">            --verbose</div>
<div class="line">            <span class="keyword">set</span> tag form to verbose</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> You cannot export all text in a document in one step. Instead, you need to either combine the text in the document into a single story and then export that story, or combine the text files by reading and writing files via scripting. The following script demonstrates the former approach. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_creating_a_text_frame">Creating a text frame</a>, or see the ExportAllText tutorial script.) For any format other than text only, the latter method can become quite complex. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> (count documents) &gt; 0 then</div>
<div class="line">            <span class="keyword">set</span> myDocument to active document</div>
<div class="line">            <span class="keywordflow">if</span> (count stories of myDocument) &gt; 0 then</div>
<div class="line">                my myExportAllText(name of myDocument)</div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">        end <span class="keywordflow">if</span></div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> Here is the ExportAllText handler referred to in the preceding fragment: </p>
<div class="fragment"><div class="line">on myExportAllText(myDocumentName)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        --File name for the exported text. Fill in a valid file path on your system.</div>
<div class="line">        set myFileName to &quot;Adobe:test.txt&quot;</div>
<div class="line">        --If you want to add a separator line between stories, set myAddSeparator to true.</div>
<div class="line">        set myAddSeparator to true</div>
<div class="line">        set myNewDocument to make document</div>
<div class="line">        set myDocument to document myDocumentName</div>
<div class="line">        tell page 1 of myNewDocument</div>
<div class="line">            set myTextFrame to make text frame with properties {geometric bounds:my myGetBounds(myNewDocument, page 1 of myNewDocument)}</div>
<div class="line">            <span class="keyword">set</span> myNewStory to parent story of myTextFrame</div>
<div class="line">            repeat with myCounter from 1 to (count stories in myDocument)</div>
<div class="line">                <span class="keyword">set</span> myStory to story myCounter of myDocument</div>
<div class="line">                --Duplicate the text of the story to the end of the temporary story.</div>
<div class="line">                tell text 1 of myStory</div>
<div class="line">                    duplicate to after insertion point -1 of story 1 of myNewDocument</div>
<div class="line">                end tell</div>
<div class="line">                --If the imported text did not end with a <span class="keywordflow">return</span>, enter a <span class="keywordflow">return</span></div>
<div class="line">                --to keep the stories from running together.</div>
<div class="line">                <span class="keywordflow">if</span> myCounter is not equal to (count stories of myDocument) then</div>
<div class="line">                    <span class="keywordflow">if</span> contents of character -1 of myNewStory is not <span class="keywordflow">return</span> then</div>
<div class="line">                        <span class="keyword">set</span> contents of insertion point -1 of myNewStory to <span class="keywordflow">return</span></div>
<div class="line">                        <span class="keywordflow">if</span> myAddSeparator is <span class="keyword">true</span> then</div>
<div class="line">                            <span class="keyword">set</span> contents of insertion point -1 of myNewStory to <span class="stringliteral">&quot;----------------------------------------&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">                        end <span class="keywordflow">if</span></div>
<div class="line">                    end <span class="keywordflow">if</span></div>
<div class="line">                end <span class="keywordflow">if</span></div>
<div class="line">            end repeat</div>
<div class="line">            tell myNewStory</div>
<div class="line">                export to myFileName format text type</div>
<div class="line">            end tell</div>
<div class="line">            close myNewDocument saving no</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">end myExportAllText</div>
</div><!-- fragment --><p> Do not assume that you are limited to exporting text using existing export filters. Because AppleScript can write text files to disk, you can have your script traverse the text in a document and export it in any order you like, using whatever text mark-up scheme you prefer. Here is a very simple example that shows how to export InDesign text as HTML. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_creating_a_text_frame">Creating a text frame</a>, or see the ExportHTML tutorial script.) </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        --Use the myStyleToTagMapping array to <span class="keyword">set</span> up your paragraph style to tag mapping.</div>
<div class="line">        <span class="keyword">set</span> myStyleToTagMapping to {}</div>
<div class="line">        --For each style to tag mapping, add a <span class="keyword">new</span> item to the array.</div>
<div class="line">        copy {<span class="stringliteral">&quot;body_text&quot;</span>, <span class="stringliteral">&quot;p&quot;</span>} to end of myStyleToTagMapping</div>
<div class="line">        copy {<span class="stringliteral">&quot;heading1&quot;</span>, <span class="stringliteral">&quot;h1&quot;</span>} to end of myStyleToTagMapping</div>
<div class="line">        copy {<span class="stringliteral">&quot;heading2&quot;</span>, <span class="stringliteral">&quot;h3&quot;</span>} to end of myStyleToTagMapping</div>
<div class="line">        copy {<span class="stringliteral">&quot;heading3&quot;</span>, <span class="stringliteral">&quot;h3&quot;</span>} to end of myStyleToTagMapping</div>
<div class="line">        --End of style to tag mapping.</div>
<div class="line">        <span class="keywordflow">if</span> (count documents) is not equal to 0 then</div>
<div class="line">            <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">            <span class="keywordflow">if</span> (count stories of myDocument) is not equal to 0 then</div>
<div class="line">                --Open a <span class="keyword">new</span> text file.</div>
<div class="line">                <span class="keyword">set</span> myTextFile to choose file name with prompt <span class="stringliteral">&quot;Save HTML As&quot;</span></div>
<div class="line">                --Iterate through the stories.</div>
<div class="line">                repeat with myCounter from 1 to (count stories of myDocument)</div>
<div class="line">                    <span class="keyword">set</span> myStory to story myCounter of myDocument</div>
<div class="line">                    repeat with myParagraphCounter from 1 to (count paragraphs of myStory)</div>
<div class="line">                        <span class="keyword">set</span> myParagraph to <span class="keywordtype">object</span> reference of paragraph myParagraphCounter of myStory</div>
<div class="line">                        <span class="keywordflow">if</span> (count tables of myParagraph) is 0 then</div>
<div class="line">                            --If the paragraph is a simple paragraph--no tables, no local formatting--then</div>
<div class="line">                            --simply export the text of the pararaph with the appropriate tag.</div>
<div class="line">                            <span class="keywordflow">if</span> (count text style ranges of myParagraph) is 1 then</div>
<div class="line">                                <span class="keyword">set</span> myTag to my myFindTag(name of applied paragraph style of myParagraph, myStyleToTagMapping)</div>
<div class="line">                                --If the tag comes back empty, map it to the basic paragraph tag.</div>
<div class="line">                                <span class="keywordflow">if</span> myTag = <span class="stringliteral">&quot;&quot;</span> then</div>
<div class="line">                                    <span class="keyword">set</span> myTag to <span class="stringliteral">&quot;p&quot;</span></div>
<div class="line">                                end <span class="keywordflow">if</span></div>
<div class="line">                                <span class="keyword">set</span> myStartTag to <span class="stringliteral">&quot;&lt;&quot;</span> &amp; myTag &amp; <span class="stringliteral">&quot;&gt;&quot;</span></div>
<div class="line">                                <span class="keyword">set</span> myEndTag to <span class="stringliteral">&quot;&lt;/&quot;</span> &amp; myTag &amp; <span class="stringliteral">&quot;&gt;&quot;</span></div>
<div class="line">                                --If the paragraph is not the last paragraph in the story,</div>
<div class="line">                                --omit the <span class="keywordflow">return</span> character.</div>
<div class="line">                                <span class="keywordflow">if</span> the contents of character -1 of myParagraph is <span class="keywordflow">return</span> then</div>
<div class="line">                                    <span class="keyword">set</span> myText to <span class="keywordtype">object</span> reference of text from character 1 to character -2 of myParagraph</div>
<div class="line">                                    <span class="keyword">set</span> myString to contents of myText</div>
<div class="line">                                <span class="keywordflow">else</span></div>
<div class="line">                                    <span class="keyword">set</span> myString to contents of myParagraph</div>
<div class="line">                                end <span class="keywordflow">if</span></div>
<div class="line">                                --Write the text of the paragraph to the text file.</div>
<div class="line">                                <span class="keywordflow">if</span> myParagraphCounter = 1 then</div>
<div class="line">                                    <span class="keyword">set</span> myAppendData to <span class="keyword">false</span></div>
<div class="line">                                <span class="keywordflow">else</span></div>
<div class="line">                                    <span class="keyword">set</span> myAppendData to <span class="keyword">true</span></div>
<div class="line">                                end <span class="keywordflow">if</span></div>
<div class="line">                                my myWriteToFile(myStartTag &amp; myString &amp; myEndTag &amp; <span class="keywordflow">return</span>, myTextFile, myAppendData)</div>
<div class="line">                            else</div>
<div class="line">                                --Handle text style range export by iterating through the text style ranges in the paragraph.</div>
<div class="line">                                set myTextStyleRanges to text style ranges of myParagraph</div>
<div class="line">                                repeat with myRangeCounter from 1 to (count text style ranges of myParagraph)</div>
<div class="line">                                    set myTextStyleRange to <span class="keywordtype">object</span> reference of text style range myRangeCounter of myParagraph</div>
<div class="line">                                    if character -1 of myTextStyleRange is return then</div>
<div class="line">                                        set myStartCharacter to index of character 1 of myTextStyleRange</div>
<div class="line">                                        set myEndCharacter to index of character -2 of myTextStyleRange</div>
<div class="line">                                        set myText to <span class="keywordtype">object</span> reference of text from character myStartCharacter to character myEndCharacter of myStory</div>
<div class="line">                                        set myString to contents of myText</div>
<div class="line">                                    else</div>
<div class="line">                                        set myString to contents of myTextStyleRange</div>
<div class="line">                                    end if</div>
<div class="line">                                    if font style of myTextStyleRange is &quot;Bold&quot; then</div>
<div class="line">                                        set myString to &quot;&lt;b&gt;&quot; &amp; myString &amp; &quot;&lt;/b&gt;&quot;</div>
<div class="line">                                    else if font style of myTextStyleRange is &quot;Italic&quot; then</div>
<div class="line">                                        set myString to &quot;&lt;i&gt;&quot; &amp; myString &amp; &quot;&lt;/i&gt;&quot;</div>
<div class="line">                                    end if</div>
<div class="line">                                    my myWriteToFile(myString, myTextFile, true)</div>
<div class="line">                                end repeat</div>
<div class="line">                                my myWriteToFile(return, myTextFile, true)</div>
<div class="line">                            end if</div>
<div class="line">                        else</div>
<div class="line">                            --Handle table export (assumes that there is only one table per paragraph,</div>
<div class="line">                            --and that the table is in the paragraph by itself).</div>
<div class="line">                            set myTable to table 1 of myParagraph</div>
<div class="line">                            my myWriteToFile(&quot;&lt;table border = 1&gt;&quot;, myTextFile, true)</div>
<div class="line">                            repeat with myRowCounter from 1 to (count rows of myTable)</div>
<div class="line">                                my myWriteToFile(&quot;&lt;tr&gt;&quot;, myTextFile, true)</div>
<div class="line">                                repeat with myColumnCounter from 1 to (count columns of myTable)</div>
<div class="line">                                    if myRowCounter = 1 then</div>
<div class="line">                                        set myString to &quot;&lt;th&gt;&quot;</div>
<div class="line">                                        set myString to myString &amp; text 1 of cell myColumnCounter of row myRowCounter of myTable</div>
<div class="line">                                        set myString to myString &amp; &quot;&lt;/th&gt;&quot;</div>
<div class="line">                                    else</div>
<div class="line">                                        set myString to &quot;&lt;td&gt;&quot;</div>
<div class="line">                                        set myString to myString &amp; text 1 of cell myColumnCounter of row myRowCounter of myTable</div>
<div class="line">                                        set myString to myString &amp; &quot;&lt;/td&gt;&quot;</div>
<div class="line">                                    end if</div>
<div class="line">                                    my myWriteToFile(myString, myTextFile, true)</div>
<div class="line">                                end repeat</div>
<div class="line">                                my myWriteToFile(&quot;&lt;/tr&gt;&quot; &amp; return, myTextFile, true)</div>
<div class="line">                            end repeat</div>
<div class="line">                            my myWriteToFile(&quot;&lt;/table&gt;&quot; &amp; return, myTextFile, true)</div>
<div class="line">                        end if</div>
<div class="line">                    end repeat</div>
<div class="line">                end repeat</div>
<div class="line">            end if</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">on myFindTag(myStyleName, myStyleToTagMapping)</div>
<div class="line">    local myTag, myDone, myStyleName</div>
<div class="line">    set myTag to &quot;&quot;</div>
<div class="line">    set myDone to false</div>
<div class="line">    repeat with myStyleToTagMap in myStyleToTagMapping</div>
<div class="line">        if item 1 of myStyleToTagMap = myStyleName then</div>
<div class="line">            set myTag to item 2 of myStyleToTagMap</div>
<div class="line">            exit repeat</div>
<div class="line">        end if</div>
<div class="line">    end repeat</div>
<div class="line">    return myTag</div>
<div class="line">end myFindTag</div>
<div class="line">on myWriteToFile(myString, myFileName, myAppendData)</div>
<div class="line">    set myTextFile to open for access myFileName with write permission</div>
<div class="line">    if myAppendData is false then</div>
<div class="line">        set eof of myTextFile to 0</div>
<div class="line">    end if</div>
<div class="line">    write myString to myTextFile starting at eof</div>
<div class="line">    close access myTextFile</div>
<div class="line">end myWriteToFile</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_understanding_text_objects"></a>
Understanding Text Objects</h2>
<p>The following diagram shows a view of InDesign's text object model. As you can see, there are two main types of text object: layout objects (text frames) and text-stream objects (for example, stories, insertion points, characters, and words): </p>
<div class="image">
<img src="InDesign_ScriptingGuide-3.gif" alt="InDesign_ScriptingGuide-3.gif"/>
</div>
<p>There are many ways to get a reference to a given text object. The following diagram shows a few ways to refer to the first character in the first text frame of the first page of a new document: </p>
<div class="image">
<img src="InDesign_ScriptingGuide-4.gif" alt="InDesign_ScriptingGuide-4.gif"/>
</div>
<p>For any text stream object, the parent of the object is the story containing the object. To get a reference to the text frame (or text frames) containing the text object, use the parent text frames property.</p>
<p>For a text frame, the parent of the text frame usually is the page or spread containing the text frame. If the text frame is inside a group or was pasted inside another page item, the parent of the text frame is the containing page item. If the text frame was converted to an anchored frame, the parent of the text frame is the character containing the anchored frame.</p>
<h3><a class="anchor" id="id_as_working_with_text_selections"></a>
Working with text selections</h3>
<p>Text-related scripts often act on a text selection. The following script demonstrates a way to determine whether the current selection is a text selection. Unlike many of the other sample scripts, this script does not actually do anything; it simply presents a selection-filtering routine that you can use in your own scripts (for the complete script, see TextSelection). </p>
<div class="fragment"><div class="line">        <span class="keywordflow">if</span> (count documents) is not equal to 0 then</div>
<div class="line">            --If the selection contains more than one item, the selection</div>
<div class="line">            --is not text selected with the Type tool.</div>
<div class="line">            <span class="keyword">set</span> mySelection to selection</div>
<div class="line">            <span class="keywordflow">if</span> (count mySelection) is not equal to 0 then</div>
<div class="line">                --Evaluate the selection based on its type.</div>
<div class="line">                <span class="keyword">set</span> myTextClasses to {insertion point, word, text style range, line, paragraph, text column, text, story}</div>
<div class="line">                <span class="keywordflow">if</span> <span class="keyword">class </span>of item 1 of selection is in myTextClasses then</div>
<div class="line">                    --The object is a text object; display the text <span class="keywordtype">object</span> type.</div>
<div class="line">                    --A practical script would <span class="keywordflow">do</span> something with the selection,</div>
<div class="line">                    --or pass the selection on to a <span class="keyword">function</span>.</div>
<div class="line">                    display dialog (<span class="stringliteral">&quot;Selection is a text object.&quot;</span>)</div>
<div class="line">                    --If the selection is inside a note, the parent of the selection</div>
<div class="line">                    --will be a note <span class="keywordtype">object</span>.</div>
<div class="line">                    <span class="keywordflow">if</span> <span class="keyword">class </span>of parent of item 1 of selection is note then</div>
<div class="line">                        display dialog (&quot;Selection is inside a note.&quot;)</div>
<div class="line">                    end if</div>
<div class="line">                else if class of item 1 of selection is text frame then</div>
<div class="line">                    display dialog (&quot;Selection is a text frame&quot;)</div>
<div class="line">                else</div>
<div class="line">                    display dialog (&quot;Selected item is not a text object.&quot;)</div>
<div class="line">                end if</div>
<div class="line">            else</div>
<div class="line">                display dialog (&quot;Please select some text and try again.&quot;)</div>
<div class="line">            end if</div>
<div class="line">        else</div>
<div class="line">            display dialog (&quot;No documents are open.&quot;)</div>
<div class="line">        end if</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_moving_and_copying_text"></a>
Moving and copying text</h3>
<p>You can move a text object to another location in text using the move method. To copy the text, use the duplicate method (whose arguments are identical to the move method). The following script fragment shows how it works (for the complete script, see MoveText): </p>
<div class="fragment"><div class="line">        --Given a document myDocument<span class="stringliteral">&quot; with four text frams on page 1...</span></div>
<div class="line"><span class="stringliteral">        set myTextFrameA to text frame 4 of page 1 of myDocument</span></div>
<div class="line"><span class="stringliteral">        set myTextFrameB to text frame 3 of page 1 of myDocument</span></div>
<div class="line"><span class="stringliteral">        set myTextFrameC to text frame 2 of page 1 of myDocument</span></div>
<div class="line"><span class="stringliteral">        set myTextFrameD to text frame 1 of page 1 of myDocument</span></div>
<div class="line"><span class="stringliteral">        --Note that moving text removes it from its original location.</span></div>
<div class="line"><span class="stringliteral">        tell parent story of myTextFrameD</span></div>
<div class="line"><span class="stringliteral">            --Move WordC between the words in TextFrameC.</span></div>
<div class="line"><span class="stringliteral">            move paragraph 4 to before word -1 of paragraph 1 of parent story of myTextFrameC</span></div>
<div class="line"><span class="stringliteral">            --Move WordB after the word in TextFrameB.</span></div>
<div class="line"><span class="stringliteral">            move paragraph 3 to after insertion point -1 of myTextFrameB</span></div>
<div class="line"><span class="stringliteral">            --Move WordA to before the word in TextFrameA.</span></div>
<div class="line"><span class="stringliteral">            move paragraph 2 to before word 1 in myTextFrameA</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">    end tell</span></div>
</div><!-- fragment --><p> When you want to transfer formatted text from one document to another, you also can use the move method. Using the move or duplicate method is better than using copy and paste; to use copy and paste, you must make the document visible and select the text you want to copy. Using move or duplicate is much faster and more robust. The following script shows how to move text from one document to another using move and duplicate. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_creating_a_text_frame">Creating a text frame</a>, or see the MoveTextBetweenDocuments tutorial script.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;mySourceDocument&quot;</span>...</div>
<div class="line">        <span class="keyword">set</span> mySourceStory to story 1 of mySourceDocument</div>
<div class="line">        --Create a <span class="keyword">new</span> document to move the text to.</div>
<div class="line">        <span class="keyword">set</span> myTargetDocument to make document</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myTargetDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrame to make text frame with properties {geometric bounds:my myGetBounds(myTargetDocument, myPage)}</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myTargetStory to story 1 of myTargetDocument</div>
<div class="line">        <span class="keyword">set</span> contents of myTargetStory to <span class="stringliteral">&quot;This is the target text. Insert the source text after this paragraph.&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        duplicate paragraph 1 of mySourceStory to after insertion point -1 of myTargetStory</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> When you need to copy and paste text, you can use the copy method of the application. You will need to select the text before you copy. Again, you should use copy and paste only as a last resort; other approaches are faster, less fragile, and do not depend on the document being visible. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_creating_a_text_frame">Creating a text frame</a>, or see the CopyPasteText tutorial script.) </p>
<div class="fragment"><div class="line">        --Given an open document with a text frame on page 1</div>
<div class="line">        <span class="keyword">set</span> myDocumentA to document 1</div>
<div class="line">        <span class="keyword">set</span> myTextFrameA to text frame 1 of page 1 of myDocumentA</div>
<div class="line">        --Create another example document.</div>
<div class="line">        <span class="keyword">set</span> myDocumentB to make document</div>
<div class="line">        <span class="keyword">set</span> myPageB to page 1 of myDocumentB</div>
<div class="line">        tell myPageB</div>
<div class="line">            <span class="keyword">set</span> myTextFrameB to make text frame with properties {geometric bounds:my myGetBounds(myDocumentB, myPageB)}</div>
<div class="line">        end tell</div>
<div class="line">        --Make document A the active document.</div>
<div class="line">        <span class="keyword">set</span> active document to myDocumentA</div>
<div class="line">        --Select the text.</div>
<div class="line">        select text 1 of parent story of myTextFrameA</div>
<div class="line">        copy</div>
<div class="line">        --Make document B the active document.</div>
<div class="line">        <span class="keyword">set</span> active document to myDocumentB</div>
<div class="line">        --Select the insertion point at which you want to paste the text.</div>
<div class="line">        select insertion point -1 of myTextFrameB</div>
<div class="line">        paste</div>
</div><!-- fragment --><p> One way to copy unformatted text from one text object to another is to get the contents property of a text object, then use that string to set the contents property of another text object. The following script shows how to do this (for the complete script, see CopyUnformattedText): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrameA to make text frame with properties {geometric bounds:{72, 72, 144, 288}}</div>
<div class="line">            <span class="keyword">set</span> contents of myTextFrameA to <span class="stringliteral">&quot;This is a formatted string.&quot;</span></div>
<div class="line">            <span class="keyword">set</span> font style of text 1 of parent story of myTextFrameA to <span class="stringliteral">&quot;Bold&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myTextFrameB to make text frame with properties {geometric bounds:{228, 72, 300, 288}}</div>
<div class="line">            <span class="keyword">set</span> contents of myTextFrameB to <span class="stringliteral">&quot;This is the destination text frame. Text pasted here will retain its formatting.&quot;</span></div>
<div class="line">            <span class="keyword">set</span> font style of text 1 of myTextFrameB to <span class="stringliteral">&quot;Italic&quot;</span></div>
<div class="line">        end tell</div>
<div class="line">        --Copy from one frame to another <span class="keyword">using</span> a simple copy.</div>
<div class="line">        select text 1 of myTextFrameA</div>
<div class="line">        copy</div>
<div class="line">        select insertion point -1 of myTextFrameB</div>
<div class="line">        paste</div>
<div class="line">        --Create another text frame on the active page.</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrameC to make text frame with properties {geometric bounds:{312, 72, 444, 288}}</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> contents of myTextFrameC to <span class="stringliteral">&quot;Text copied here will take on the formatting of the existing text.&quot;</span></div>
<div class="line">        <span class="keyword">set</span> font style of text 1 of parent story of myTextFrameC to <span class="stringliteral">&quot;Italic&quot;</span></div>
<div class="line">        --Copy the unformatted <span class="keywordtype">string</span> from text frame A to the end of text frame C (note</div>
<div class="line">        --that <span class="keyword">this</span> doesn<span class="stringliteral">&#39;t really copy the text it replicates the text string from one</span></div>
<div class="line"><span class="stringliteral">        --text frame in another text frame):</span></div>
<div class="line"><span class="stringliteral">        set contents of insertion point -1 of myTextFrameC to contents of text 1 of parent story of myTextFrameA</span></div>
<div class="line"><span class="stringliteral">    end tell</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_text_objects_and_iteration"></a>
Text objects and iteration</h3>
<p>When your script moves, deletes, or adds text while iterating through a series of text objects, you can easily end up with invalid text references. The following script demonstrates this problem. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_creating_a_text_frame">Creating a text frame</a>, or see the TextIterationWrong tutorial script.) </p>
<div class="fragment"><div class="line">        --The following <span class="keywordflow">for</span> loop will fail to format all of the paragraphs </div>
<div class="line">        --and then generate an error.</div>
<div class="line">        repeat with myParagraphCounter from 1 to (count paragraphs of myStory)</div>
<div class="line">            <span class="keywordflow">if</span> contents of word 1 of paragraph myParagraphCounter of myStory is <span class="stringliteral">&quot;Delete&quot;</span> then</div>
<div class="line">                tell paragraph myParagraphCounter of myStory to <span class="keyword">delete</span></div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                <span class="keyword">set</span> point size of paragraph myParagraphCounter of myStory to 24</div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">        end repeat</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> In the preceding example, some of the paragraphs are left unformatted. How does this happen? The loop in the script iterates through the paragraphs from the first paragraph in the story to the last. As it does so, it deletes paragraphs that begin with the word "Delete." When the script deletes the second paragraph, the third paragraph moves up to take its place. When the loop counter reaches 3, the script processes the paragraph that had been the fourth paragraph in the story; the original third paragraph is now the second paragraph and is skipped.</p>
<p>To avoid this problem, iterate backward through the text objects, as shown in the following script. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_creating_a_text_frame">Creating a text frame</a>, or see the TextIterationRight tutorial script.) </p>
<div class="fragment"><div class="line">        --By iterating backwards we can avoid the error.</div>
<div class="line">        repeat with myParagraphCounter from (count paragraphs of myStory) to 1 by -1</div>
<div class="line">            <span class="keywordflow">if</span> contents of word 1 of paragraph myParagraphCounter of myStory is <span class="stringliteral">&quot;Delete&quot;</span> then</div>
<div class="line">                tell paragraph myParagraphCounter of myStory to <span class="keyword">delete</span></div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                <span class="keyword">set</span> point size of paragraph myParagraphCounter of myStory to 24</div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">        end repeat</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_working_with_text_frames"></a>
Working with Text Frames</h2>
<p>In the previous sections of this chapter, we concentrated on working with text stream objects; in this section, we focus on text frames, the page-layout items that contain text in an InDesign document.</p>
<h3><a class="anchor" id="id_as_linking_text_frames"></a>
Linking text frames</h3>
<p>The nextTextFrame and previousTextFrame properties of a text frame are the keys to linking (or "threading") text frames in InDesign scripting. These properties correspond to the in port and out port on InDesign text frames, as shown in the following script fragment (for the complete script, see LinkTextFrames): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> with two unlinked text frames on page 1...</div>
<div class="line">        <span class="keyword">set</span> myTextFrameA to text frame 2 of page 1 of document 1</div>
<div class="line">        <span class="keyword">set</span> myTextFrameB to text frame 1 of page 1 of document 1</div>
<div class="line">        --Link TextFrameA to TextFrameB <span class="keyword">using</span> the next text frame <span class="keyword">property</span>.</div>
<div class="line">        <span class="keyword">set</span> next text frame of myTextFrameA to myTextFrameB</div>
<div class="line">        --Add a page.</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myNewPage to make page</div>
<div class="line">        end tell</div>
<div class="line">        --Create another text frame on the <span class="keyword">new</span> page.</div>
<div class="line">        tell myNewPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrameC to make text frame with properties {geometric bounds:{72, 72, 144, 144}}</div>
<div class="line">            --Link TextFrameC to TextFrameB <span class="keyword">using</span> the previousTextFrame <span class="keyword">property</span>.</div>
<div class="line">            <span class="keyword">set</span> previous text frame of myTextFrameC to myTextFrameB</div>
<div class="line">            --Fill the text frames with placeholder text.</div>
<div class="line">            <span class="keyword">set</span> contents of myTextFrameA to placeholder text</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_unlinking_text_frames"></a>
Unlinking text frames</h3>
<p>The following example script shows how to unlink text frames (for the complete script, see UnlinkTextFrames): </p>
<div class="fragment"><div class="line">        --Unlink the two text frames.</div>
<div class="line">        <span class="keyword">set</span> next text frame of myTextFrameA to nothing</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_removing_a_frame_from_a_story"></a>
Removing a frame from a story</h3>
<p>In InDesign, deleting a frame from a story does not delete the text in the frame, unless the frame is the only frame in the story. The following script fragment shows how to delete a frame and the text it contains from a story without disturbing the other frames in the story (for the complete script, see BreakFrame): </p>
<div class="fragment"><div class="line">    <span class="keyword">set</span> myObjectList to {}</div>
<div class="line">    --Script does nothing <span class="keywordflow">if</span> no documents are open or <span class="keywordflow">if</span> no objects are selected.</div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> (count documents) is not equal to 0 then</div>
<div class="line">            <span class="keyword">set</span> mySelection to selection</div>
<div class="line">            <span class="keywordflow">if</span> (count mySelection) is not equal to 0 then</div>
<div class="line">                --Process the objects in the selection to create a list of</div>
<div class="line">                --qualifying objects (text frames).</div>
<div class="line">                repeat with myCounter from 1 to (count mySelection)</div>
<div class="line">                    <span class="keywordflow">if</span> <span class="keyword">class </span>of item myCounter of mySelection is text frame then</div>
<div class="line">                        set myObjectList to myObjectList &amp; item myCounter of mySelection</div>
<div class="line">                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">class </span>of item myCounter of mySelection is in {text, insertion point, character, word, line, text style range, paragraph, text column} then</div>
<div class="line">                        <span class="keyword">set</span> myObject to item 1 of parent text frames of item myCounter of mySelection</div>
<div class="line">                        <span class="keyword">set</span> myObjectList to myObjectList &amp; myObject</div>
<div class="line">                    end <span class="keywordflow">if</span></div>
<div class="line">                end repeat</div>
<div class="line">                --If the <span class="keywordtype">object</span> list is not empty, pass it on to the handler</div>
<div class="line">                --that does the real work.</div>
<div class="line">                <span class="keywordflow">if</span> (count myObjectList) is not equal to 0 then</div>
<div class="line">                    my myBreakFrames(myObjectList)</div>
<div class="line">                end if</div>
<div class="line">            end if</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> Here is the myBreakFrames handler referred to in the preceding script. </p>
<div class="fragment"><div class="line">on myBreakFrames(myObjectList)</div>
<div class="line">    repeat with myCounter from 1 to (count myObjectList)</div>
<div class="line">        my myBreakFrame(item myCounter of myObjectList)</div>
<div class="line">    end repeat</div>
<div class="line">end myBreakFrames</div>
<div class="line">on myBreakFrame(myTextFrame)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        if next text frame of myTextFrame is not equal to nothing and previous text frame of myTextFrame is not equal to nothing then</div>
<div class="line">            set myNewFrame to duplicate myTextFrame</div>
<div class="line">            if contents of myTextFrame is not equal to &quot;&quot; then</div>
<div class="line">                tell text 1 of myTextFrame to delete</div>
<div class="line">            end if</div>
<div class="line">            delete myTextFrame</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
<div class="line">end myBreakFrame</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_splitting_all_frames_in_a_story"></a>
Splitting all frames in a story</h3>
<p>The following script fragment shows how to split all frames in a story into separate, independent stories, each containing one unlinked text frame (for the complete script, see SplitStory): </p>
<div class="fragment"><div class="line">on mySplitStory(myStory)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        tell document 1</div>
<div class="line">            local myTextContainers</div>
<div class="line">            set myTextContainers to text containers in myStory</div>
<div class="line">            if (count myTextContainers) is greater than 1 then</div>
<div class="line">                repeat with myCounter from (count myTextContainers) to 1 by -1</div>
<div class="line">                    set myTextFrame to item myCounter of myTextContainers</div>
<div class="line">                    tell myTextFrame</div>
<div class="line">                        duplicate</div>
<div class="line">                        if text 1 of myTextFrame is not equal to &quot;&quot; then</div>
<div class="line">                            tell text 1 of myTextFrame</div>
<div class="line">                                delete</div>
<div class="line">                            end tell</div>
<div class="line">                        end if</div>
<div class="line">                        delete</div>
<div class="line">                    end tell</div>
<div class="line">                end repeat</div>
<div class="line">            end if</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">end mySplitStory</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_creating_an_anchored_frame"></a>
Creating an anchored frame</h3>
<p>To create an anchored frame (also known as an inline frame), you can create a text frame (or rectangle, oval, polygon, or graphic line) at a specific location in text (usually an insertion point). The following script fragment shows an example (for the complete script, see AnchoredFrame): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> with a text frame on page 1...</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to text frame 1 of myPage</div>
<div class="line">        tell insertion point 1 of paragraph 1 of myTextFrame</div>
<div class="line">            <span class="keyword">set</span> myInlineFrame to make text frame</div>
<div class="line">        end tell</div>
<div class="line">        --Recompose the text to make sure that getting the </div>
<div class="line">        --geometric bounds of the <span class="keyword">inline</span> graphic will work.</div>
<div class="line">        tell text 1 of myTextFrame to recompose</div>
<div class="line">        --Get the geometric bounds of the <span class="keyword">inline</span> frame.</div>
<div class="line">        <span class="keyword">set</span> myBounds to geometric bounds of myInlineFrame</div>
<div class="line">        --Set the width and height of the <span class="keyword">inline</span> frame. In <span class="keyword">this</span> example, we<span class="stringliteral">&#39;ll</span></div>
<div class="line"><span class="stringliteral">        --make the frame 24 points tall by 72 points wide.</span></div>
<div class="line"><span class="stringliteral">        set e1 to item 1 of myBounds</span></div>
<div class="line"><span class="stringliteral">        set e2 to item 2 of myBounds</span></div>
<div class="line"><span class="stringliteral">        set e3 to (item 1 of myBounds) + 24</span></div>
<div class="line"><span class="stringliteral">        set e4 to (item 2 of myBounds) + 72</span></div>
<div class="line"><span class="stringliteral">        set geometric bounds of myInlineFrame to {e1, e2, e3, e4}</span></div>
<div class="line"><span class="stringliteral">        set contents of myInlineFrame to &quot;This is an inline frame.&quot;</span></div>
<div class="line"><span class="stringliteral">        tell insertion point 1 of paragraph 2 of myTextFrame</span></div>
<div class="line"><span class="stringliteral">            set myAnchoredFrame to make text frame</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">        --Recompose the text to make sure that getting the </span></div>
<div class="line"><span class="stringliteral">        --geometric bounds of the inline graphic will work.</span></div>
<div class="line"><span class="stringliteral">        tell text 1 of myTextFrame to recompose</span></div>
<div class="line"><span class="stringliteral">        --Get the geometric bounds of the inline frame.</span></div>
<div class="line"><span class="stringliteral">        set myBounds to geometric bounds of myAnchoredFrame</span></div>
<div class="line"><span class="stringliteral">        --Set the width and height of the inline frame. In this example, we&#39;</span>ll</div>
<div class="line">        --make the frame 24 points tall by 72 points wide.</div>
<div class="line">        <span class="keyword">set</span> e1 to item 1 of myBounds</div>
<div class="line">        <span class="keyword">set</span> e2 to item 2 of myBounds</div>
<div class="line">        <span class="keyword">set</span> e3 to (item 1 of myBounds) + 24</div>
<div class="line">        <span class="keyword">set</span> e4 to (item 2 of myBounds) + 72</div>
<div class="line">        <span class="keyword">set</span> geometric bounds of myAnchoredFrame to {e1, e2, e3, e4}</div>
<div class="line">        <span class="keyword">set</span> contents of myAnchoredFrame to <span class="stringliteral">&quot;This is an anchored frame.&quot;</span></div>
<div class="line">        tell anchored <span class="keywordtype">object</span> settings of myAnchoredFrame</div>
<div class="line">            <span class="keyword">set</span> anchored position to anchored</div>
<div class="line">            <span class="keyword">set</span> anchor point to top left anchor</div>
<div class="line">            <span class="keyword">set</span> horizontal reference point to anchor location</div>
<div class="line">            <span class="keyword">set</span> horizontal alignment to left align</div>
<div class="line">            <span class="keyword">set</span> anchor xoffset to 72</div>
<div class="line">            <span class="keyword">set</span> vertical reference point to line baseline</div>
<div class="line">            <span class="keyword">set</span> anchor yoffset to 24</div>
<div class="line">            <span class="keyword">set</span> anchor space above to 24</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_fitting_text_frames_to_content"></a>
Fitting text frames to content</h3>
<p>The following example script shows how to set rules on a text frame to determine how it grows when the user inputs text (for the complete script, see PersistedTextFrameFill): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrame to text frame 4 of myPage</div>
<div class="line">            --Now add text at the end of the text frame.</div>
<div class="line">            <span class="keyword">set</span> myString to <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;this is some overset text&quot;</span></div>
<div class="line">            tell insertion point -1 of myTextFrame to <span class="keyword">set</span> contents to myString</div>
<div class="line">            <span class="keyword">set</span> myString to contents of text 1 of myTextFrame</div>
<div class="line">            display dialog (<span class="stringliteral">&quot;The last paragraph in this alert should be \&quot;This is some overset text\&quot;. Is it?&quot;</span> &amp; <span class="keywordflow">return</span> &amp; myString)</div>
<div class="line">            <span class="keyword">set</span> myString to contents of parent story of myTextFrame</div>
<div class="line">            display dialog (<span class="stringliteral">&quot;The last paragraph in this alert should be \&quot;This is some overset text\&quot;. Is it?&quot;</span> &amp; <span class="keywordflow">return</span> &amp; myString)</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrame2 to text frame 3 of myPage</div>
<div class="line">            --Set <span class="keyword">auto</span> sizing demension of the text frame</div>
<div class="line">            tell text frame preferences of myTextFrame2</div>
<div class="line">                <span class="keyword">set</span> <span class="keyword">auto</span> sizing type to height and width proportionally</div>
<div class="line">            end tell</div>
<div class="line">            --Now add text at the end of the text frame.</div>
<div class="line">            <span class="keyword">set</span> myString to <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;this is some overset text&quot;</span></div>
<div class="line">            tell insertion point -1 of myTextFrame2 to <span class="keyword">set</span> contents to myString</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrame3 to text frame 2 of myPage</div>
<div class="line">            --Set  <span class="keyword">auto</span> sizing demension of the text frame </div>
<div class="line">            --useMinimumHeightForAutoSizing and useNoLineBreaksForAutoSizing</div>
<div class="line">            tell text frame preferences of myTextFrame3</div>
<div class="line">                <span class="keyword">set</span> <span class="keyword">auto</span> sizing type to height only</div>
<div class="line">                <span class="keyword">set</span> use minimum height <span class="keywordflow">for</span> <span class="keyword">auto</span> sizing to <span class="keyword">true</span></div>
<div class="line">                <span class="keyword">set</span> use no line breaks <span class="keywordflow">for</span> <span class="keyword">auto</span> sizing to <span class="keyword">true</span></div>
<div class="line">            end tell</div>
<div class="line">            --Now add text at the end of the text frame.</div>
<div class="line">            <span class="keyword">set</span> myString to <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;this is some overset text&quot;</span></div>
<div class="line">            tell insertion point -1 of myTextFrame3 to <span class="keyword">set</span> contents to myString</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrame4 to text frame 1 of myPage</div>
<div class="line">            --Set  <span class="keyword">auto</span> size demension of the text frame and <span class="keyword">auto</span> sizing reference point</div>
<div class="line">            tell text frame preferences of myTextFrame4</div>
<div class="line">                <span class="keyword">set</span> <span class="keyword">auto</span> sizing type to width only</div>
<div class="line">                <span class="keyword">set</span> <span class="keyword">auto</span> sizing reference point to top left position</div>
<div class="line">            end tell</div>
<div class="line">            --Now add text at the end of the text frame.</div>
<div class="line">            <span class="keyword">set</span> myString to <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;this is some overset text&quot;</span></div>
<div class="line">            tell insertion point -1 of myTextFrame4 to <span class="keyword">set</span> contents to myString</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_formatting_text"></a>
Formatting Text</h2>
<p>In the previous sections of this chapter, we added text to a document, linked text frames, and worked with stories and text objects. In this section, we apply formatting to text. All the typesetting capabilities of InDesign are available to scripting.</p>
<h3><a class="anchor" id="id_as_setting_text_defaults"></a>
Setting text defaults</h3>
<p>You can set text defaults for both the application and each document. Text defaults for the application determine the text defaults in all new documents; text defaults for a document set the formatting of all new text objects in that document. (For the complete script, see TextDefaults.) </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> horizontal measurement units of view preferences to points</div>
<div class="line">        <span class="keyword">set</span> vertical measurement units of view preferences to points</div>
<div class="line">        --To <span class="keyword">set</span> the text formatting defaults <span class="keywordflow">for</span> a document, replace <span class="stringliteral">&quot;app&quot;</span> </div>
<div class="line">        --in the following lines with a reference to a document.</div>
<div class="line">        tell text defaults</div>
<div class="line">            <span class="keyword">set</span> alignToBaseline to <span class="keyword">true</span></div>
<div class="line">            --Because the font might not be available, it<span class="stringliteral">&#39;s usually best</span></div>
<div class="line"><span class="stringliteral">            --to apply the font within a try...catch structure. Fill in the</span></div>
<div class="line"><span class="stringliteral">            --name of a font on your system.</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set appliedFont to font &quot;Minion Pro&quot;</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            --Because the font style might not be available, it&#39;</span>s usually best</div>
<div class="line">            --to apply the font style within a <span class="keywordflow">try</span>...catch structure.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> font style to <span class="stringliteral">&quot;Regular&quot;</span></div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            --Because the language might not be available, it<span class="stringliteral">&#39;s usually best</span></div>
<div class="line"><span class="stringliteral">            --to apply the language within a try...catch structure.</span></div>
<div class="line"><span class="stringliteral">            try</span></div>
<div class="line"><span class="stringliteral">                set applied language to &quot;English: USA&quot;</span></div>
<div class="line"><span class="stringliteral">            end try</span></div>
<div class="line"><span class="stringliteral">            set autoLeading to 100</span></div>
<div class="line"><span class="stringliteral">            set balsanceRaggedLines to false</span></div>
<div class="line"><span class="stringliteral">            set baselineShift to 0</span></div>
<div class="line"><span class="stringliteral">            set capitalization to normal</span></div>
<div class="line"><span class="stringliteral">            set composer to &quot;Adobe Paragraph Composer&quot;</span></div>
<div class="line"><span class="stringliteral">            set desiredGlyphScaling to 100</span></div>
<div class="line"><span class="stringliteral">            set desiredLetterSpacing to 0</span></div>
<div class="line"><span class="stringliteral">            set desiredWordSpacing to 100</span></div>
<div class="line"><span class="stringliteral">            set drop cap characters to 0</span></div>
<div class="line"><span class="stringliteral">            if drop cap characters is not equal to 0 then</span></div>
<div class="line"><span class="stringliteral">                dropCapLines to 3</span></div>
<div class="line"><span class="stringliteral">                --Assumes that the application has a default character style named &quot;myDropCap&quot;</span></div>
<div class="line"><span class="stringliteral">                set drop cap style to character style &quot;myDropCap&quot;</span></div>
<div class="line"><span class="stringliteral">            end if</span></div>
<div class="line"><span class="stringliteral">            set fill color to &quot;Black&quot;</span></div>
<div class="line"><span class="stringliteral">            set fill tint to 100</span></div>
<div class="line"><span class="stringliteral">            set first line indent to 14</span></div>
<div class="line"><span class="stringliteral">            set grid align first line only to false</span></div>
<div class="line"><span class="stringliteral">            set horizontal scale to 100</span></div>
<div class="line"><span class="stringliteral">            set hyphenate after first to 3</span></div>
<div class="line"><span class="stringliteral">            set hyphenate before last to 4</span></div>
<div class="line"><span class="stringliteral">            set hyphenate capitalized words to false</span></div>
<div class="line"><span class="stringliteral">            set hyphenate ladder limit to 1</span></div>
<div class="line"><span class="stringliteral">            set hyphenate words longer than to 5</span></div>
<div class="line"><span class="stringliteral">            set hyphenation to true</span></div>
<div class="line"><span class="stringliteral">            set hyphenation zone to 36</span></div>
<div class="line"><span class="stringliteral">            set hyphen weight to 9</span></div>
<div class="line"><span class="stringliteral">            set justification to left align</span></div>
<div class="line"><span class="stringliteral">            set keep all lines together to false</span></div>
<div class="line"><span class="stringliteral">            set keep lines together to true</span></div>
<div class="line"><span class="stringliteral">            set keep first lines to 2</span></div>
<div class="line"><span class="stringliteral">            set keep last lines to 2</span></div>
<div class="line"><span class="stringliteral">            set keep with next to 0</span></div>
<div class="line"><span class="stringliteral">            set kerning method to &quot;Optical&quot;</span></div>
<div class="line"><span class="stringliteral">            set leading to 14</span></div>
<div class="line"><span class="stringliteral">            set left indent to 0</span></div>
<div class="line"><span class="stringliteral">            set ligatures to true</span></div>
<div class="line"><span class="stringliteral">            set maximum glyph scaling to 100</span></div>
<div class="line"><span class="stringliteral">            set maximum letter spacing to 0</span></div>
<div class="line"><span class="stringliteral">            set maximum word spacing to 160</span></div>
<div class="line"><span class="stringliteral">            set minimum glyph scaling to 100</span></div>
<div class="line"><span class="stringliteral">            set minimum letter spacing to 0</span></div>
<div class="line"><span class="stringliteral">            set minimum word spacing to 80</span></div>
<div class="line"><span class="stringliteral">            set no break to false</span></div>
<div class="line"><span class="stringliteral">            set OTF contextual alternate to true</span></div>
<div class="line"><span class="stringliteral">            set OTF discretionary ligature to false</span></div>
<div class="line"><span class="stringliteral">            set OTF figure style to proportional oldstyle</span></div>
<div class="line"><span class="stringliteral">            set OTF fraction to true</span></div>
<div class="line"><span class="stringliteral">            set OTF historical to false</span></div>
<div class="line"><span class="stringliteral">            set OTF ordinal to false</span></div>
<div class="line"><span class="stringliteral">            set OTF slashed zero to false</span></div>
<div class="line"><span class="stringliteral">            set OTF swash to false</span></div>
<div class="line"><span class="stringliteral">            set OTF titling to false</span></div>
<div class="line"><span class="stringliteral">            set overprint fill to false</span></div>
<div class="line"><span class="stringliteral">            set overprint stroke to false</span></div>
<div class="line"><span class="stringliteral">            set pointSize to 11</span></div>
<div class="line"><span class="stringliteral">            set position to normal</span></div>
<div class="line"><span class="stringliteral">            set right indent to 0</span></div>
<div class="line"><span class="stringliteral">            set rule above to false</span></div>
<div class="line"><span class="stringliteral">            if rule above = true then</span></div>
<div class="line"><span class="stringliteral">                set rule above color to color &quot;Black&quot;</span></div>
<div class="line"><span class="stringliteral">                set rule above gap color to swatch &quot;None&quot;</span></div>
<div class="line"><span class="stringliteral">                set rule above gap overprint to false</span></div>
<div class="line"><span class="stringliteral">                set rule above gap tint to 100</span></div>
<div class="line"><span class="stringliteral">                set rule above left indent to 0</span></div>
<div class="line"><span class="stringliteral">                set rule above line weight to 0.25</span></div>
<div class="line"><span class="stringliteral">                set rule above offset to 14</span></div>
<div class="line"><span class="stringliteral">                set rule above overprint to false</span></div>
<div class="line"><span class="stringliteral">                set rule above right indent to 0</span></div>
<div class="line"><span class="stringliteral">                set rule above tint to 100</span></div>
<div class="line"><span class="stringliteral">                set rule above type to stroke style &quot;Solid&quot;</span></div>
<div class="line"><span class="stringliteral">                set rule above width to column width</span></div>
<div class="line"><span class="stringliteral">            end if</span></div>
<div class="line"><span class="stringliteral">            set rule below to false</span></div>
<div class="line"><span class="stringliteral">            if rule below = true then</span></div>
<div class="line"><span class="stringliteral">                set rule below color to color &quot;Black&quot;</span></div>
<div class="line"><span class="stringliteral">                set rule below gap color to swatch &quot;None&quot;</span></div>
<div class="line"><span class="stringliteral">                set rule below gap overprint to false</span></div>
<div class="line"><span class="stringliteral">                set rule below gap tint to 100</span></div>
<div class="line"><span class="stringliteral">                set rule below left indent to 0</span></div>
<div class="line"><span class="stringliteral">                set rule below line weight to 0.25</span></div>
<div class="line"><span class="stringliteral">                set rule below offset to 14</span></div>
<div class="line"><span class="stringliteral">                set rule below overprint to false</span></div>
<div class="line"><span class="stringliteral">                set rule below right indent to 0</span></div>
<div class="line"><span class="stringliteral">                set rule below tint to 100</span></div>
<div class="line"><span class="stringliteral">                set rule below type to stroke style &quot;Solid&quot;</span></div>
<div class="line"><span class="stringliteral">                set rule below width to column width</span></div>
<div class="line"><span class="stringliteral">            end if</span></div>
<div class="line"><span class="stringliteral">            set single word justification to left align</span></div>
<div class="line"><span class="stringliteral">            set skew to 0</span></div>
<div class="line"><span class="stringliteral">            set space after to 0</span></div>
<div class="line"><span class="stringliteral">            set space before to 0</span></div>
<div class="line"><span class="stringliteral">            set start paragraph to anywhere</span></div>
<div class="line"><span class="stringliteral">            set strike thru to false</span></div>
<div class="line"><span class="stringliteral">            if strike thru = true then</span></div>
<div class="line"><span class="stringliteral">                set strike through color to color &quot;Black&quot;</span></div>
<div class="line"><span class="stringliteral">                set strike through gap color to swatch &quot;None&quot;</span></div>
<div class="line"><span class="stringliteral">                set strike through gap overprint to false</span></div>
<div class="line"><span class="stringliteral">                set strike through gap tint to 100</span></div>
<div class="line"><span class="stringliteral">                set strike through offset to 3</span></div>
<div class="line"><span class="stringliteral">                set strike through overprint to false</span></div>
<div class="line"><span class="stringliteral">                set strike through tint to 100</span></div>
<div class="line"><span class="stringliteral">                set strike through type to stroke style &quot;Solid&quot;</span></div>
<div class="line"><span class="stringliteral">                set strike through weight to 0.25</span></div>
<div class="line"><span class="stringliteral">            end if</span></div>
<div class="line"><span class="stringliteral">            set stroke color to &quot;None&quot;</span></div>
<div class="line"><span class="stringliteral">            set stroke tint to 100</span></div>
<div class="line"><span class="stringliteral">            set stroke weight to 0</span></div>
<div class="line"><span class="stringliteral">            set tracking to 0</span></div>
<div class="line"><span class="stringliteral">            set underline to false</span></div>
<div class="line"><span class="stringliteral">            if underline = true then</span></div>
<div class="line"><span class="stringliteral">                set underline color to color &quot;Black&quot;</span></div>
<div class="line"><span class="stringliteral">                set underline gap color to swatch &quot;None&quot;</span></div>
<div class="line"><span class="stringliteral">                set underline gap overprint to false</span></div>
<div class="line"><span class="stringliteral">                set underline gap tint to 100</span></div>
<div class="line"><span class="stringliteral">                set underline offset to 3</span></div>
<div class="line"><span class="stringliteral">                set underline overprint to false</span></div>
<div class="line"><span class="stringliteral">                set underline tint to 100</span></div>
<div class="line"><span class="stringliteral">                set underline type to stroke style &quot;Solid&quot;</span></div>
<div class="line"><span class="stringliteral">                set underline weight to 0.25</span></div>
<div class="line"><span class="stringliteral">            end if</span></div>
<div class="line"><span class="stringliteral">            set vertical scale to 100</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_working_with_fonts"></a>
Working with fonts</h3>
<p>The fonts collection of the InDesign application object contains all fonts accessible to InDesign. The fonts collection of a document, by contrast, contains only those fonts used in the document. The fonts collection of a document also contains any missing fonts-fonts used in the document that are not accessible to InDesign. The following script shows the difference between application fonts and document fonts. (We omitted the myGetBounds function here; for the complete script, see FontCollections.) </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myApplicationFonts to the name of every font</div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myPage to page 1</div>
<div class="line">            tell myPage</div>
<div class="line">                <span class="keyword">set</span> myTextFrame to make text frame with properties {geometric bounds:my myGetBounds(myDocument, myPage)}</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myStory to parent story of myTextFrame</div>
<div class="line">            <span class="keyword">set</span> myDocumentFonts to name of every font</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myString to <span class="stringliteral">&quot;Document Fonts:&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        repeat with myCounter from 1 to (count myDocumentFonts)</div>
<div class="line">            <span class="keyword">set</span> myString to myString &amp; (item myCounter) of myDocumentFonts &amp; <span class="keywordflow">return</span></div>
<div class="line">        end repeat</div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;Application Fonts:&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        repeat with myCounter from 1 to (count myApplicationFonts)</div>
<div class="line">            <span class="keyword">set</span> myString to myString &amp; (item myCounter) of myApplicationFonts &amp; <span class="keywordflow">return</span></div>
<div class="line">        end repeat</div>
<div class="line">        <span class="keyword">set</span> contents of myStory to myString</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Font names typically are of the form familyName &lt;tab&gt; fontStyle, where familyName is the name of the font family,&lt;tab&gt; is a tab character, and fontStyle is the name of the font style. For example: "Adobe Caslon Pro \&lt;tab\&gt; Semibold Italic"</dd></dl>
<h3><a class="anchor" id="id_as_applying_a_font"></a>
Applying a font</h3>
<p>To apply a local font change to a range of text, use the appliedFont property, as shown in the following script fragment (from the ApplyFont tutorial script): </p>
<div class="fragment"><div class="line">--Given a font name <span class="stringliteral">&quot;myFontName&quot;</span> and a text <span class="keywordtype">object</span> <span class="stringliteral">&quot;myText&quot;</span>...</div>
<div class="line">set applied font of myText to myFontName</div>
</div><!-- fragment --><p>You also can apply a font by specifying the font family name and font style, as shown in the following script fragment: </p>
<div class="fragment"><div class="line">tell myText</div>
<div class="line">    <span class="keyword">set</span> applied font to <span class="stringliteral">&quot;Adobe Caslon Pro&quot;</span></div>
<div class="line">    <span class="keyword">set</span> font style to <span class="stringliteral">&quot;Semibold Italic&quot;</span></div>
<div class="line">end tell</div>
</div><!-- fragment --><h3><a class="anchor" id="id_as_changing_text_properties"></a>
Changing text properties</h3>
<p>Text objects in InDesign have literally dozens of properties corresponding to their formatting attributes. Even one insertion point features properties that affect the formatting of text-up to and including properties of the paragraph containing the insertion point. The SetTextProperties tutorial script shows how to set every property of a text object. A fragment of the script is shown below: </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing a story...</div>
<div class="line">        <span class="keyword">set</span> myStory to story 1 of myDocument</div>
<div class="line">        tell character 1 of myStory</div>
<div class="line">            <span class="keyword">set</span> align to baseline to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> applied character style to character style <span class="stringliteral">&quot;[None]&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> applied font to <span class="stringliteral">&quot;Minion Pro Regular&quot;</span></div>
<div class="line">            <span class="keyword">set</span> applied language to <span class="stringliteral">&quot;English: USA&quot;</span></div>
<div class="line">            <span class="keyword">set</span> applied numbering list to <span class="stringliteral">&quot;[Default]&quot;</span></div>
<div class="line">            <span class="keyword">set</span> applied paragraph style to paragraph style <span class="stringliteral">&quot;[No Paragraph Style]&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> <span class="keyword">auto</span> leading to 120</div>
<div class="line">            <span class="keyword">set</span> balance ragged lines to no balancing</div>
<div class="line">            <span class="keyword">set</span> baseline shift to 0</div>
<div class="line">            <span class="keyword">set</span> bullets alignment to left align</div>
<div class="line">            <span class="keyword">set</span> bullets and numbering list type to no list</div>
<div class="line">            <span class="keyword">set</span> bullets character style to character style <span class="stringliteral">&quot;[None]&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> bullets text after to <span class="stringliteral">&quot;^t&quot;</span></div>
<div class="line">            <span class="keyword">set</span> capitalization to normal</div>
<div class="line">            <span class="keyword">set</span> composer to <span class="stringliteral">&quot;Adobe Paragraph Composer&quot;</span></div>
<div class="line">            <span class="keyword">set</span> desired glyph scaling to 100</div>
<div class="line">            <span class="keyword">set</span> desired letter spacing to 0</div>
<div class="line">            <span class="keyword">set</span> desired word spacing to 100</div>
<div class="line">            <span class="keyword">set</span> drop cap characters to 0</div>
<div class="line">            <span class="keyword">set</span> drop cap lines to 0</div>
<div class="line">            <span class="keyword">set</span> drop cap style to character style <span class="stringliteral">&quot;[None]&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> dropcap detail to 0</div>
<div class="line">            <span class="keyword">set</span> fill color to color <span class="stringliteral">&quot;Black&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> fill tint to -1</div>
<div class="line">            <span class="keyword">set</span> first line indent to 0</div>
<div class="line">            <span class="keyword">set</span> font style to <span class="stringliteral">&quot;Regular&quot;</span></div>
<div class="line">            <span class="keyword">set</span> gradient fill angle to 0</div>
<div class="line">            <span class="keyword">set</span> gradient fill length to -1</div>
<div class="line">            <span class="keyword">set</span> gradient fill start to [0, 0]</div>
<div class="line">            <span class="keyword">set</span> gradient stroke angle to 0</div>
<div class="line">            <span class="keyword">set</span> gradient stroke length to -1</div>
<div class="line">            <span class="keyword">set</span> gradient stroke start to [0, 0]</div>
<div class="line">            <span class="keyword">set</span> grid align first line only to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> horizontal scale to 100</div>
<div class="line">            <span class="keyword">set</span> hyphen weight to 5</div>
<div class="line">            <span class="keyword">set</span> hyphenate across columns to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> hyphenate after first to 2</div>
<div class="line">            <span class="keyword">set</span> hyphenate before last to 2</div>
<div class="line">            <span class="keyword">set</span> hyphenate capitalized words to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> hyphenate ladder limit to 3</div>
<div class="line">            <span class="keyword">set</span> hyphenate last word to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> hyphenate words longer than to 5</div>
<div class="line">            <span class="keyword">set</span> hyphenation to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> hyphenation zone to 3</div>
<div class="line">            <span class="keyword">set</span> ignore edge alignment to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> justification to left align</div>
<div class="line">            <span class="keyword">set</span> keep all lines together to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> keep first lines to 2</div>
<div class="line">            <span class="keyword">set</span> keep last lines to 2</div>
<div class="line">            <span class="keyword">set</span> keep lines together to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> keep rule above in frame to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> keep with next to 0</div>
<div class="line">            <span class="keyword">set</span> kerning method to <span class="stringliteral">&quot;Optical&quot;</span></div>
<div class="line">            <span class="keyword">set</span> last line indent to 0</div>
<div class="line">            <span class="keyword">set</span> leading to 12</div>
<div class="line">            <span class="keyword">set</span> left indent to 0</div>
<div class="line">            <span class="keyword">set</span> ligatures to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> maximum glyph scaling to 100</div>
<div class="line">            <span class="keyword">set</span> maximum letter spacing to 0</div>
<div class="line">            <span class="keyword">set</span> maximum word spacing to 133</div>
<div class="line">            <span class="keyword">set</span> minimum glyph scaling to 100</div>
<div class="line">            <span class="keyword">set</span> minimum letter spacing to 0</div>
<div class="line">            <span class="keyword">set</span> minimum word spacing to 80</div>
<div class="line">            <span class="keyword">set</span> no <span class="keywordflow">break</span> to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> numbering alignment to left align</div>
<div class="line">            <span class="keyword">set</span> numbering apply restart policy to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> numbering character style to character style <span class="stringliteral">&quot;[None]&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> numbering <span class="keywordflow">continue</span> to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> numbering expression to <span class="stringliteral">&quot;^#.^t&quot;</span></div>
<div class="line">            <span class="keyword">set</span> numbering format to <span class="stringliteral">&quot;1, 2, 3, 4...&quot;</span></div>
<div class="line">            <span class="keyword">set</span> numbering level to 1</div>
<div class="line">            <span class="keyword">set</span> numbering start at to 1</div>
<div class="line">            <span class="keyword">set</span> OTF contextual alternate to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> OTF discretionary ligature to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> OTF figure style to proportional lining</div>
<div class="line">            <span class="keyword">set</span> OTF fraction to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> OTF historical to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> OTF locale to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> OTF mark to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> OTF ordinal to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> OTF slashed zero to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> OTF stylistic sets to 0</div>
<div class="line">            <span class="keyword">set</span> OTF swash to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> OTF titling to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> overprint fill to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> overprint stroke to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> point size to 72</div>
<div class="line">            <span class="keyword">set</span> position to normal</div>
<div class="line">            <span class="keyword">set</span> positional form to none</div>
<div class="line">            <span class="keyword">set</span> right indent to 0</div>
<div class="line">            <span class="keyword">set</span> rule above to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> rule above color to <span class="stringliteral">&quot;Text Color&quot;</span></div>
<div class="line">            <span class="keyword">set</span> rule above gap color to swatch <span class="stringliteral">&quot;None&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> rule above gap overprint to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> rule above gap tint to 100</div>
<div class="line">            <span class="keyword">set</span> rule above left indent to 0</div>
<div class="line">            <span class="keyword">set</span> rule above line weight to 0.25</div>
<div class="line">            <span class="keyword">set</span> rule above offset to 14</div>
<div class="line">            <span class="keyword">set</span> rule above overprint to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> rule above right indent to 0</div>
<div class="line">            <span class="keyword">set</span> rule above tint to 100</div>
<div class="line">            <span class="keyword">set</span> rule above type to stroke style <span class="stringliteral">&quot;Solid&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> rule above width to column width</div>
<div class="line">            <span class="keyword">set</span> rule below to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> rule below color to <span class="stringliteral">&quot;Text Color&quot;</span></div>
<div class="line">            <span class="keyword">set</span> rule below gap color to swatch <span class="stringliteral">&quot;None&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> rule below gap overprint to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> rule below gap tint to 100</div>
<div class="line">            <span class="keyword">set</span> rule below left indent to 0</div>
<div class="line">            <span class="keyword">set</span> rule below line weight to 0.25</div>
<div class="line">            <span class="keyword">set</span> rule below offset to 14</div>
<div class="line">            <span class="keyword">set</span> rule below overprint to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> rule below right indent to 0</div>
<div class="line">            <span class="keyword">set</span> rule below tint to 100</div>
<div class="line">            <span class="keyword">set</span> rule below type to stroke style <span class="stringliteral">&quot;Solid&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> rule below width to column width</div>
<div class="line">            <span class="keyword">set</span> single word justification to left align</div>
<div class="line">            <span class="keyword">set</span> skew to 0</div>
<div class="line">            <span class="keyword">set</span> space after to 0</div>
<div class="line">            <span class="keyword">set</span> space before to 0</div>
<div class="line">            <span class="keyword">set</span> start paragraph to anywhere</div>
<div class="line">            <span class="keyword">set</span> strike thru to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> strike through color to color <span class="stringliteral">&quot;Black&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> strike through gap color to swatch <span class="stringliteral">&quot;None&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> strike through gap overprint to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> strike through gap tint to 100</div>
<div class="line">            <span class="keyword">set</span> strike through offset to 3</div>
<div class="line">            <span class="keyword">set</span> strike through overprint to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> strike through tint to 100</div>
<div class="line">            <span class="keyword">set</span> strike through type to stroke style <span class="stringliteral">&quot;Solid&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> strike through weight to 0.25</div>
<div class="line">            <span class="keyword">set</span> stroke color to swatch <span class="stringliteral">&quot;None&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> stroke tint to -1</div>
<div class="line">            <span class="keyword">set</span> stroke weight to 1</div>
<div class="line">            <span class="keyword">set</span> tracking to 0</div>
<div class="line">            <span class="keyword">set</span> tracking to 0</div>
<div class="line">            <span class="keyword">set</span> underline to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> underline color to color <span class="stringliteral">&quot;Black&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> underline gap color to swatch <span class="stringliteral">&quot;None&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> underline gap overprint to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> underline gap tint to 100</div>
<div class="line">            <span class="keyword">set</span> underline offset to 3</div>
<div class="line">            <span class="keyword">set</span> underline overprint to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> underline tint to 100</div>
<div class="line">            <span class="keyword">set</span> underline type to stroke style <span class="stringliteral">&quot;Solid&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> underline weight to 0.25</div>
<div class="line">            <span class="keyword">set</span> vertical scale to 100</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_changing_text_color"></a>
Changing text color</h3>
<p>You can apply colors to the fill and stroke of text characters, as shown in the following script fragment (from the TextColors tutorial script): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myStory to story 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myColorA to color <span class="stringliteral">&quot;DGC1_664a&quot;</span> of myDocument</div>
<div class="line">        <span class="keyword">set</span> myColorB to color <span class="stringliteral">&quot;DGC1_664b&quot;</span> of myDocument</div>
<div class="line">        tell paragraph 1 of myStory</div>
<div class="line">            <span class="keyword">set</span> point size to 72</div>
<div class="line">            <span class="keyword">set</span> justification to center align</div>
<div class="line">            --Apply a color to the fill of the text.</div>
<div class="line">            <span class="keyword">set</span> fill color to myColorA</div>
<div class="line">            <span class="keyword">set</span> stroke color to myColorB</div>
<div class="line">        end tell</div>
<div class="line">        tell paragraph 2 of myStory</div>
<div class="line">            <span class="keyword">set</span> stroke weight to 3</div>
<div class="line">            <span class="keyword">set</span> point size to 144</div>
<div class="line">            <span class="keyword">set</span> justification to center align</div>
<div class="line">            <span class="keyword">set</span> fill color to myColorB</div>
<div class="line">            <span class="keyword">set</span> stroke color to myColorA</div>
<div class="line">            <span class="keyword">set</span> stroke weight to 3</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_creating_and_applying_styles"></a>
Creating and applying styles</h3>
<p>While you can use scripting to apply local formatting-as in some of the examples earlier in this section-you probably will want to use character and paragraph styles to format your text. Using styles creates a link between the formatted text and the style, which makes it easier to redefine the style, collect the text formatted with a given style, or find and/or change the text. Paragraph and character styles are the keys to text formatting productivity and should be a central part of any script that applies text formatting.</p>
<p>The following example script fragment shows how to create and apply paragraph and character styles (for the complete script, see CreateStyles): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing a story and the color <span class="stringliteral">&quot;Red&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myColor to color <span class="stringliteral">&quot;Red&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myStory to story 1 of myDocument</div>
<div class="line">            <span class="keyword">set</span> contents of myStory to <span class="stringliteral">&quot;Normal text. Text with a character style applied to it. More normal text.&quot;</span></div>
<div class="line">            --Create a character style named <span class="stringliteral">&quot;myCharacterStyle&quot;</span> <span class="keywordflow">if</span> </div>
<div class="line">            --no style by that name already exists.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myCharacterStyle to character style <span class="stringliteral">&quot;myCharacterStyle&quot;</span></div>
<div class="line">            on error</div>
<div class="line">                --The style did not exist, so create it.</div>
<div class="line">                <span class="keyword">set</span> myCharacterStyle to make character style with properties {name:<span class="stringliteral">&quot;myCharacterStyle&quot;</span>}</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            --At <span class="keyword">this</span> point, the variable myCharacterStyle contains a reference to a character </div>
<div class="line">            --style object, which you can now use to specify formatting.</div>
<div class="line">            <span class="keyword">set</span> fill color of myCharacterStyle to myColor</div>
<div class="line">            --Create a paragraph style named <span class="stringliteral">&quot;myParagraphStyle&quot;</span> <span class="keywordflow">if</span> </div>
<div class="line">            --no style by that name already exists.</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myParagraphStyle to paragraph style <span class="stringliteral">&quot;myParagraphStyle&quot;</span></div>
<div class="line">            on error</div>
<div class="line">                --The paragraph style did not exist, so create it.</div>
<div class="line">                <span class="keyword">set</span> myParagraphStyle to make paragraph style with properties {name:<span class="stringliteral">&quot;myParagraphStyle&quot;</span>}</div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">            --At <span class="keyword">this</span> point, the variable myParagraphStyle contains a reference to a paragraph </div>
<div class="line">            --style object, which you can now use to specify formatting.</div>
<div class="line">            --(Note that the story <span class="keywordtype">object</span> does not have the apply paragraph style method.)</div>
<div class="line">            tell text 1 of myStory</div>
<div class="line">                apply paragraph style <span class="keyword">using</span> myParagraphStyle</div>
<div class="line">                tell text from character 13 to character 54</div>
<div class="line">                    apply character style <span class="keyword">using</span> myCharacterStyle</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> Why use the applyParagraphStyle method instead of setting the appliedParagraphStyle property of the text object? The applyParagraphStyle method gives the ability to override existing formatting; setting the property to a style retains local formatting.</p>
<p>Why check for the existence of a style when creating a new document? It always is possible that the style exists as an application default style. If it does, trying to create a new style with the same name results in an error.</p>
<p>Nested styles apply character-style formatting to a paragraph according to a pattern. The following script fragment shows how to create a paragraph style containing nested styles (for the complete script, see NestedStyles): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        --Get the last paragraph style.</div>
<div class="line">        <span class="keyword">set</span> myParagraphStyle to paragraph style -1 of myDocument</div>
<div class="line">        --Get the last character style</div>
<div class="line">        <span class="keyword">set</span> myCharacterStyle to character style -1 of myDocument</div>
<div class="line">        --At <span class="keyword">this</span> point, the variable myParagraphStyle contains a reference to a paragraph </div>
<div class="line">        --style <span class="keywordtype">object</span>. Next, add a nested style to the paragraph style.</div>
<div class="line">        tell myParagraphStyle</div>
<div class="line">            <span class="keyword">set</span> myNestedStyle to make nested style with properties {applied character style:myCharacterStyle, delimiter:<span class="stringliteral">&quot;.&quot;</span>, inclusive:<span class="keyword">true</span>, repetition:1}</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to text frame 1 of myPage</div>
<div class="line">        --Apply the paragraph style to the story so that we can see the</div>
<div class="line">        --effect of the nested style we created.</div>
<div class="line">        --(Note that the story <span class="keywordtype">object</span> does not have the apply paragraph style method.)</div>
<div class="line">        <span class="keyword">set</span> myStory to parent story of myTextFrame</div>
<div class="line">        tell text 1 of myStory</div>
<div class="line">            apply paragraph style <span class="keyword">using</span> myParagraphStyle</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_deleting_a_style"></a>
Deleting a style</h3>
<p>When you delete a style using the user interface, you can choose the way you want to format any text tagged with that style. InDesign scripting works the same way, as shown in the following script fragment (from the RemoveStyle tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocment&quot;</span> with paragraph styles named</div>
<div class="line">        --<span class="stringliteral">&quot;myParagraphStyleA&quot;</span> and <span class="stringliteral">&quot;myParagraphStyleB&quot;</span>, <span class="keyword">remove</span> the </div>
<div class="line">        --paragraph style <span class="stringliteral">&quot;myParagraphStyleA&quot;</span> and replace with </div>
<div class="line">        --<span class="stringliteral">&quot;myParagraphStyleB.&quot;</span></div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">delete</span> paragraph style <span class="stringliteral">&quot;myParagraphStyleA&quot;</span> replacing with paragraph style <span class="stringliteral">&quot;myParagraphStyleB&quot;</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_importing_paragraph_and_character_styles"></a>
Importing paragraph and character styles</h3>
<p>You can import character and paragraph styles from other InDesign documents, as shown in the following script fragment (from the ImportTextStyles tutorial script): </p>
<div class="fragment"><div class="line">        --You<span class="stringliteral">&#39;ll have to fill in a valid file path for your system.</span></div>
<div class="line"><span class="stringliteral">        set myFilePath to &quot;Macintosh HD:scripting:styles.indd&quot;</span></div>
<div class="line"><span class="stringliteral">        --Create a new document.</span></div>
<div class="line"><span class="stringliteral">        set myDocument to make document</span></div>
<div class="line"><span class="stringliteral">        tell myDocument</span></div>
<div class="line"><span class="stringliteral">            --Import the styles from the saved document.</span></div>
<div class="line"><span class="stringliteral">            --importStyles parameters:</span></div>
<div class="line"><span class="stringliteral">            --Format options for text styles are:</span></div>
<div class="line"><span class="stringliteral">            --    paragraph styles format</span></div>
<div class="line"><span class="stringliteral">            --    character styles format</span></div>
<div class="line"><span class="stringliteral">            --    text styles format</span></div>
<div class="line"><span class="stringliteral">            --From as file or string</span></div>
<div class="line"><span class="stringliteral">            --Global Strategy options are:</span></div>
<div class="line"><span class="stringliteral">            --    do not load the style</span></div>
<div class="line"><span class="stringliteral">            --    load all with overwrite</span></div>
<div class="line"><span class="stringliteral">            --    load all with rename</span></div>
<div class="line"><span class="stringliteral">            import styles format text styles format from myFilePath global strategy load all with overwrite</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_finding_and_changing_text"></a>
Finding and Changing Text</h2>
<p>The find/change feature is one of the most powerful InDesign tools for working with text. It is fully supported by scripting, and scripts can use find/change to go far beyond what can be done using the InDesign user interface. InDesign has three ways of searching for text:</p>
<ul>
<li>You can find text and/or text formatting and change it to other text and/or text formatting. This type of find/change operation uses the findTextPreferences and changeTextPreferences objects to specify parameters for the findText and changeText methods.</li>
<li>You can find text using regular expressions, or "grep." This type of find/change operation uses the findGrepPreferences and changeGrepPreferences objects to specify parameters for the findGrep and changeGrep methods.</li>
<li>You can find specific glyphs (and their formatting) and replace them with other glyphs and formatting. This type of find/change operation uses the findGlyphPreferences and changeGlyphPreferences objects to specify parameters for the findGlyph and changeGlyph methods.</li>
</ul>
<p>All the find/change methods take one optional parameter, ReverseOrder, which specifies the order in which the results of the search are returned. If you are processing the results of a find or change operation in a way that adds or removes text from a story, you might face the problem of invalid text references, as discussed earlier in this section. In this case, you can either construct your loops to iterate backward through the collection of returned text objects, or you can have the search operation return the results in reverse order and then iterate through the collection normally.</p>
<h3><a class="anchor" id="id_as_about_find_change_preferences"></a>
About find/change preferences</h3>
<p>Before you search for text, you probably will want to clear find and change preferences, to make sure the settings from previous searches have no effect on your search. You also need to set some find/change preferences to specify the text, formatting, regular expression, or glyph you want to find and/or change. A typical find/change operation involves the following steps:</p>
<ol type="1">
<li>Clear the find/change preferences. Depending on the type of find/change operation, this can take one of the following three forms:<ul>
<li><div class="fragment"><div class="line">--find/change text preferences</div>
<div class="line">    <span class="keyword">set</span> find text preferences to nothing</div>
<div class="line">    <span class="keyword">set</span> change text preferences to nothing </div>
</div><!-- fragment --></li>
<li><div class="fragment"><div class="line">--find/change grep preferences</div>
<div class="line">    <span class="keyword">set</span> find grep preferences to nothing</div>
<div class="line">    <span class="keyword">set</span> change grep preferences to nothing </div>
</div><!-- fragment --></li>
<li><div class="fragment"><div class="line">--find/change glyph preferences</div>
<div class="line">    <span class="keyword">set</span> find glyph preferences to nothing</div>
<div class="line">    <span class="keyword">set</span> change glyph preferences to nothing </div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Set up search parameters.</li>
<li>Execute the find/change operation.</li>
<li>Clear find/change preferences again.</li>
</ol>
<h3><a class="anchor" id="id_as_finding_and_changing_text2"></a>
Finding and changing text</h3>
<p>The following script fragment shows how to find a specified string of text. While the following script fragment searches the entire document, you also can search stories, text frames, paragraphs, text columns, or any other text object. The findText method and its parameters are the same for all text objects. (For the complete script, see FindText.) </p>
<div class="fragment"><div class="line">        --Clear the find/change preferences.</div>
<div class="line">        <span class="keyword">set</span> find text preferences to nothing</div>
<div class="line">        <span class="keyword">set</span> change text preferences to nothing</div>
<div class="line">        --Search the document <span class="keywordflow">for</span> the <span class="keywordtype">string</span> <span class="stringliteral">&quot;Text&quot;</span>.</div>
<div class="line">        <span class="keyword">set</span> find what of find text preferences to <span class="stringliteral">&quot;text&quot;</span></div>
<div class="line">        --Set the find options.</div>
<div class="line">        <span class="keyword">set</span> <span class="keywordflow">case</span> sensitive of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include footnotes of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include hidden layers of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include locked layers <span class="keywordflow">for</span> find of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include locked stories <span class="keywordflow">for</span> find of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include master pages of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> whole word of find change text options to <span class="keyword">false</span></div>
<div class="line">        tell active document</div>
<div class="line">            <span class="keyword">set</span> myFoundItems to find text</div>
<div class="line">            display dialog (<span class="stringliteral">&quot;Found &quot;</span> &amp; (count myFoundItems) &amp; <span class="stringliteral">&quot; instances of the search string.&quot;</span>)</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script fragment shows how to find a specified string of text and replace it with a different string (for the complete script, see ChangeText): </p>
<div class="fragment"><div class="line">        --Clear the find/change preferences.</div>
<div class="line">        <span class="keyword">set</span> find text preferences to nothing</div>
<div class="line">        <span class="keyword">set</span> change text preferences to nothing</div>
<div class="line">        --Search the document <span class="keywordflow">for</span> the <span class="keywordtype">string</span> <span class="stringliteral">&quot;copy&quot;</span>.</div>
<div class="line">        <span class="keyword">set</span> find what of find text preferences to <span class="stringliteral">&quot;copy&quot;</span></div>
<div class="line">        <span class="keyword">set</span> change to of change text preferences to <span class="stringliteral">&quot;text&quot;</span></div>
<div class="line">        --Set the find options.</div>
<div class="line">        <span class="keyword">set</span> <span class="keywordflow">case</span> sensitive of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include footnotes of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include hidden layers of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include locked layers <span class="keywordflow">for</span> find of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include locked stories <span class="keywordflow">for</span> find of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include master pages of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> whole word of find change text options to <span class="keyword">false</span></div>
<div class="line">        tell active document</div>
<div class="line">            <span class="keyword">set</span> myFoundItems to change text</div>
<div class="line">            display dialog (<span class="stringliteral">&quot;Found &quot;</span> &amp; (count myFoundItems) &amp; <span class="stringliteral">&quot; instances of the search string.&quot;</span>)</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_finding_and_changing_text_formatting"></a>
Finding and changing text formatting</h3>
<p>To find and change text formatting, you set other properties of the findTextPreferences and changeTextPreferences objects, as shown in the script fragment below (from the FindChangeFormatting tutorial script): </p>
<div class="fragment"><div class="line">        --Clear the find/change preferences.</div>
<div class="line">        <span class="keyword">set</span> find text preferences to nothing</div>
<div class="line">        <span class="keyword">set</span> change text preferences to nothing</div>
<div class="line">        --Set the find options.</div>
<div class="line">        <span class="keyword">set</span> <span class="keywordflow">case</span> sensitive of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include footnotes of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include hidden layers of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include locked layers <span class="keywordflow">for</span> find of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include locked stories <span class="keywordflow">for</span> find of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include master pages of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> whole word of find change text options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> point size of find text preferences to 24</div>
<div class="line">        --The following line will only work <span class="keywordflow">if</span> your <span class="keywordflow">default</span> font has a font style named <span class="stringliteral">&quot;Bold&quot;</span></div>
<div class="line">        --<span class="keywordflow">if</span> not, change the text to a font style used by your <span class="keywordflow">default</span> font.</div>
<div class="line">        <span class="keyword">set</span> point size of change text preferences to 48</div>
<div class="line">        --Search the document. In <span class="keyword">this</span> example, we<span class="stringliteral">&#39;ll use the </span></div>
<div class="line"><span class="stringliteral">        --InDesign search metacharacter &quot;^9&quot; to find any digit.</span></div>
<div class="line"><span class="stringliteral">        tell document 1</span></div>
<div class="line"><span class="stringliteral">            set myFoundItems to change text</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">        display dialog (&quot;Changed &quot; &amp; (count myFoundItems) &amp; &quot; instances of the search string.&quot;)</span></div>
<div class="line"><span class="stringliteral">        --Clear the find/change preferences after the search.</span></div>
<div class="line"><span class="stringliteral">        set find text preferences to nothing</span></div>
<div class="line"><span class="stringliteral">        set change text preferences to nothing</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_using_grep"></a>
Using grep</h3>
<p>InDesign supports regular expression find/change through the findGrep and changeGrep methods. Regular-expression find/change also can find text with a specified format or replace the formatting of the text with formatting specified in the properties of the changeGrepPreferences object. The following script fragment shows how to use these methods and the related preferences objects (for the complete script, see FindGrep): </p>
<div class="fragment"><div class="line">        --Clear the find/change preferences.</div>
<div class="line">        <span class="keyword">set</span> find grep preferences to nothing</div>
<div class="line">        <span class="keyword">set</span> change grep preferences to nothing</div>
<div class="line">        --Set the find options.</div>
<div class="line">        <span class="keyword">set</span> include footnotes of find change grep options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include hidden layers of find change grep options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include locked layers <span class="keywordflow">for</span> find of find change grep options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include locked stories <span class="keywordflow">for</span> find of find change grep options to <span class="keyword">false</span></div>
<div class="line">        <span class="keyword">set</span> include master pages of find change grep options to <span class="keyword">false</span></div>
<div class="line">        --Regular expression <span class="keywordflow">for</span> finding an email address.</div>
<div class="line">        <span class="keyword">set</span> find what of find grep preferences to <span class="stringliteral">&quot;(?i)[A-Z0-9]*?@[A-Z0-9]*?[.]...&quot;</span></div>
<div class="line">        --Apply the change to 24-point text only.</div>
<div class="line">        <span class="keyword">set</span> point size of find grep preferences to 24</div>
<div class="line">        <span class="keyword">set</span> underline of change grep preferences to <span class="keyword">true</span></div>
<div class="line">        tell myDocument</div>
<div class="line">            change grep</div>
<div class="line">        end tell</div>
<div class="line">        --Clear the find/change preferences after the search.</div>
<div class="line">        <span class="keyword">set</span> find grep preferences to nothing</div>
<div class="line">        <span class="keyword">set</span> change grep preferences to nothing</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The findChangeGrepOptions object lacks two properties of the findChangeTextOptions object: wholeWord and caseSensitive. This is because you can set these options using the regular expression string itself. Use (?i) to turn case sensitivity on and (?-i)to turn case sensitivity off. Use \&gt; to match the beginning of a word and \&lt; to match the end of a word, or use \b to match a word boundary.</dd></dl>
<p>One handy use for grep find/change is to convert text mark-up (i.e., some form of tagging plain text with formatting instructions) into InDesign formatted text. PageMaker paragraph tags (which are not the same as PageMaker tagged-text format files) are an example of a simplified text mark-up scheme. In a text file marked up using this scheme, paragraph style names appear at the start of a paragraph, as shown below: </p>
<div class="fragment"><div class="line">&lt;heading1&gt;This is a heading.</div>
<div class="line">&lt;body_text&gt;This is body text.</div>
</div><!-- fragment --><p>We can create a script that uses grep find in conjunction with text find/change operations to apply formatting to the text and remove the mark-up tags, as shown in the following script fragment (from the ReadPMTags tutorial script): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myStory to story 1 of document 1</div>
<div class="line">        my myReadPMTags(myStory)</div>
</div><!-- fragment --><p> Here is the myReadPMTags handler referred to in the above script. </p>
<div class="fragment"><div class="line">on myReadPMTags(myStory)</div>
<div class="line">    local myFoundTags, myFoundItems, myFoundTag, myString, myStyleName, myStyle</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myDocument to parent of myStory</div>
<div class="line">        --Reset the find grep preferences to ensure that </div>
<div class="line">        --previous settings do not affect the search.</div>
<div class="line">        set find grep preferences to nothing</div>
<div class="line">        set change grep preferences to nothing</div>
<div class="line">        --Set the find options.</div>
<div class="line">        set include footnotes of find change grep options to false</div>
<div class="line">        set include hidden layers of find change grep options to false</div>
<div class="line">        set include locked layers for find of find change grep options to false</div>
<div class="line">        set include locked stories for find of find change grep options to false</div>
<div class="line">        set include master pages of find change grep options to false</div>
<div class="line">        --Find the tags.</div>
<div class="line">        set find what of find grep preferences to &quot;(?i)^&lt;\\s*\\w+\\s*&gt;&quot;</div>
<div class="line">        tell myStory</div>
<div class="line">            set myFoundItems to find grep</div>
<div class="line">        end tell</div>
<div class="line">        if (count myFoundItems) is not equal to 0 then</div>
<div class="line">            set myFoundTags to {}</div>
<div class="line">            repeat with myCounter from 1 to (count myFoundItems)</div>
<div class="line">                <span class="keyword">set</span> myFoundTag to contents of item myCounter of myFoundItems</div>
<div class="line">                <span class="keywordflow">if</span> myFoundTags does not contain myFoundTag then</div>
<div class="line">                    copy myFoundTag to end of myFoundTags</div>
<div class="line">                end <span class="keywordflow">if</span></div>
<div class="line">            end repeat</div>
<div class="line">            --At <span class="keyword">this</span> point, we have a list of tags to search <span class="keywordflow">for</span>.</div>
<div class="line">            repeat with myCounter from 1 to (count myFoundTags)</div>
<div class="line">                <span class="keyword">set</span> myString to item myCounter of myFoundTags</div>
<div class="line">                --Find the tag <span class="keyword">using</span> find what.</div>
<div class="line">                <span class="keyword">set</span> find what of find text preferences to myString</div>
<div class="line">                --Extract the style name from the tag.</div>
<div class="line">                <span class="keyword">set</span> myStyleName to text 2 through ((count characters of myString) - 1) of myString</div>
<div class="line">                tell myDocument</div>
<div class="line">                    --Create the style if it does not already exist.</div>
<div class="line">                    try</div>
<div class="line">                        set myStyle to paragraph style myStyleName</div>
<div class="line">                    on error</div>
<div class="line">                        set myStyle to make paragraph style with properties {name:myStyleName}</div>
<div class="line">                    end <span class="keywordflow">try</span></div>
<div class="line">                end tell</div>
<div class="line">                --Apply the style to each instance of the tag.</div>
<div class="line">                <span class="keyword">set</span> applied paragraph style of change text preferences to myStyle</div>
<div class="line">                tell myStory</div>
<div class="line">                    change text</div>
<div class="line">                end tell</div>
<div class="line">                --Reset the change text preferences.</div>
<div class="line">                <span class="keyword">set</span> change text preferences to nothing</div>
<div class="line">                --Set the change to <span class="keyword">property</span> to an empty <span class="keywordtype">string</span>.</div>
<div class="line">                <span class="keyword">set</span> change to of change text preferences to <span class="stringliteral">&quot;&quot;</span></div>
<div class="line">                --Search to <span class="keyword">remove</span> the tags.</div>
<div class="line">                tell myStory</div>
<div class="line">                    change text</div>
<div class="line">                end tell</div>
<div class="line">                --Reset the find/change preferences again.</div>
<div class="line">                <span class="keyword">set</span> change text preferences to nothing</div>
<div class="line">            end repeat</div>
<div class="line">        end <span class="keywordflow">if</span></div>
<div class="line">        --Reset the findGrepPreferences.</div>
<div class="line">        <span class="keyword">set</span> find grep preferences to nothing</div>
<div class="line">    end tell</div>
<div class="line">end myReadPMTags</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_using_glyph_search"></a>
Using glyph search</h3>
<p>You can find and change individual characters in a specific font using the findGlyph and changeGlyph methods and the associated findGlyphPreferences and changeGlyphPreferences objects. The following scripts fragment shows how to find and change a glyph in an example document (for the complete script, see FindChangeGlyph): </p>
<div class="fragment"><div class="line">        --Clear glyph search preferences.</div>
<div class="line">        <span class="keyword">set</span> find glyph preferences to nothing</div>
<div class="line">        <span class="keyword">set</span> change glyph preferences to nothing</div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        --You must provide a font that is used in the document <span class="keywordflow">for</span> the</div>
<div class="line">        --applied font <span class="keyword">property</span> of the find glyph preferences <span class="keywordtype">object</span>.</div>
<div class="line">        <span class="keyword">set</span> applied font of find glyph preferences to applied font of character 1 of story 1 of myDocument</div>
<div class="line">        --Provide the glyph ID, not the glyph Unicode value.</div>
<div class="line">        <span class="keyword">set</span> glyph ID of find glyph preferences to 374</div>
<div class="line">        --The applied font of the change glyph preferences <span class="keywordtype">object</span> can be</div>
<div class="line">        --any font available to the application.</div>
<div class="line">        <span class="keyword">set</span> applied font of change glyph preferences to <span class="stringliteral">&quot;ITC Zapf Dingbats  Medium&quot;</span></div>
<div class="line">        <span class="keyword">set</span> glyph ID of change glyph preferences to 85</div>
<div class="line">        tell myDocument</div>
<div class="line">            change glyph</div>
<div class="line">        end tell</div>
<div class="line">        --Clear glyph search preferences.</div>
<div class="line">        <span class="keyword">set</span> find glyph preferences to nothing</div>
<div class="line">        <span class="keyword">set</span> change glyph preferences to nothing</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_working_with_tables"></a>
Working with Tables</h2>
<p>Tables can be created from existing text using the convertTextToTable method, or an empty table can be created at any insertion point in a story. The following script fragment shows three different ways to create a table (for the complete script, see MakeTable): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing a story...</div>
<div class="line">        <span class="keyword">set</span> myStory to story 1 of myDocument</div>
<div class="line">        tell myStory</div>
<div class="line">            <span class="keyword">set</span> myStartCharacter to index of character 1 of paragraph 7</div>
<div class="line">            <span class="keyword">set</span> myEndCharacter to index of character -2 of paragraph 7</div>
<div class="line">            <span class="keyword">set</span> myText to <span class="keywordtype">object</span> reference of text from character myStartCharacter to character myEndCharacter</div>
<div class="line">            --The convertToTable method takes three parameters:</div>
<div class="line">            --[column separator as string]</div>
<div class="line">            --[row separator as string]</div>
<div class="line">            --[number of columns as integer] (only used <span class="keywordflow">if</span> the column separator</div>
<div class="line">            --and row separator values are the same)</div>
<div class="line">            --In the last paragraph in the story, columns are separated by commas</div>
<div class="line">            --and rows are separated by semicolons, so we provide those characters</div>
<div class="line">            --to the method as parameters.</div>
<div class="line">            tell myText</div>
<div class="line">                <span class="keyword">set</span> myTable to convert to table column separator <span class="stringliteral">&quot;,&quot;</span> row separator <span class="stringliteral">&quot;;&quot;</span></div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myStartCharacter to index of character 1 of paragraph 2</div>
<div class="line">            <span class="keyword">set</span> myEndCharacter to index of character -2 of paragraph 5</div>
<div class="line">            <span class="keyword">set</span> myText to <span class="keywordtype">object</span> reference of text from character myStartCharacter to character myEndCharacter</div>
<div class="line">            --In the second through the fifth paragraphs, colums are separated by</div>
<div class="line">            --tabs and rows are separated by returns. These are the <span class="keywordflow">default</span> delimiter</div>
<div class="line">            --parameters, so we don<span class="stringliteral">&#39;t need to provide them to the method.</span></div>
<div class="line"><span class="stringliteral">            tell myText</span></div>
<div class="line"><span class="stringliteral">                set myTable to convert to table column separator tab row separator return</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            --You can also explicitly add a table--you don&#39;</span>t have to convert text to a table.</div>
<div class="line">            tell insertion point -1</div>
<div class="line">                <span class="keyword">set</span> myTable to make table</div>
<div class="line">                <span class="keyword">set</span> column count of myTable to 3</div>
<div class="line">                <span class="keyword">set</span> body row count of myTable to 3</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script fragment shows how to merge table cells. (For the complete script, see MergeTableCells.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing a story...</div>
<div class="line">        tell story 1 of myDocument</div>
<div class="line">            tell table 1</div>
<div class="line">                --Merge all of the cells in the first column.</div>
<div class="line">                merge cell 1 of column 1 with cell -1 of column 1</div>
<div class="line">                --Convert column 2 into 2 cells (rather than 4).</div>
<div class="line">                merge cell 3 of column 2 with cell -1 of column 2</div>
<div class="line">                merge cell 1 of column 2 with cell 2 of column 2</div>
<div class="line">                --Merge the last two cells in row 1.</div>
<div class="line">                merge cell -2 of row 1 with cell -1 of row 1</div>
<div class="line">                --Merge the last two cells in row 3.</div>
<div class="line">                merge cell -2 of row 3 with cell -1 of row 3</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script fragment shows how to split table cells. (For the complete script, see SplitTableCells.) </p>
<div class="fragment"><div class="line">        tell table 1 of story 1 of document 1</div>
<div class="line">            split cell 1 <span class="keyword">using</span> horizontal</div>
<div class="line">            split column 1 <span class="keyword">using</span> vertical</div>
<div class="line">            split cell 1 <span class="keyword">using</span> vertical</div>
<div class="line">            split row -1 <span class="keyword">using</span> horizontal</div>
<div class="line">            split cell -1 <span class="keyword">using</span> vertical</div>
<div class="line">            --Fill the cells with row:cell labels.</div>
<div class="line">            repeat with myRowCounter from 1 to (count rows)</div>
<div class="line">                <span class="keyword">set</span> myRow to row myRowCounter</div>
<div class="line">                repeat with myCellCounter from 1 to (count cells of myRow)</div>
<div class="line">                    <span class="keyword">set</span> myString to <span class="stringliteral">&quot;Row: &quot;</span> &amp; myRowCounter &amp; <span class="stringliteral">&quot; Cell: &quot;</span> &amp; myCellCounter</div>
<div class="line">                    <span class="keyword">set</span> contents of text 1 of cell myCellCounter of row myRowCounter to myString</div>
<div class="line">                end repeat</div>
<div class="line">            end repeat</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script fragment shows how to create header and footer rows in a table (for the complete script, see HeaderAndFooterRows): </p>
<div class="fragment"><div class="line">        --Given a document containing a story that contains a table...</div>
<div class="line">        tell table 1 of story 1 of document 1</div>
<div class="line">            --Convert the first row to a header row.</div>
<div class="line">            <span class="keyword">set</span> row type of row 1 to header row</div>
<div class="line">            --Convert the last row to a footer row.</div>
<div class="line">            <span class="keyword">set</span> row type of row -1 to footer row</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script fragment shows how to apply formatting to a table (for the complete script, see TableFormatting): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myTable to table 1 of story 1 of myDocument</div>
<div class="line">        tell myTable</div>
<div class="line">            --Convert the first row to a header row.</div>
<div class="line">            <span class="keyword">set</span> row type of row 1 to header row</div>
<div class="line">            --Use a reference to a swatch, rather than to a color.</div>
<div class="line">            <span class="keyword">set</span> fill color of row 1 to swatch <span class="stringliteral">&quot;DGC1_446b&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> fill tint of row 1 to 40</div>
<div class="line">            <span class="keyword">set</span> fill color of row 2 to swatch <span class="stringliteral">&quot;DGC1_446a&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> fill tint of row 2 to 40</div>
<div class="line">            <span class="keyword">set</span> fill color of row 3 to swatch <span class="stringliteral">&quot;DGC1_446a&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> fill tint of row 3 to 20</div>
<div class="line">            <span class="keyword">set</span> fill color of row 4 to swatch <span class="stringliteral">&quot;DGC1_446a&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> fill tint of row 4 to 40</div>
<div class="line">            tell every cell in myTable</div>
<div class="line">                <span class="keyword">set</span> top edge stroke color to swatch <span class="stringliteral">&quot;DGC1_446b&quot;</span> of myDocument</div>
<div class="line">                <span class="keyword">set</span> top edge stroke weight to 1</div>
<div class="line">                <span class="keyword">set</span> bottom edge stroke color to swatch <span class="stringliteral">&quot;DGC1_446b&quot;</span> of myDocument</div>
<div class="line">                <span class="keyword">set</span> bottom edge stroke weight to 1</div>
<div class="line">                --When you <span class="keyword">set</span> a cell stroke to a swatch, make certain that you also <span class="keyword">set</span> the stroke weight.</div>
<div class="line">                <span class="keyword">set</span> left edge stroke color to swatch <span class="stringliteral">&quot;None&quot;</span> of myDocument</div>
<div class="line">                <span class="keyword">set</span> left edge stroke weight to 0</div>
<div class="line">                <span class="keyword">set</span> right edge stroke color to swatch <span class="stringliteral">&quot;None&quot;</span> of myDocument</div>
<div class="line">                <span class="keyword">set</span> right edge stroke weight to 0</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script fragment shows how to add alternating row formatting to a table (for the complete script, see AlternatingRows): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing a story that </div>
<div class="line">        --contains a table...</div>
<div class="line">        <span class="keyword">set</span> myTable to table 1 of story 1 of myDocument</div>
<div class="line">        tell myTable</div>
<div class="line">            --Apply alternating fills to the table.</div>
<div class="line">            <span class="keyword">set</span> alternating fills to alternating rows</div>
<div class="line">            <span class="keyword">set</span> start row fill color to swatch <span class="stringliteral">&quot;DGC1_446a&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> start row fill tint to 60</div>
<div class="line">            <span class="keyword">set</span> end row fill color to swatch <span class="stringliteral">&quot;DGC1_446b&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> end row fill tint to 50</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script fragment shows how to process the selection when text or table cells are selected. In this example, the script displays an alert for each selection condition, but a real production script would then do something with the selected item(s). (For the complete script, see TableSelection.) </p>
<div class="fragment"><div class="line">        --Check to see <span class="keywordflow">if</span> any documents are open.</div>
<div class="line">        <span class="keywordflow">if</span> (count documents) is not equal to 0 then</div>
<div class="line">            --If the selection contains more than one item, the selection</div>
<div class="line">            --is not text selected with the Type tool.</div>
<div class="line">            <span class="keyword">set</span> mySelection to selection</div>
<div class="line">            <span class="keywordflow">if</span> (count mySelection) is not equal to 0 then</div>
<div class="line">                --Evaluate the selection based on its type.</div>
<div class="line">                <span class="keyword">set</span> myTextClasses to {insertion point, word, text style range, line, paragraph, text column, text, story}</div>
<div class="line">                <span class="keywordflow">if</span> <span class="keyword">class </span>of item 1 of selection is in myTextClasses then</div>
<div class="line">                    --The object is a text object; display the text <span class="keywordtype">object</span> type.</div>
<div class="line">                    --A practical script would <span class="keywordflow">do</span> something with the selection,</div>
<div class="line">                    --or pass the selection on to a <span class="keyword">function</span>.</div>
<div class="line">                    <span class="keywordflow">if</span> <span class="keyword">class </span>of parent of item 1 of mySelection is cell then</div>
<div class="line">                        display dialog (&quot;The selection is inside a table cell&quot;)</div>
<div class="line">                    else</div>
<div class="line">                        display dialog (&quot;The selection is not in a table&quot;)</div>
<div class="line">                    end if</div>
<div class="line">                else if class of item 1 of selection is cell then</div>
<div class="line">                    display dialog (&quot;The selection is a table cell&quot;)</div>
<div class="line">                else if class of item 1 of selection is row then</div>
<div class="line">                    display dialog (&quot;The selection is a table row&quot;)</div>
<div class="line">                else if class of item 1 of selection is column then</div>
<div class="line">                    display dialog (&quot;The selection is a table column&quot;)</div>
<div class="line">                else if class of item 1 of selection is table then</div>
<div class="line">                    display dialog (&quot;The selection is a table.&quot;)</div>
<div class="line">                else</div>
<div class="line">                    display dialog (&quot;The selection is not in a table&quot;)</div>
<div class="line">                end if</div>
<div class="line">            else</div>
<div class="line">                display dialog (&quot;Please select some text and try again.&quot;)</div>
<div class="line">            end if</div>
<div class="line">        else</div>
<div class="line">            display dialog (&quot;Nothing is selected. Please select some text and try again.&quot;)</div>
<div class="line">        end if</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_adding_path_text"></a>
Adding Path Text</h2>
<p>You can add path text to any rectangle, oval, polygon, graphic line, or text frame. The following script fragment shows how to add path text to a page item (for the complete script, see PathText): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> with a rectangle on page 1...</div>
<div class="line">        <span class="keyword">set</span> myRectangle to rectangle 1 of page 1 of myDocument</div>
<div class="line">        tell myRectangle</div>
<div class="line">            <span class="keyword">set</span> myTextPath to make text path with properties {contents:<span class="stringliteral">&quot;This is path text.&quot;</span>}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> To link text paths to another text path or text frame, use the nextTextFrame and previousTextFrame properties, just as you would for a text frame (see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_working_with_text_frames">Working with Text Frames</a>).</p>
<h2><a class="anchor" id="id_as_using_autocorrect"></a>
Using Autocorrect</h2>
<p>The autocorrect feature can correct text as you type. The following script shows how to use it (for the complete script, see Autocorrect): </p>
<div class="fragment"><div class="line">        tell <span class="keyword">auto</span> correct preferences</div>
<div class="line">            <span class="keyword">set</span> autocorrect to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> <span class="keyword">auto</span> correct capitalization errors to <span class="keyword">true</span></div>
<div class="line">            --Add a word pair to the autocorrect list. Each <span class="keyword">auto</span> correct table</div>
<div class="line">            --is linked to a specific language. </div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myAutoCorrectTable to <span class="keyword">auto</span> correct table <span class="stringliteral">&quot;English: USA&quot;</span></div>
<div class="line">        --To safely add a word pair to the <span class="keyword">auto</span> correct table, <span class="keyword">get</span> the current</div>
<div class="line">        --word pair list, then add the <span class="keyword">new</span> word pair to that array, and then</div>
<div class="line">        --<span class="keyword">set</span> the autocorrect word pair list to the array.</div>
<div class="line">        <span class="keyword">set</span> myWordPairList to {}</div>
<div class="line">        <span class="keyword">set</span> myWordPairList to myWordPairList &amp; <span class="keyword">auto</span> correct word pair list of myAutoCorrectTable</div>
<div class="line">        --Add a <span class="keyword">new</span> word pair to the array.</div>
<div class="line">        <span class="keyword">set</span> myWordPairList to myWordPairList &amp; {{<span class="stringliteral">&quot;paragarph&quot;</span>, <span class="stringliteral">&quot;paragraph&quot;</span>}}</div>
<div class="line">        --Update the word pair list.</div>
<div class="line">        <span class="keyword">set</span> <span class="keyword">auto</span> correct word pair list of <span class="keyword">auto</span> correct table <span class="stringliteral">&quot;English: USA&quot;</span> to myWordPairList</div>
<div class="line">        --To clear all autocorrect word pairs in the current dictionary:</div>
<div class="line">        --myAutoCorrectTable.autoCorrectWordPairList to {{}}</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_adding_footnotes"></a>
Adding Footnotes</h2>
<p>The following script fragment shows how to add footnotes to a story (for the complete script, including the myGetRandom function, see Footnotes): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        tell footnote options of myDocument</div>
<div class="line">            <span class="keyword">set</span> separator text to tab</div>
<div class="line">            <span class="keyword">set</span> marker positioning to superscript marker</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myStory to story 1 of myDocument</div>
<div class="line">        --Add four footnotes at random locations in the story.</div>
<div class="line">        local myStoryLength, myRandomNumber</div>
<div class="line">        <span class="keyword">set</span> myStoryLength to (count words of myStory)</div>
<div class="line">        repeat with myCounter from 1 to 5</div>
<div class="line">            <span class="keyword">set</span> myRandomNumber to my myGetRandom(1, myStoryLength)</div>
<div class="line">            tell insertion point -1 of word myRandomNumber of myStory</div>
<div class="line">                set myFootnote to make footnote</div>
<div class="line">            end tell</div>
<div class="line">            --Note: when you create a footnote, it contains text--the footnote marker</div>
<div class="line">            --and the separator text (if any). If you try to set the text of the footnote</div>
<div class="line">            --by setting the footnote contents, you will delete the marker. Instead, append</div>
<div class="line">            --the footnote text, as shown below.</div>
<div class="line">            tell insertion point -1 of myFootnote</div>
<div class="line">                set contents to &quot;This is a footnote.&quot;</div>
<div class="line">            end tell</div>
<div class="line">        end repeat</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_spanning_columns"></a>
Spanning Columns</h2>
<p>A paragraph layout can span multiple columns or split into subcolumns with the Span Columns attribute or Split Column attribute applied. The following script fragment shows how to set the Span Columns and Split Column style for a paragraph (for the complete script, see SpanColumns): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to item 1 of text frames of myPage</div>
<div class="line">        tell myTextFrame</div>
<div class="line">            <span class="keyword">set</span> myStory to parent story</div>
<div class="line">            tell item 1 of paragraphs of myStory</div>
<div class="line">                --split column</div>
<div class="line">                <span class="keyword">set</span> span column type to split columns</div>
<div class="line">                <span class="keyword">set</span> span split column count to 2</div>
<div class="line">                <span class="keyword">set</span> split column outside gutter to 0</div>
<div class="line">                <span class="keyword">set</span> split column inside gutter to 1</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> mySpanIndex to (count of paragraphs of myStory) div 2 + 1</div>
<div class="line">            tell item mySpanIndex of paragraphs of myStory</div>
<div class="line">                --span columns</div>
<div class="line">                <span class="keyword">set</span> span column type to span columns</div>
<div class="line">                <span class="keyword">set</span> span split column count to all</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_setting_text_preferences"></a>
Setting Text Preferences</h2>
<p>The following script shows how to set general text preferences (for the complete script, see TextPreferences): </p>
<div class="fragment"><div class="line">        tell text preferences</div>
<div class="line">            <span class="keyword">set</span> abut text to text wrap to <span class="keyword">true</span></div>
<div class="line">            --baseline shift key increment can range from .001 to 200 points.</div>
<div class="line">            <span class="keyword">set</span> baseline shift key increment to 1</div>
<div class="line">            <span class="keyword">set</span> highlight custom spacing to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> highlight hj violations to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> highlight keeps to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> highlight substituted fonts to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> highlight substituted glyphs to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> justify text wraps to <span class="keyword">true</span></div>
<div class="line">            --kerning key increment value is 1/1000 of an em.</div>
<div class="line">            <span class="keyword">set</span> kerning key increment to 10</div>
<div class="line">            --leading key increment value can range from .001 to 200 points.</div>
<div class="line">            <span class="keyword">set</span> leading key increment to 1</div>
<div class="line">            <span class="keyword">set</span> link text files when importing to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> show invisibles to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> small cap to 60</div>
<div class="line">            <span class="keyword">set</span> subscript position to 30</div>
<div class="line">            <span class="keyword">set</span> subscript size to 60</div>
<div class="line">            <span class="keyword">set</span> superscript position to 30</div>
<div class="line">            <span class="keyword">set</span> superscript size to 60</div>
<div class="line">            <span class="keyword">set</span> typographers quotes to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> use optical size to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> use paragraph leading to <span class="keyword">false</span></div>
<div class="line">            <span class="keyword">set</span> z order text wrap to <span class="keyword">false</span></div>
<div class="line">        end tell</div>
<div class="line">        --Text editing preferences are application-wide.</div>
<div class="line">        tell text editing preferences</div>
<div class="line">            <span class="keyword">set</span> allow drag and drop text in story to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> drag and drop text in layout to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> smart cut and paste to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> triple click selects line to <span class="keyword">false</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_working_with_linked_stories"></a>
Working with Linked Stories</h2>
<p>Linked stories make it easier to manager multiple versions of the same story or text content in the same document; it makes it easier to support emerging digital publishing workflows, where, for example, you need to design for vertical and horizontal layouts. Linked stories behave similarly to traditional links. You can designate a story as a parent, and then place the same story at other places in the document as child stories. Whenever the parent story is updated, the child stories are flagged in the Links panel and can be updated to synchronize with the parent story.</p>
<h3><a class="anchor" id="id_as_creating_linked_stories"></a>
Creating linked stories</h3>
<p>There are several ways to create a linked story. It can be created by linking existing text frames with the parent story, or by telling the page, spread, master spread or document object to create the text frame at the specified location and link it with the parent story.</p>
<p>To link an existing text frame with the parent story, use the following script (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">            place and link childTextFrame1 parent story parentStory</div>
</div><!-- fragment --><p> To tell the page object to create a linked story for the parent story, the place and link method includes two additional parameters that you can use to specify the layer and point at which to place the linked story, as shown in the following script fragment (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">            tell myDocument</div>
<div class="line">                <span class="keyword">set</span> myNewPage to make page</div>
<div class="line">                tell myNewPage</div>
<div class="line">                    place and link parent story parentStory place point {originX, originY} without showing options</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
</div><!-- fragment --><p> To tell the spread object to create linked story for the parent story, the link method takes the same parameters as the link method for Page object, as shown in the following script fragment (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">            tell myDocument</div>
<div class="line">                <span class="keyword">set</span> myNewSpread to make spread</div>
<div class="line">                tell myNewSpread</div>
<div class="line">                    place and link parent story parentStory place point {originX, originY} without showing options</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
</div><!-- fragment --><p> You can also call the link method for the document object. The method takes the parent story as the only parameter. This method does not create the linked story; instead, it loads the place gun and lets the user decide where to place the linked story.</p>
<h3><a class="anchor" id="id_as_changing_linked_story_options"></a>
Changing linked story options</h3>
<p>To change the linked story options, use the following script fragment (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">            tell linked story options of myDocument</div>
<div class="line">                <span class="keyword">set</span> <span class="keyword">remove</span> forced line breaks to <span class="keyword">true</span></div>
<div class="line">                <span class="keyword">set</span> update <span class="keywordflow">while</span> saving to <span class="keyword">true</span></div>
<div class="line">                <span class="keyword">set</span> warn on update of edited story to <span class="keyword">true</span></div>
<div class="line">            end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_frequently_asked_questions"></a>
Frequently asked questions</h3>
<p><b>How can I tell whether a given link is a link for a linked story?</b></p>
<p>Use file path of myLink. If it is empty, then it is a link for a linked story.</p>
<p><b>Given a link for linked story, how can I get its link source?</b></p>
<p>Use this to select the link source: </p>
<div class="fragment"><div class="line">tell myLink to edit original</div>
</div><!-- fragment --><p>Then use this to find the active selection, which is the link source: </p>
<div class="fragment"><div class="line"><span class="keyword">set</span> mySelection to selection of application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span> </div>
</div><!-- fragment --><h1><a class="anchor" id="id_as_working_with_page_items"></a>
Working with Page Items</h1>
<p>This section covers scripting techniques related to the page items (rectangles, ellipses, graphic lines, polygons, text frames, buttons, and groups) that can appear in an InDesign layout.</p>
<h2><a class="anchor" id="id_as_creating_page_items"></a>
Creating Page Items</h2>
<p>Page items in an InDesign layout are arranged in a hierarchy, and appear within a container object of some sort. Spreads, pages, other page items, groups, and text characters are all examples of objects that can contain page items. This hierarchy of containers in the InDesign scripting object model is the same as in the InDesign user interface&ndash;when you create a rectangle by dragging the Rectangle tool on a page, you are specifying that the page is the container, or parent, of the rectangle. When you paste an ellipse into a polygon, you are specifying that the polygon is the parent of the ellipse, which, in turn, is a child object of its parent, a page.</p>
<p>In general, creating a new page item is as simple as telling the object you want to contain the page item to create the page item, as shown in the MakeRectangle script. </p>
<div class="fragment"><div class="line">--Given a page <span class="stringliteral">&quot;myPage&quot;</span>, create a <span class="keyword">new</span> rectangle at the <span class="keywordflow">default</span> size and location...</div>
<div class="line">tell myPage</div>
<div class="line">    <span class="keyword">set</span> myRectangle to make rectangl</div>
<div class="line">eend tell</div>
</div><!-- fragment --><p>In the above script, a new rectangle is created on the first page of a new document. The rectangle appears at the default location (near the upper left corner of the page) and has a default size (around ten points square). Moving the rectangle and changing its dimensions are both accomplished by filling its geometric bounds property with new values, as shown in the MakeRectangleWithProperties script. </p>
<div class="fragment"><div class="line">--Given a page <span class="stringliteral">&quot;myPage&quot;</span>, create a <span class="keyword">new</span> rectangle and specify its size and location...</div>
<div class="line">tell myPage</div>
<div class="line">    <span class="keyword">set</span> myRectangle to make rectangle with properties{geometric bounds:{72, 72, 144, 144}}</div>
<div class="line">end tell</div>
</div><!-- fragment --><p><b>Page item types</b></p>
<p>It is important to note that you cannot create a "generic" page item&ndash;you have to create a page item of a specific type (a rectangle, oval, graphic line, polygon, text frame, or button). You will also notice that InDesign changes the type of a page item as the geometry of the page item changes. A rectangle, for example, is always made up of a single, closed path containing four path points and having 90 degree interior angles. Change the location of a single point, however, or add another path, and the type of the page item changes to a polygon. Open the path and remove two of the four points, and InDesign will change the type to a graphic line. The only things that define the type of a rectangle, ellipse, graphic line, or polygon are:</p>
<ul>
<li>The number of paths in the object. Any page item with more than one path is a polygon.</li>
<li>The number and location of points on the first path in the object.</li>
</ul>
<p>To determine the type of a page item, use this example: </p>
<div class="fragment"><div class="line"><span class="keyword">set</span> myPageItemType to <span class="keyword">class </span>of myPageItem</div>
</div><!-- fragment --><p>The result of the above will be a string containing the type of the page item.</p>
<p>Getting the type of a page item**</p>
<p>When you have a reference to a generic page item, and want to find out what type of a page item it is, use class of to get the specific type. </p>
<div class="fragment"><div class="line">--Given a <span class="keyword">generic</span> page item <span class="stringliteral">&quot;myPageItem&quot;</span>...</div>
<div class="line">set myType to <span class="keyword">class </span>of myPageItem</div>
<div class="line">display dialog myType</div>
</div><!-- fragment --><p><b>Referring to page items</b></p>
<p>When you refer to page items inside a given container (a document, layer, page, spread, group, text frame, or page item), you use the page items collection of the container object. This gives you a collection of the top level page items inside the object. For example: </p>
<div class="fragment"><div class="line"><span class="keyword">set</span> myPageItems to page items of page 1 of document 1</div>
</div><!-- fragment --><p>The resulting collection (myPageItems) does not include objects inside groups (though it does include the group), objects inside other page items (thought it does contain the parent page item), or page items in text frames. To get a reference to all of the items in a given container, including items nested inside other page items, use the all page items property. </p>
<div class="fragment"><div class="line"><span class="keyword">set</span> myAllPageItems to all page items of page 1 of document 1</div>
</div><!-- fragment --><p>The resulting collection (myAllPageItems) includes all objects on the page, regardless of their position in the hierarchy.</p>
<p>Another way to refer to page items is to use their label property, much as you can use the name property of other objects (such as paragraph styles or layers). In the following examples, we will get an array of page items whose label has been set to myLabel. </p>
<div class="fragment"><div class="line"><span class="keyword">set</span> myPageItems to page items whose label is <span class="stringliteral">&quot;myLabel&quot;</span> of page 1 of document 1</div>
</div><!-- fragment --><p>If no page items on the page have the specified label, InDesign returns an empty array.</p>
<h3><a class="anchor" id="id_as_page-item_geometry"></a>
Page-item geometry</h3>
<p>If you are working with page items, it is almost impossible to do anything without understanding the way that rulers and measurements work together to specify the location and shape of an InDesign page item. If you use the Control panel in InDesign's user interface, you probably are already familiar with InDesign's geometry, but here is a quick summary:</p>
<ul>
<li>Objects are constructed relative to the coordinates shown on the rulers.</li>
<li>Changing the zero point location by either dragging the zero point or by changing the ruler origin changes the coordinates on the rulers.</li>
<li>Page items are made up of one or more paths, which, in turn, are made up of two or more path points. Paths can be open or closed.</li>
<li>Path points contain an anchor point (the location of the point itself) and two control handles (left direction, which controls the curve of the line segment preceding the point on the path; and right direction, which controls the curve of the segment following the point). Each of these properties contains an array in the form (x, y) (where x is the horizontal location of the point, and y is the vertical location). This array holds the location, in current ruler coordinates, of the point or control handle.</li>
</ul>
<p>All of the above means that if your scripts need to construct page items, you also need to control the location of the zero point, and you may want to set the measurement units in use.</p>
<p><b>Working with paths and path points</b></p>
<p>For most simple page items, you do not need to worry about the paths and path points that define the shape of the object. Rectangles, ellipses, and text frames can be created by specifying their geometric bounds, as we did in the earlier example in this chapter.</p>
<p>In some cases, however, you may want to construct or change the shape of a path by specifying path point locations, you can either set the anchor point, left direction, and right direction of each path point on the path individually (as shown in the DrawRegularPolygon_Slow script), or you can use the entire path property of the path to set all of the path point locations at once (as shown in the DrawRegularPolygon_Fast script). The latter approach is much faster.</p>
<p>The items in the array you use for the entire path property can contain anchor points only, or a anchor points and control handles. Here is an example array containing only anchor point locations: </p>
<div class="fragment"><div class="line">{{x1, y1}, {x2, y2}, ...}</div>
</div><!-- fragment --><p>Where x and y specify the location of the anchor.</p>
<p>Here is an example containing fully-specified path points (i.e., arrays containing the left direction, anchor, and right direction, in that order): </p>
<div class="fragment"><div class="line">{{{xL1, YL1}, {x1, y1}, {xR1, yR1}}, {{xL2, YL2}, {x2, y2}, {xR2, yR2}}, ...}</div>
</div><!-- fragment --><p>Where xL and yL specify the left direction, x and y specify the anchor point, and xR and yR specify the right direction.</p>
<p>You can also mix the two approaches, as shown in the following example: </p>
<div class="fragment"><div class="line">{{{xL1, YL1}, {x1, y1}, {xR1, yR1}}, {x2, y2}, ...}</div>
</div><!-- fragment --><p>Note that the original path does not have to have the same number of points as you specify in the array-InDesign will add or subtract points from the path as it applies the array to the entire path property.</p>
<p>The AddPathPoint script shows how to add path points to a path without using the entire path property. </p>
<div class="fragment"><div class="line">        --Given a graphic line <span class="stringliteral">&quot;myGraphicLine&quot;</span>...</div>
<div class="line">        tell path 1 of myGraphicLine</div>
<div class="line">            <span class="keyword">set</span> myPathPoint to make path point</div>
<div class="line">        end tell</div>
<div class="line">        --Move the path point to a specific location.</div>
<div class="line">        <span class="keyword">set</span> anchor of myPathPoint to {144, 144}</div>
</div><!-- fragment --><p> The DeletePathPoint script shows how to delete a path point from a path. </p>
<div class="fragment"><div class="line">--Given a polygon <span class="stringliteral">&quot;myPolygon&quot;</span>, <span class="keyword">remove</span> the </div>
<div class="line">--last path point in the first path.</div>
<div class="line">tell path 1 of myPolygon</div>
<div class="line">    <span class="keyword">delete</span> path point -1</div>
<div class="line">end tell</div>
</div><!-- fragment --><h2><a class="anchor" id="id_as_grouping_page_items"></a>
Grouping Page Items</h2>
<p>In the InDesign user interface, you create groups of page items by selecting them and then choosing Group from the Object menu (or by pressing the corresponding keyboard shortcut). In InDesign scripting, you tell the object containing the page items you want to group (usually a page or spread) to group the page items, as shown in the Group script. </p>
<div class="fragment"><div class="line">--Given a page <span class="stringliteral">&quot;myPage&quot;</span> containing at least two ovals and two rectangles...</div>
<div class="line">tell myPage</div>
<div class="line">    <span class="keyword">set</span> myRectangleA to rectangle 1</div>
<div class="line">    <span class="keyword">set</span> myRectangleB to rectangle 2</div>
<div class="line">    <span class="keyword">set</span> Oval to oval 1</div>
<div class="line">    <span class="keyword">set</span> Oval to oval 2</div>
<div class="line">    --Group the items.</div>
<div class="line">    make group with properties{group items: {myRectangleA, myRectangleB, myOvalA, myOvalB})</div>
<div class="line">end tell</div>
</div><!-- fragment --><p>To ungroup, you tell the group itself to ungroup, as shown in the Ungroup script. </p>
<div class="fragment"><div class="line">--Given a group <span class="stringliteral">&quot;myGroup&quot;</span>...</div>
<div class="line">tell myGroup</div>
<div class="line">    <span class="keyword">set</span> myPageItems to ungroup</div>
<div class="line">end tell</div>
</div><!-- fragment --><p>There is no need to ungroup a group to change the shape, formatting, or content of the page items in the group. Instead, simply get a reference to the page item you want to change, just as you would with any other page item.</p>
<h2><a class="anchor" id="id_as_duplicating_and_moving_page_items"></a>
Duplicating and Moving Page Items</h2>
<p>In the InDesign user interface, you can move page items by selecting them and dragging them to a new location. You can also create copies of page items by copying and pasting, by holding down Option/Alt as you drag an object, or by choosing Duplicate, Paste In Place, or Step and Repeat from the Edit menu. In InDesign scripting, you can use the move method to change the location of page items, and the duplicate method to create a copy of a page item (and, optionally, move it to another location).</p>
<p>The move method can take one of two optional parameters: move to and move by. Both parameters consist of an array of two measurement units, consisting of a horizontal value and a vertical value. move to specifies an absolute move to the location specified by the array, relative to the current location of the zero point. move by specifies how far to move the page item relative to the current location of the page item itself. The Move script shows the difference between these two approaches. </p>
<div class="fragment"><div class="line">        --Given a reference to a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span>...</div>
<div class="line">        --Move the rectangle to the location {12, 12}.</div>
<div class="line">        --Absolute move:</div>
<div class="line">        tell myRectangle to move to {12, 12}</div>
<div class="line">        --Move the rectangle *by* 12 points horizontally, 12 points vertically.</div>
<div class="line">        --Relative move (note empty first parameter):</div>
<div class="line">        tell myRectangle to move by {12, 12}</div>
<div class="line">        --Move the rectangle to another page (rectangle appears at (0,0).</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myPage to make page</div>
<div class="line">        end tell</div>
<div class="line">        tell myRectangle to move to myPage</div>
<div class="line">        --To move a page item to another document, use the Duplicate method.</div>
</div><!-- fragment --><p> Note that the move method truly moves the object-when you move a page item to another document, it is deleted from the original document. To move the object to another while retaining the original, use the duplicate method (see below).</p>
<p>Use the duplicate method to create a copy of a page item. By default, the duplicate method creates a "clone" of an object in the same location as the original object. Optional parameters can be used with the duplicate method to move the duplicated object to a new location (including other pages in the same document, or to another document entirely). </p>
<div class="fragment"><div class="line">        --Given a reference to a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span>...</div>
<div class="line">        --Duplicate the rectangle and move the </div>
<div class="line">        --duplicate to the location (12, 12).</div>
<div class="line">        --Absolute move:</div>
<div class="line">        <span class="keyword">set</span> myDuplicate to duplicate myRectangle to {12, 12}</div>
<div class="line">        --Duplicate the rectangle and move the duplicate *by* 12</div>
<div class="line">        --points horizontally, 12 points vertically.</div>
<div class="line">        --Relative move:</div>
<div class="line">        <span class="keyword">set</span> myDuplicate to duplicate myRectangle</div>
<div class="line">        move myDuplicate by {12, 12}</div>
<div class="line">        --Duplicate the rectangle to another page (rectangle appears at (0,0).</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myPage to make page</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myDuplicate to duplicate myRectangle to myPage</div>
<div class="line">        --Duplicate the rectangle to another document.</div>
<div class="line">        <span class="keyword">set</span> myNewDocument to make document</div>
<div class="line">        <span class="keyword">set</span> myDuplicate to duplicate myRectangle to page 1 of myNewDocument</div>
</div><!-- fragment --><p> You can also use copy and paste in InDesign scripting, but scripts using on these methods require that you select objects (to copy) and rely on the current view to set the location of the pasted elements (when you paste). This means that scripts that use copy and paste tend to be more fragile (i.e., more likely to fail) than scripts that use duplicate and move. Whenever possible, try to write scripts that do not depend on the current view or selection state.</p>
<h3><a class="anchor" id="id_as_creating_compound_paths"></a>
Creating compound paths</h3>
<p>InDesign can combine the paths of two or more page items into a single page item containing multiple paths using the Object &gt; Paths &gt; Make Compound Path menu option. You can do this in InDesign scripting using the make compound path command of a page item, as shown in the following script fragment (for the complete script, refer to the MakeCompoundPath script). </p>
<div class="fragment"><div class="line">        --Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">        tell myRectangle to make compound path with myOval</div>
</div><!-- fragment --><p> When you create a compound path, regardless of the types of the objects used to create the compound path, the type of the resulting object is polygon.</p>
<p>To release a compound path and convert each path in the compound path into a separate page item, use the release compound path command of a page item, as shown in the following script fragment (for the complete script, refer to the ReleaseCompoundPath script). </p>
<div class="fragment"><div class="line">        --Given a path <span class="stringliteral">&quot;myCompoundPath&quot;</span> (all compound paths are type Rectangle)...</div>
<div class="line">        tell myCompoundPath</div>
<div class="line">            <span class="keyword">set</span> myPageItems to release compound path</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_using_pathfinder_operations"></a>
Using Pathfinder operations</h3>
<p>The InDesign Pathfinder features offer ways to work with relationships between page items on an InDesign page. You can merge the paths of page items, or subtract the area of one page item from another page item, or create a new page item from the area of intersection of two or more page items. Every page item supports the following methods related to the Pathfinder features: AddPath, ExcludeOverlapPath, IntersectPath, MinusBack, and SubtractPath.</p>
<p>All of the Pathfinder methods work the same way&ndash;you provide a list of page items to use as the basis for the operation (just as you select a series of page items before choosing the Pathfinder operation in the user interface).</p>
<p>Note that it is very likely that the type of the object will change after you apply one of the Pathfinder operations. Which object type it will change to depends on the number and location of the points in the path or paths resulting from the operation.</p>
<p>To merge two page items into a single page item, for example, you would use something like the approach shown in the following fragment (for the complete script, refer to AddPath). </p>
<div class="fragment"><div class="line">        --Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">        tell myRectangle to add path with myOval</div>
</div><!-- fragment --><p> The exclude overlap path command creates a new path based on the non-intersecting areas of two or more overlapping page items, as shown in the following script fragment (for the complete script, refer to ExcludeOverlapPath). </p>
<div class="fragment"><div class="line">--Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">tell myRectangle</div>
<div class="line">    exclude overlap path with myOval</div>
<div class="line">end tell</div>
</div><!-- fragment --><p>The intersect path command creates a new page item from the area of intersection of two or more page items, as shown in the following script fragment (for the complete script, refer to IntersectPath). </p>
<div class="fragment"><div class="line">        --Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">        tell myRectangle to intersect path with myOval</div>
</div><!-- fragment --><p> The minus back command removes the area of intersection of the back-most object from the page item or page items in front of it, as shown in the following script fragment (for the complete script, refer to MinusBack). </p>
<div class="fragment"><div class="line">        --Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">        tell myRectangle to minus back with myOval</div>
</div><!-- fragment --><p> The subtract path command removes the area of intersection of the frontmost object from the page item or page items behind it, as shown in the following script fragment (for the complete script, refer to SubtractPath). </p>
<div class="fragment"><div class="line">--Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">tell myOval</div>
<div class="line">    subtract with myRectangle</div>
<div class="line">end tell</div>
</div><!-- fragment --><h3><a class="anchor" id="id_as_converting_page-item_shapes"></a>
Converting page-item shapes</h3>
<p>InDesign page items can be converted to other shapes using the options in the Object &gt; Convert Shape menu or the Pathfinder panel (Window &gt; Object and Layout &gt; Pathfinder). In InDesign scripting, page items support the convert shape command, as demonstrated in the following script fragment (for the complete script, refer to ConvertShape). </p>
<div class="fragment"><div class="line">        --Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span>...</div>
<div class="line">        tell myRectangle to convert shape given convert to rounded rectangle</div>
</div><!-- fragment --><p> The convert shape command also provides a way to open or close reverse paths, as shown in the following script fragment (for the complete script, refer to OpenPath). </p>
<div class="fragment"><div class="line">        --Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">        tell myRectangle to convert shape given convert to open path</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_arranging_page_items"></a>
Arranging page items</h3>
<p>Page items in an InDesign layout can be arranged in front of or behind each other by adjusting their stacking order within a layer, or can be placed on different layers. The following script fragment shows how to bring objects to the front or back of their layer, and how to control the stacking order of objects relative to each other (for the complete script, refer to StackingOrder). </p>
<div class="fragment"><div class="line">        --Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an oval <span class="stringliteral">&quot;myOval&quot;</span>,</div>
<div class="line">        --where <span class="stringliteral">&quot;myOval&quot;</span> is in front of <span class="stringliteral">&quot;myRectangle&quot;</span>, bring</div>
<div class="line">        --the rectangle to the front...</div>
<div class="line">        tell myRectangle to bring to front</div>
</div><!-- fragment --><p> When you create a page item, you can specify its layer, but you can also move a page item from one layer to another. The layer property of the page item is the key to doing this, as shown in the following script fragment (for the complete script, refer to ItemLayer). </p>
<div class="fragment"><div class="line">        --Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">        --send the rectangle to the layer...</div>
<div class="line">        <span class="keyword">set</span> item layer of myRectangle to layer <span class="stringliteral">&quot;myLayer&quot;</span> of document 1</div>
</div><!-- fragment --><p> The stacking order of layers in a document can also be changed using the move command of the layer itself, as shown in the following script fragment (for the complete script, refer to MoveLayer). </p>
<div class="fragment"><div class="line">        --Given a layer <span class="stringliteral">&quot;myLayer&quot;</span>, move the layer behind the <span class="keywordflow">default</span> layer.</div>
<div class="line">        tell document 1</div>
<div class="line">            move myLayer to end of layers of document 1</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_transforming_page_items"></a>
Transforming Page Items</h2>
<p>Transformations include scaling, rotation, shearing (skewing), and movement (or translation). In scripting, you apply transformations using the transform method. This one method replaces the resize, rotate, and shear methods used in versions of InDesign prior to InDesign CS3 (5.0).</p>
<h3><a class="anchor" id="id_as_using_the_transform_method"></a>
Using the transform method</h3>
<p>The transform method requires a transformation matrix (transformation matrix) object that defines the transformation or series of transformations to apply to the object. A transformation matrix can contain any combination of scale, rotate, shear, or translate operations.</p>
<p>The order in which transformations are applied to an object is important. Applying transformations in differing orders can produce very different results.</p>
<p>To transform an object, you follow two steps:</p>
<ol type="1">
<li>Create a transformation matrix.</li>
<li>Apply the transformation matrix to the object using the transform method. When you do this, you also specify the coordinate system in which the transformation is to take place. For more on coordinate systems, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_coordinate_spaces">Coordinate spaces</a>. In addition, you specify the center of transformation, or transformation origin. For more on specifying the transformation origin, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_transformation_origin">Transformation origin</a>.</li>
</ol>
<p>The following scripting example demonstrates the basic process of transforming a page item. (For the complete script, see TransformExamples.) </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        <span class="keyword">set</span> when scaling of transform preferences to adjust scaling percentage</div>
<div class="line">        --Rotate a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> around its center point.</div>
<div class="line">        <span class="keyword">set</span> myRotateMatrix to make transformation matrix with properties {counterclockwise rotation angle:27}</div>
<div class="line">        --Scale a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> around its center point.</div>
<div class="line">        <span class="keyword">set</span> myScaleMatrix to make transformation matrix with properties {horizontal scale factor:0.5, vertical scale factor:0.5}</div>
<div class="line">        --Shear a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> around its center point.</div>
<div class="line">        <span class="keyword">set</span> myShearMatrix to make transformation matrix with properties {clockwise shear angle:30}</div>
<div class="line">        tell page 1 of myDocument</div>
<div class="line">            <span class="keyword">set</span> myRectangle to make rectangle with properties {geometric bounds:{72, 72, 144, 288}}</div>
<div class="line">            transform myRectangle in pasteboard coordinates from center anchor with matrix myRotateMatrix</div>
<div class="line">            --Create another rectangle.</div>
<div class="line">            <span class="keyword">set</span> myRectangle to make rectangle with properties {geometric bounds:{72, 72, 144, 288}}</div>
<div class="line">            --Transform the rectangle.</div>
<div class="line">            transform myRectangle in pasteboard coordinates from center anchor with matrix myScaleMatrix</div>
<div class="line">            --Create another rectangle.</div>
<div class="line">            <span class="keyword">set</span> myRectangle to make rectangle with properties {geometric bounds:{72, 72, 144, 288}}</div>
<div class="line">            --Transform the rectangle.</div>
<div class="line">            transform myRectangle in pasteboard coordinates from center anchor with matrix myShearMatrix</div>
<div class="line">            --Scale a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> around a specified ruler point ({72, 72})</div>
<div class="line">            <span class="keyword">set</span> myRectangle to make rectangle with properties {geometric bounds:{72, 72, 144, 288}}</div>
<div class="line">            transform myRectangle in pasteboard coordinates from {{72, 72}, center anchor} with matrix myRotateMatrix with considering ruler units</div>
<div class="line">            --Rotate a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> around a specified ruler point ({72, 72})</div>
<div class="line">            <span class="keyword">set</span> myRectangle to make rectangle with properties {geometric bounds:{72, 72, 144, 288}}</div>
<div class="line">            transform myRectangle in pasteboard coordinates from {{72, 72}, center anchor} with matrix myScaleMatrix with considering ruler units</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> For a script that "wraps" transformation routines in a series of easy-to-use handlers, refer to the Transform script.</p>
<h3><a class="anchor" id="id_as_working_with_transformation_matrices"></a>
Working with transformation matrices</h3>
<p>A transformation matrix cannot be changed once it has been created, but a variety of methods can interact with the transformation matrix to create a new transformation matrix based on the existing transformation matrix. In the following examples, we show how to apply transformations to a transformation matrix and replace the original matrix. (For the complete script, see TransformMatrix.)</p>
<div class="fragment"><div class="line">--Scale a transformation matrix by 50% in both </div>
<div class="line">--horizontal and vertical dimensions.</div>
<div class="line">set myTransformationMatrix to scale matrix myTransformationMatrix horizontally by .5 vertically by .5</div>
<div class="line">--Rotate a transformation matrix by 45 degrees.</div>
<div class="line">set myTransformationMatrix to rotate matrix by angle 45</div>
<div class="line">--Shear a transformation matrix by 15 degrees.</div>
<div class="line">set myTransformationMatrix to shear matrix by angle 15</div>
</div><!-- fragment --><p>When you use the rotate matrix method, you can use a sine or cosine value to transform the matrix, rather than an angle in degrees, as shown in the RotateMatrix script. </p>
<div class="fragment"><div class="line">        --Given a rectangle on page 1...</div>
<div class="line">        <span class="keyword">set</span> myRectangle to rectangle 1 of page 1 of document 1</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to make transformation matrix</div>
<div class="line">        --rotate matrix can take the following parameters: byAngle, byCosine, bySine;</div>
<div class="line">        --The following statements are equivalent (0.25881904510252 is the sine of 15 degrees, 0.96592582628907 is the cosine).</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to rotate matrix myTransformationMatrix by angle 15</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to rotate matrix myTransformationMatrix by cosine 0.965925826289</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to rotate matrix myTransformationMatrix by sine 0.258819045103</div>
<div class="line">        --Rotate the rectangle by the rotated matrix--45 degrees.</div>
<div class="line">        transform myRectangle in pasteboard coordinates from center anchor with matrix myTransformationMatrix</div>
</div><!-- fragment --><p> When you use the shear matrix method, you can provide a slope, rather than an angle in degrees, as shown in the ShearMatrix script. </p>
<div class="fragment"><div class="line">        --Given a rectangle on page 1...</div>
<div class="line">        <span class="keyword">set</span> myRectangle to rectangle 1 of page 1 of document 1</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to make transformation matrix</div>
<div class="line">        --shear matrix can take the following parameters: by angle, by slope</div>
<div class="line">        --The following statements are equivalent. slope = rise/run--so a 45 degree slope is 1.</div>
<div class="line">        --<span class="keyword">set</span> myTransformationMatrix to shear matrix myTransformationMatrix by angle 45</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to shear matrix myTransformationMatrix by slope 1</div>
<div class="line">        --Shear the rectangle.</div>
<div class="line">        transform myRectangle in pasteboard coordinates from center anchor with matrix myTransformationMatrix</div>
</div><!-- fragment --><p> You can get the inverse of a transformation matrix using the invert matrix method, as shown in the following example. (For the complete script, see InvertMatrix.) You can use the inverted transformation matrix to undo the effect of the matrix. </p>
<div class="fragment"><div class="line">        --Given a rectangle on page 1...</div>
<div class="line">        <span class="keyword">set</span> myRectangle to rectangle 1 of page 1 of document 1</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to make transformation matrix with properties {counterclockwise rotation angle:30, horizontal translation:12, vertical translation:12}</div>
<div class="line">        transform myRectangle in pasteboard coordinates from center anchor with matrix myTransformationMatrix</div>
<div class="line">        <span class="keyword">set</span> myNewRectangle to duplicate myRectangle</div>
<div class="line">        --Move the duplicated rectangle to the location of the original </div>
<div class="line">        --rectangle by inverting, then applying the transformation matrix.</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to invert matrix myTransformationMatrix</div>
<div class="line">        transform myNewRectangle in pasteboard coordinates from center anchor with matrix myTransformationMatrix</div>
</div><!-- fragment --><p> You can add transformation matrices using the catenate matrix method, as shown in the following example. (For the complete script, see CatenateMatrix.) </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myTransformationMatrixA to make transformation matrix with properties {counterclockwise rotation angle:30}</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrixB to make transformation matrix with properties {horizontal translation:72, vertical translation:72}</div>
<div class="line">        <span class="keyword">set</span> myRectangle to rectangle -1 of page 1 of document 1</div>
<div class="line">        <span class="keyword">set</span> myNewRectangle to duplicate myRectangle</div>
<div class="line">        --Rotate the duplicated rectangle.</div>
<div class="line">        transform myNewRectangle in pasteboard coordinates from center anchor with matrix myTransformationMatrixA</div>
<div class="line">        <span class="keyword">set</span> myNewRectangle to duplicate myRectangle</div>
<div class="line">        --Move the duplicate (unrotated) rectangle.</div>
<div class="line">        transform myNewRectangle in pasteboard coordinates from center anchor with matrix myTransformationMatrixB</div>
<div class="line">        --Merge the two transformation matrices.</div>
<div class="line">        set myTransformationMatrix to catenate matrix myTransformationMatrixA with matrix myTransformationMatrixB</div>
<div class="line">        set myNewRectangle to duplicate myRectangle</div>
<div class="line">        --The duplicated rectangle will be both moved and rotated.</div>
<div class="line">        transform myNewRectangle in pasteboard coordinates from center anchor with matrix myTransformationMatrix</div>
</div><!-- fragment --><p> When an object is transformed, you can get the transformation matrix that was applied to it, using the transform values of method, as shown in the following script fragment. (For the complete script, see TransformValuesOf.) </p>
<div class="fragment"><div class="line">        --Given a document with a rectangle on page 1...</div>
<div class="line">        <span class="keyword">set</span> myRectangle to rectangle 1 of page 1 of document 1</div>
<div class="line">        --Note that transform values of always returns a list containing a single transformation matrix.</div>
<div class="line">        <span class="keyword">set</span> myTransformArray to transform values of myRectangle in pasteboard coordinates</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to item 1 of myTransformArray</div>
<div class="line">        <span class="keyword">set</span> myRotationAngle to counterclockwise rotation angle of myTransformationMatrix</div>
<div class="line">        <span class="keyword">set</span> myShearAngle to clockwise shear angle of myTransformationMatrix</div>
<div class="line">        <span class="keyword">set</span> myXScale to horizontal scale factor of myTransformationMatrix</div>
<div class="line">        <span class="keyword">set</span> myYScale to vertical scale factor of myTransformationMatrix</div>
<div class="line">        <span class="keyword">set</span> myXTranslate to horizontal translation of myTransformationMatrix</div>
<div class="line">        <span class="keyword">set</span> myYTranslate to vertical translation of myTransformationMatrix</div>
<div class="line">        <span class="keyword">set</span> myString to <span class="stringliteral">&quot;Rotation Angle: &quot;</span> &amp; myRotationAngle &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;Shear Angle: &quot;</span> &amp; myShearAngle &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;Horizontal Scale Factor: &quot;</span> &amp; myXScale &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;Vertical Scale Factor: &quot;</span> &amp; myYScale &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;Horizontal Translation: &quot;</span> &amp; myXTranslate &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;Vertical Translation: &quot;</span> &amp; myYTranslate &amp; <span class="keywordflow">return</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;Note that the Horizontal Translation and&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;Vertical Translation values are the location&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;of the center anchor in pasteboard coordinates.&quot;</span></div>
<div class="line">        display dialog (myString)</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The values in the horizontal- and vertical-translation fields of the transformation matrix returned by this method are the location of the upper-left anchor of the object, in pasteboard coordinates.</dd></dl>
<h3><a class="anchor" id="id_as_coordinate_spaces"></a>
Coordinate spaces</h3>
<p>In the transformation scripts we presented earlier, you might have noticed the pasteboard coordinates enumeration provided as a parameter for the transform method. This parameter determines the system of coordinates, or coordinate space, in which the transform operation occurs. The coordinate space can be one of the following values:</p>
<ul>
<li>pasteboard coordinates is the coordinate space of the entire InDesign document. This coordinate space extends behind all spreads in a document. It does not correspond to InDesign's rulers or zero point, nor does it have anything to do with the pasteboard area you can see around pages in the InDesign user interface. Transformations applied to objects have no effect on this coordinate space (e.g., the angle of the horizontal and vertical axes do not change).</li>
<li>parent coordinates is the coordinate space of the parent of the object. Any transformations applied to the parent affect the parent coordinates; for example, rotating the parent object changes the angle of the horizontal and vertical axes of this coordinate space. In this case, the parent object refers to the group or page item containing the object; if the parent of the object is a page or spread, parent coordinates are the same as spread coordinates.</li>
<li>inner coordinates is the coordinate space in which the object itself was created.</li>
<li>spread coordinates is the coordinate space of the spread. The origin of this space is at the center of the spread, and does not correspond to the rulers you see in the user interface.</li>
</ul>
<p>The following script shows the differences between the coordinate spaces. (For the complete script, see CoordinateSpaces.) </p>
<div class="fragment"><div class="line">        --Given a group containing a rectangle on page 1...</div>
<div class="line">        <span class="keyword">set</span> myRectangle to rectangle 1 of group 1 of page 1 of document 1</div>
<div class="line">        <span class="keyword">set</span> myString to <span class="stringliteral">&quot;The page contains a group which has been&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;rotated 45 degrees (counterclockwise).&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;The rectangle inside the group was&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;rotated 45 degrees counterclockwise before&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;it was added to the group.&quot;</span> &amp; <span class="keywordflow">return</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;Watch as we apply a series of scaling&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;operations in different coordinate spaces.&quot;</span></div>
<div class="line">        display dialog myString</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to make transformation matrix with properties {horizontal scale factor:2}</div>
<div class="line">        --Transform the rectangle <span class="keyword">using</span> inner coordinates.</div>
<div class="line">        transform myRectangle in inner coordinates from center anchor with matrix myTransformationMatrix</div>
<div class="line">        --Select the rectangle and display an alert.</div>
<div class="line">        select myRectangle</div>
<div class="line">        display dialog <span class="stringliteral">&quot;Transformed using inner coordinates.&quot;</span></div>
<div class="line">        --Undo the transformation.</div>
<div class="line">        tell document 1 to undo</div>
<div class="line">        --Transform <span class="keyword">using</span> parent coordinates.</div>
<div class="line">        transform myRectangle in parent coordinates from center anchor with matrix myTransformationMatrix</div>
<div class="line">        select myRectangle</div>
<div class="line">        display dialog <span class="stringliteral">&quot;Transformed using parent coordinates.&quot;</span></div>
<div class="line">        tell document 1 to undo</div>
<div class="line">        --Transform <span class="keyword">using</span> pasteboard coordinates.</div>
<div class="line">        transform myRectangle in pasteboard coordinates from center anchor with matrix myTransformationMatrix</div>
<div class="line">        select myRectangle</div>
<div class="line">        display dialog <span class="stringliteral">&quot;Transformed using pasteboard coordinates.&quot;</span></div>
<div class="line">        tell document 1 to undo</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_transformation_origin"></a>
Transformation origin</h3>
<p>The transformation origin is the center point of the transformation. The transformation origin can be specified in several ways:</p>
<ul>
<li>Bounds space:<ul>
<li>anchor - An anchor point on the object itself. <div class="fragment"><div class="line">center anchor</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Ruler space:<ul>
<li>(x, y), page index - A point, relative to the ruler origin on a specified page of a spread. <div class="fragment"><div class="line">{{72, 144}, 1}</div>
</div><!-- fragment --></li>
<li>(x, y), location - A point, relative to the parent page of the specified location of the object. Location can be specified as an anchor point or a coordinate pair. It can be specified relative to the object's geometric or visible bounds, and it can be specified in a given coordinate space. <div class="fragment"><div class="line">{{72, 144}, center anchor}</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Transform space:<ul>
<li>(x, y) - A point in the pasteboard coordinate space. <div class="fragment"><div class="line">{72, 72}</div>
</div><!-- fragment --></li>
<li>(x, y), coordinate system - A point in the specified coordinate space. <div class="fragment"><div class="line">{{72, 72}, parent coordinates}</div>
</div><!-- fragment --></li>
<li>((x, y)) - A point in the coordinate space given as the 'in' parameter of the transform method. <div class="fragment"><div class="line">{{72, 72}}</div>
</div><!-- fragment --></li>
</ul>
</li>
</ul>
<p>The following script example shows how to use some of the transformation origin options. (For the complete script, see TransformationOrigin.) </p>
<div class="fragment"><div class="line">        --Given a rectangle on page 1...</div>
<div class="line">        <span class="keyword">set</span> myRectangle to rectangle 1 of document 1</div>
<div class="line">        <span class="keyword">set</span> myString to <span class="stringliteral">&quot;Watch as we rotate the rectangle using different anchor points,&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;bounds types, and coordinate spaces.&quot;</span> &amp; <span class="keywordflow">return</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;You might have to drag the alert aside to&quot;</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        <span class="keyword">set</span> myString to myString &amp; <span class="stringliteral">&quot;see the effect of the transformation.&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myNewRectangle to duplicate myRectangle</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to make transformation matrix with properties {counterclockwise rotation angle:30}</div>
<div class="line">        --Rotate around the duplicated rectangle<span class="stringliteral">&#39;s center point.</span></div>
<div class="line"><span class="stringliteral">        transform myNewRectangle in pasteboard coordinates from center anchor with matrix myTransformationMatrix</span></div>
<div class="line"><span class="stringliteral">        --Select the rectangle and display an alert.</span></div>
<div class="line"><span class="stringliteral">        select myNewRectangle</span></div>
<div class="line"><span class="stringliteral">        display dialog &quot;Rotated around center anchor.&quot;</span></div>
<div class="line"><span class="stringliteral">        --Undo the transformation.</span></div>
<div class="line"><span class="stringliteral">        tell document 1 to undo</span></div>
<div class="line"><span class="stringliteral">        --Rotate the rectangle around the ruler location [-100, -100]. Note that the anchor point specified here specifes the page</span></div>
<div class="line"><span class="stringliteral">        --containing the point--*not* that transformation point itself. The transformation gets the ruler coordinate [-100, -100] based</span></div>
<div class="line"><span class="stringliteral">        --on that page. Setting the considerRulerUnits parameter to true makes certain that the transformation uses the current</span></div>
<div class="line"><span class="stringliteral">        --ruler units.</span></div>
<div class="line"><span class="stringliteral">        transform myNewRectangle in pasteboard coordinates from {{-100, -100}, top left anchor} with matrix myTransformationMatrix with considering ruler units</span></div>
<div class="line"><span class="stringliteral">        --Move the page guides to reflect the transformation point.</span></div>
<div class="line"><span class="stringliteral">        tell guide 1 of page 1 of document 1 to set location to -100</span></div>
<div class="line"><span class="stringliteral">        tell guide 2 of page 1 of document 1 to set location to -100</span></div>
<div class="line"><span class="stringliteral">        --Select the rectangle and display an alert.</span></div>
<div class="line"><span class="stringliteral">        select myNewRectangle</span></div>
<div class="line"><span class="stringliteral">        display dialog &quot;Rotated around -100x, -100y.&quot;</span></div>
<div class="line"><span class="stringliteral">        --Undo the transformation and the guide moves.</span></div>
<div class="line"><span class="stringliteral">        tell document 1 to undo</span></div>
<div class="line"><span class="stringliteral">        tell document 1 to undo</span></div>
<div class="line"><span class="stringliteral">        tell document 1 to undo</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_resolving_locations"></a>
Resolving locations</h3>
<p>Sometimes, you need to get the location of a point specified in one coordinate space in the context of another coordinate space. To do this, use the resolve method, as shown in the following script example. (For the complete script, see ResolveLocation.) </p>
<div class="fragment"><div class="line">        --Given a group on page 1 that contains a rectangle...</div>
<div class="line">        <span class="keyword">set</span> myRectangle to rectangle 1 of group 1 of page 1 of document 1</div>
<div class="line">        --Template <span class="keywordflow">for</span> resolve:</div>
<div class="line">        --<span class="keyword">set</span> theResult to resolve &lt;reference&gt;</div>
<div class="line">        --location &lt;anything&gt; usually either an anchor point or a coordinate pair and an anchor point (as shown below)</div>
<div class="line">        --in &lt;coordinate system&gt; usually either pasteboard coordinates or parent coordinates</div>
<div class="line">        --considering ruler units &lt;boolean&gt; <span class="keyword">set</span> to <span class="keyword">true</span> <span class="keywordflow">if</span> you have provided page coordinates (as shown below)</div>
<div class="line">        --</div>
<div class="line">        --Get ruler coordinate {72, 72} in pasteboard coordinates.</div>
<div class="line">        <span class="keyword">set</span> myPageLocation to resolve myRectangle location {{72, 72}, top right anchor} in pasteboard coordinates without considering ruler units</div>
<div class="line">        --resolve returns a list containing a single item.</div>
<div class="line">        <span class="keyword">set</span> myPageLocation to item 1 of myPageLocation</div>
<div class="line">        display dialog <span class="stringliteral">&quot;Pasteboard Coordinates:&quot;</span> &amp; <span class="keywordflow">return</span> &amp; <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;X: &quot;</span> &amp; item 1 of myPageLocation &amp; <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;Y: &quot;</span> &amp; item 2 of myPageLocation</div>
<div class="line">        --Get ruler coordinate {72, 72} in parent coordinates.</div>
<div class="line">        <span class="keyword">set</span> myPageLocation to resolve myRectangle location {{72, 72}, top right anchor} in parent coordinates without considering ruler units</div>
<div class="line">        --resolve returns a list containing a single item.</div>
<div class="line">        <span class="keyword">set</span> myPageLocation to item 1 of myPageLocation</div>
<div class="line">        display dialog <span class="stringliteral">&quot;Parent Coordinates:&quot;</span> &amp; <span class="keywordflow">return</span> &amp; <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;X: &quot;</span> &amp; item 1 of myPageLocation &amp; <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;Y: &quot;</span> &amp; item 2 of myPageLocation</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_transforming_points"></a>
Transforming points</h3>
<p>You can transform points as well as objects, which means scripts can perform a variety of mathematical operations without having to include the calculations in the script itself. This is particularly useful for AppleScript, which lacks the basic trigonometric functions (sine, cosine) required for most transformations. The ChangeCoordinates sample script shows how to draw a series of regular polygons using this approach: </p>
<div class="fragment"><div class="line">--General purpose routine <span class="keywordflow">for</span> drawing regular polygons from their center point.</div>
<div class="line">on myDrawPolygon(myParent, myCenterPoint, myNumberOfPoints, myRadius, myStarPolygon, myStarInset)</div>
<div class="line">    local myPathPoints, myTransformedPoint</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myPathPoints to {}</div>
<div class="line">        <span class="keyword">set</span> myPoint to {0, 0}</div>
<div class="line">        <span class="keywordflow">if</span> myStarPolygon is <span class="keyword">true</span> then</div>
<div class="line">            <span class="keyword">set</span> myNumberOfPoints to myNumberOfPoints * 2</div>
<div class="line">        end <span class="keywordflow">if</span></div>
<div class="line">        <span class="keyword">set</span> myInnerRadius to myRadius * myStarInset</div>
<div class="line">        <span class="keyword">set</span> myAngle to 360 / myNumberOfPoints</div>
<div class="line">        <span class="keyword">set</span> myRotateMatrix to make transformation matrix with properties {counterclockwise rotation angle:myAngle}</div>
<div class="line">        <span class="keyword">set</span> myOuterTranslateMatrix to make transformation matrix with properties {horizontal translation:myRadius}</div>
<div class="line">        <span class="keyword">set</span> myInnerTranslateMatrix to make transformation matrix with properties {horizontal translation:myInnerRadius}</div>
<div class="line">        repeat with myPointCounter from 0 to myNumberOfPoints - 1</div>
<div class="line">            --Translate the point to the inner/outer radius.</div>
<div class="line">            <span class="keywordflow">if</span> myStarInset = 1 or my myIsEven(myPointCounter) is true then</div>
<div class="line">                set myTransformedPoint to change coordinates myOuterTranslateMatrix point myPoint</div>
<div class="line">            else</div>
<div class="line">                set myTransformedPoint to change coordinates myInnerTranslateMatrix point myPoint</div>
<div class="line">            end if</div>
<div class="line">            --Rotate the point.</div>
<div class="line">            set myTransformedPoint to change coordinates myRotateMatrix point myTransformedPoint</div>
<div class="line">            copy myTransformedPoint to the end of myPathPoints</div>
<div class="line">            set myRotateMatrix to rotate matrix myRotateMatrix by angle myAngle</div>
<div class="line">        end repeat</div>
<div class="line">        --Create a new polygon.</div>
<div class="line">        tell myParent</div>
<div class="line">            set myPolygon to make polygon</div>
<div class="line">        end tell</div>
<div class="line">        --Set the entire path of the polygon to the array we&#39;ve created.</div>
<div class="line">        set entire path of path 1 of myPolygon to myPathPoints</div>
<div class="line">        --If the center point is somewhere other than [0,0], translate the polygon to the center point.</div>
<div class="line">        if item 1 of myCenterPoint is not equal to 0 or item 2 of myCenterPoint is not equal to 0 then</div>
<div class="line">            set myTransformationMatrix to make transformation matrix with properties {horizontal translation:item 1 of myCenterPoint, vertical translation:item 2 of myCenterPoint}</div>
<div class="line">            transform myPolygon in pasteboard coordinates from {myCenterPoint, center anchor} with matrix myTransformationMatrix with considering ruler units</div>
<div class="line">        end <span class="keywordflow">if</span></div>
<div class="line">    end tell</div>
<div class="line">end myDrawPolygon</div>
<div class="line">--This <span class="keyword">function</span> returns <span class="keyword">true</span> <span class="keywordflow">if</span> myNumber is even, <span class="keyword">false</span> <span class="keywordflow">if</span> it is not.</div>
<div class="line">on myIsEven(myNumber)</div>
<div class="line">    set myResult to myNumber mod 2</div>
<div class="line">    if myResult = 0 then</div>
<div class="line">        set myResult to true</div>
<div class="line">    else</div>
<div class="line">        set myResult to false</div>
<div class="line">    end if</div>
<div class="line">    return myResult</div>
<div class="line">end myIsEven</div>
</div><!-- fragment --><p> You also can use the change coordinates method to change the positions of curve control points, as shown in the FunWithTransformations sample script.</p>
<h3><a class="anchor" id="id_as_transforming_again"></a>
Transforming again</h3>
<p>Just as you can apply a transformation or sequence of transformations again in the user interface, you can do so using scripting. There are four methods for applying transformations again:</p>
<ul>
<li>transform again</li>
<li>transform again individually</li>
<li>transform sequence again</li>
<li>transform sequence again individually</li>
</ul>
<p>The following script fragment shows how to use transform again. (For the complete script, see TransformAgain.) </p>
<div class="fragment"><div class="line">        --Given a rectangle on page 1...</div>
<div class="line">        <span class="keyword">set</span> myRectangle to rectangle 1 of myPage</div>
<div class="line">        <span class="keyword">set</span> myBounds to geometric bounds of myRectangle</div>
<div class="line">        <span class="keyword">set</span> myX1 to item 2 of myBounds</div>
<div class="line">        <span class="keyword">set</span> myY1 to item 1 of myBounds</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myRectangleA to make rectangle with properties {geometric bounds:{myY1 - 12, myX1 - 12, myY1 + 12, myX1 + 12}}</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myTransformationMatrix to make transformation matrix with properties {counterclockwise rotation angle:45}</div>
<div class="line">        transform myRectangleA in pasteboard coordinates from center anchor with matrix myTransformationMatrix</div>
<div class="line">        <span class="keyword">set</span> myRectangleB to duplicate myRectangleA</div>
<div class="line">        transform myRectangleB in pasteboard coordinates from {{0, 0}, top left anchor} with matrix myTransformationMatrix with considering ruler units</div>
<div class="line">        <span class="keyword">set</span> myRectangleC to duplicate myRectangleB</div>
<div class="line">        <span class="keyword">set</span> myResult to transform again myRectangleC</div>
<div class="line">        <span class="keyword">set</span> myRectangleD to duplicate myRectangleC</div>
<div class="line">        <span class="keyword">set</span> myResult to transform again myRectangleD</div>
<div class="line">        <span class="keyword">set</span> myRectangleE to duplicate myRectangleD</div>
<div class="line">        <span class="keyword">set</span> myResult to transform again myRectangleE</div>
<div class="line">        <span class="keyword">set</span> myRectangleF to duplicate myRectangleE</div>
<div class="line">        <span class="keyword">set</span> myResult to transform again myRectangleF</div>
<div class="line">        <span class="keyword">set</span> myRectangleG to duplicate myRectangleF</div>
<div class="line">        <span class="keyword">set</span> myResult to transform again myRectangleG</div>
<div class="line">        <span class="keyword">set</span> myRectangleH to duplicate myRectangleG</div>
<div class="line">        <span class="keyword">set</span> myResult to transform again myRectangleH</div>
<div class="line">        transform myRectangleB in pasteboard coordinates from center anchor with matrix myTransformationMatrix</div>
<div class="line">        <span class="keyword">set</span> myResult to transform again myRectangleD</div>
<div class="line">        <span class="keyword">set</span> myResult to transform again myRectangleF</div>
<div class="line">        <span class="keyword">set</span> myResult to transform again myRectangleH</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_resize_and_reframe"></a>
Resize and Reframe</h2>
<p>In addition to scaling page items using the transform command, you can also change the size of the shape using two other commands: resize and reframe. These commands change the location of the path points of the page item without scaling the content or stroke weight of the page item. The following script fragment shows how to use the resize command. For the complete script, see Resize. </p>
<div class="fragment"><div class="line">        --Given a reference to a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span>...</div>
<div class="line">        <span class="keyword">set</span> myDuplicate to duplicate myRectangle</div>
<div class="line">        resize myDuplicate in inner coordinates from center anchor by multiplying current dimensions by values {2, 2}</div>
</div><!-- fragment --><p> The following script fragment shows how to use the reframe command. For the complete script, see Reframe. </p>
<div class="fragment"><div class="line">        --Given a reference to a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span>...</div>
<div class="line">        <span class="keyword">set</span> myDuplicate to duplicate myRectangle</div>
<div class="line">        resolve myDuplicate location top left anchor in inner coordinates without considering ruler units</div>
<div class="line">        <span class="keyword">set</span> myTopLeft to item 1 of the result</div>
<div class="line">        resolve myDuplicate location bottom right anchor in inner coordinates without considering ruler units</div>
<div class="line">        <span class="keyword">set</span> myBottomRight to item 1 of the result</div>
<div class="line">        <span class="keyword">set</span> myWidth to (item 1 of myBottomRight) - (item 1 of myTopLeft)</div>
<div class="line">        tell myDuplicate</div>
<div class="line">            reframe in inner coordinates opposing corners {{(item 1 of myTopLeft) + myWidth, item 2 of myTopLeft}, {(item 1 of myBottomRight) + myWidth, item 2 of myBottomRight}}</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_working_with_articles"></a>
Working with Articles</h2>
<p>Articles provide designers and production artists an easy way to create relationships among page items. These relationships can be used to define the content to be used while exporting to ePub, HTML or Accessible PDFs; and to define the order of the content. You can create articles from a combination of existing page items within a layout, including images, graphics, or text. Once an article has been created, page items can be added, removed, or re-ordered.</p>
<h3><a class="anchor" id="id_as_retrieving_an_article_list"></a>
Retrieving an article list</h3>
<p>To get the articles in a document, use the following script (for the complete script, see CreateArticle). </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myArticles to articles of myDocument</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_adding_new_articles"></a>
Adding new articles</h3>
<p>To add a new article to a document, use the following script (for the complete script, see CreateArticle). </p>
<div class="fragment"><div class="line">            <span class="keyword">set</span> newArticle1 to make article with properties {name:<span class="stringliteral">&quot;Article1&quot;</span>, article export status:<span class="keyword">true</span>}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_removing_an_article"></a>
Removing an article</h3>
<p>To remove an article, tell the article to remove itself as shown in the following script (for the complete script, see RemoveArticle). </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        tell article 1 of myDocument to <span class="keyword">delete</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_reordering_articles"></a>
Reordering articles</h3>
<p>To reorder articles, tell the article to move the reference article and the location relative to the reference article as shown in the following script (for the complete script, see ReorderArticles). </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> article1 to make article with properties {name:<span class="stringliteral">&quot;Article1&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> article2 to make article with properties {name:<span class="stringliteral">&quot;Article2&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> article3 to make article with properties {name:<span class="stringliteral">&quot;Article3&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> article4 to make article with properties {name:<span class="stringliteral">&quot;Article4&quot;</span>}</div>
<div class="line">            </div>
<div class="line">            move article4 to beginning of article 0</div>
<div class="line">            move article1 to end of article 0</div>
<div class="line">            move article3 to after article4</div>
<div class="line">            move article2 to before article1</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_adding_new_members_to_an_article"></a>
Adding new members to an article</h3>
<p>To add new members to an article, use the following script (for the complete script, see AddRemoveArticleMember). </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> article1 to make article with properties {name:<span class="stringliteral">&quot;Article1&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> article2 to make article with properties {name:<span class="stringliteral">&quot;Article2&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> article3 to make article with properties {name:<span class="stringliteral">&quot;Article3&quot;</span>}</div>
<div class="line">            </div>
<div class="line">            <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">            --<span class="keyword">set</span> article4 to make article with properties {article member:{rectangle 1 of myPage, oval 1 of myPage}}</div>
<div class="line">            </div>
<div class="line">            --add rectangle 1 of myPage to article1</div>
<div class="line">            tell article1</div>
<div class="line">                make article member with properties {item ref:rectangle 1 of myPage}</div>
<div class="line">                make article member with properties {item ref:oval 1 of myPage}</div>
<div class="line">            end tell</div>
<div class="line">            </div>
<div class="line">            tell article2</div>
<div class="line">                make article member with properties {item ref:rectangle 2 of myPage}</div>
<div class="line">                make article member with properties {item ref:oval 2 of myPage}</div>
<div class="line">            end tell</div>
<div class="line">            </div>
<div class="line">            tell article3</div>
<div class="line">                make article member with properties {item ref:group 1 of myPage}</div>
<div class="line">            end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_reordering_members_of_an_article"></a>
Reordering members of an article</h3>
<p>To reorder members of an article, tell the member to move the reference object and the location relative to the reference object as shown in the following script (for the complete script, see ReorderArticleMembers). </p>
<div class="fragment"><div class="line">                make article member with properties {item ref:rectangle 1 of myPage}</div>
<div class="line">                make article member with properties {item ref:oval 1 of myPage}</div>
<div class="line">                make article member with properties {item ref:text frame 1 of myPage}</div>
<div class="line">                make article member with properties {item ref:group 1 of myPage}</div>
<div class="line">                </div>
<div class="line">                move article member 1 to end of article member 0</div>
<div class="line">                move article member 3 to beginning of article member 0</div>
<div class="line">                move article member 2 to after article member 3</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_removing_members_from_an_article"></a>
Removing members from an article</h3>
<p>To remove a member from an article, tell the article member to remove itself, as shown in the following script (for the complete script, see AddRemoveArticleMember). </p>
<div class="fragment"><div class="line">            tell article member 1 of article1 to <span class="keyword">delete</span></div>
</div><!-- fragment --> <h1><a class="anchor" id="id_as_user_interfaces"></a>
User Interfaces</h1>
<p>JavaScript can create dialogs for simple yes/no questions and text entry, but you probably will need to create more complex dialogs for your scripts. InDesign scripting can add dialogs and populate them with common user-interface controls, like pop-up lists, text-entry fields, and numeric-entry fields. If you want your script to collect and act on information entered by you or any other user of your script, use the dialog object.</p>
<p>This section shows how to work with InDesign dialog scripting. The sample scripts in this chapter are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<dl class="section note"><dt>Note</dt><dd>InDesign scripts written in JavaScript also can include user interfaces created using the Adobe ScriptUI component. This section includes some ScriptUI scripting tutorials; for more information, see Adobe JavaScript Tools Guide.</dd></dl>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create and run a script.</p>
<h2><a class="anchor" id="id_as_dialog_overview"></a>
Dialog Overview</h2>
<p>An InDesign dialog box is an object like any other InDesign scripting object. The dialog box can contain several different types of elements (known collectively as "widgets"), as shown in the following figure. The elements of the figure are described in the table following the figure.</p>
<div class="image">
<img src="InDesign_ScriptingGuide-5.gif" alt="InDesign_ScriptingGuide-5.gif"/>
</div>
<table class="doxtable">
<tr>
<th>Dialog box element </th><th>InDesign name </th></tr>
<tr>
<td>Text-edit fields </td><td>Text editbox control </td></tr>
<tr>
<td>Numeric-entry fields </td><td>Real editbox, integer editbox, measurement editbox, percent editbox, angle editbox </td></tr>
<tr>
<td>Pop-up menus </td><td>Drop-down control </td></tr>
<tr>
<td>Control that combines a text-edit field with a pop-up menu </td><td>Combo-box control </td></tr>
<tr>
<td>Check box </td><td>Check-box control </td></tr>
<tr>
<td>Radio buttons </td><td>Radio-button control </td></tr>
</table>
<p>The dialog object itself does not directly contain the controls; that is the purpose of the dialogColumn object. dialogColumns give you a way to control the positioning of controls within a dialog box. Inside dialogColumns, you can further subdivide the dialog box into other dialogColumns or borderPanels (both of which can, if necessary, contain more dialogColumns and borderPanels).</p>
<p>Like any other InDesign scripting object, each part of a dialog box has its own properties. A checkboxControl, for example, has a property for its text (staticLabel) and another property for its state (checkedState). The dropdown control has a property (stringList) for setting the list of options that appears on the control's menu.</p>
<p>To use a dialog box in your script, create the dialog object, populate it with various controls, display the dialog box, and then gather values from the dialog-box controls to use in your script. Dialog boxes remain in InDesign's memory until they are destroyed. This means you can keep a dialog box in memory and have data stored in its properties used by multiple scripts, but it also means the dialog boxes take up memory and should be disposed of when they are not in use. In general, you should destroy a dialog-box object before your script finishes executing.</p>
<h2><a class="anchor" id="id_as_your_first_indesign_dialog"></a>
Your First InDesign Dialog</h2>
<p>The process of creating an InDesign dialog is very simple: add a dialog, add a dialog column to the dialog, and add controls to the dialog column. The following script demonstrates the process (for the complete script, see SimpleDialog): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDialog to make dialog with properties {name:<span class="stringliteral">&quot;Simple Dialog&quot;</span>}</div>
<div class="line">        tell myDialog</div>
<div class="line">            tell (make dialog column)</div>
<div class="line">                make <span class="keyword">static</span> text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;This is a very simple dialog box.&quot;</span>}</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">        --Show the dialog box.</div>
<div class="line">        <span class="keyword">set</span> myResult to show myDialog</div>
<div class="line">        --If the user clicked OK, display one message;</div>
<div class="line">        --<span class="keywordflow">if</span> they clicked Cancel, display a different message.</div>
<div class="line">        <span class="keywordflow">if</span> myResult is <span class="keyword">true</span> then</div>
<div class="line">            display dialog (<span class="stringliteral">&quot;You clicked the OK button&quot;</span>)</div>
<div class="line">        else</div>
<div class="line">            display dialog (&quot;You clicked the Cancel button&quot;)</div>
<div class="line">        end if</div>
<div class="line">        --Remove the dialog box from memory.</div>
<div class="line">        destroy myDialog</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_adding_a_user_interface_to__as_hello_world"></a>
Adding a User Interface to "Hello World"</h2>
<p>In this example, we add a simple user interface to the Hello World tutorial script presented in <a class="el" href="id_scripting_tutorial.html">Adobe InDesign Scripting Tutorial</a>. The options in the dialog box provide a way for you to specify the sample text and change the point size of the text: </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDialog to make dialog</div>
<div class="line">        tell myDialog</div>
<div class="line">            <span class="keyword">set</span> name to <span class="stringliteral">&quot;Simple User Interface Example Script&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myDialogColumn to make dialog column</div>
<div class="line">            tell myDialogColumn</div>
<div class="line">                --Create a text entry field.</div>
<div class="line">                <span class="keyword">set</span> myTextEditField to make text editbox with properties {edit contents:<span class="stringliteral">&quot;Hello World!&quot;</span>, min width:180}</div>
<div class="line">                --Create a number (real) entry field</div>
<div class="line">                set myPointSizeField to make measurement editbox with properties {edit value:72, edit units:points}</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myResult to show myDialog</div>
<div class="line">        <span class="keywordflow">if</span> myResult is <span class="keyword">true</span> then</div>
<div class="line">            --Get the settings from the dialog box.</div>
<div class="line">            --Get the point size from the point size field.</div>
<div class="line">            <span class="keyword">set</span> myPointSize to edit value of myPointSizeField</div>
<div class="line">            --Get the example text from the text edit field.</div>
<div class="line">            <span class="keyword">set</span> myString to edit contents of myTextEditField</div>
<div class="line">            --Remove the dialog box from memory.</div>
<div class="line">            destroy myDialog</div>
<div class="line">            my myMakeDocument(myPointSize, myString)</div>
<div class="line">        else</div>
<div class="line">            destroy myDialog</div>
<div class="line">        end if</div>
</div><!-- fragment --><p> Here is the myMakeDocument function referred to in the above fragment: </p>
<div class="fragment"><div class="line">on myMakeDocument(myPointSize, myString)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myDocument to make document</div>
<div class="line">        tell view preferences of myDocument</div>
<div class="line">        end tell</div>
<div class="line">        tell page 1 of myDocument</div>
<div class="line">            --Create a text frame.</div>
<div class="line">            set myTextFrame to make text frame</div>
<div class="line">            set geometric bounds of myTextFrame to my myGetBounds(myDocument, page 1 of myDocument)</div>
<div class="line">            --Apply the settings from the dialog box to the text frame.</div>
<div class="line">            set contents of myTextFrame to myString</div>
<div class="line">            --Set the point size of the text in the text frame.</div>
<div class="line">            set point size of text 1 of myTextFrame to myPointSize</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">end myMakeDocument</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_creating_a_more_complex_user_interface"></a>
Creating a More Complex User Interface</h2>
<p>In the next example, we add more controls and different types of controls to the sample dialog box. The example creates a dialog box that resembles the following:</p>
<div class="image">
<img src="InDesign_ScriptingGuide-6.gif" alt="InDesign_ScriptingGuide-6.gif"/>
</div>
<p>For the complete script, see ComplexUI. </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDialog to make dialog</div>
<div class="line">        --This example dialog box uses border panels and dialog columns to</div>
<div class="line">        --separate and organize the user <span class="keyword">interface </span>items in the dialog.</div>
<div class="line">        tell myDialog</div>
<div class="line">            set name to &quot;User Interface Example Script&quot;</div>
<div class="line">            set myDialogColumn to make dialog column</div>
<div class="line">            tell myDialogColumn</div>
<div class="line">                set myBorderPanel to make border panel</div>
<div class="line">                tell myBorderPanel</div>
<div class="line">                    set myDialogColumn to make dialog column</div>
<div class="line">                    tell myDialogColumn</div>
<div class="line">                        make static text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Message:&quot;</span>}</div>
<div class="line">                    end tell</div>
<div class="line">                    <span class="keyword">set</span> myDialogColumn to make dialog column</div>
<div class="line">                    tell myDialogColumn</div>
<div class="line">                        <span class="keyword">set</span> myTextEditField to make text editbox with properties {edit contents:<span class="stringliteral">&quot;Hello World!&quot;</span>, min width:180}</div>
<div class="line">                    end tell</div>
<div class="line">                end tell</div>
<div class="line">                <span class="keyword">set</span> myBorderPanel to make border panel</div>
<div class="line">                tell myBorderPanel</div>
<div class="line">                    <span class="keyword">set</span> myDialogColumn to make dialog column</div>
<div class="line">                    tell myDialogColumn</div>
<div class="line">                        make <span class="keyword">static</span> text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Point Size:&quot;</span>}</div>
<div class="line">                    end tell</div>
<div class="line">                    <span class="keyword">set</span> myDialogColumn to make dialog column</div>
<div class="line">                    tell myDialogColumn</div>
<div class="line">                        <span class="keyword">set</span> myPointSizeField to make measurement editbox with properties {edit value:72, edit units:points}</div>
<div class="line">                    end tell</div>
<div class="line">                end tell</div>
<div class="line">                <span class="keyword">set</span> myBorderPanel to make border panel</div>
<div class="line">                tell myBorderPanel</div>
<div class="line">                    <span class="keyword">set</span> myDialogColumn to make dialog column</div>
<div class="line">                    tell myDialogColumn</div>
<div class="line">                        make <span class="keyword">static</span> text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Vertical Justification:&quot;</span>}</div>
<div class="line">                    end tell</div>
<div class="line">                    <span class="keyword">set</span> myDialogColumn to make dialog column</div>
<div class="line">                    tell myDialogColumn</div>
<div class="line">                        <span class="keyword">set</span> myVerticalJustificationMenu to make dropdown with properties {<span class="keywordtype">string</span> list:{<span class="stringliteral">&quot;Top&quot;</span>, <span class="stringliteral">&quot;Center&quot;</span>, <span class="stringliteral">&quot;Bottom&quot;</span>}, selected index:0}</div>
<div class="line">                    end tell</div>
<div class="line">                end tell</div>
<div class="line">                <span class="keyword">set</span> myBorderPanel to make border panel</div>
<div class="line">                tell myBorderPanel</div>
<div class="line">                    make <span class="keyword">static</span> text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Paragraph Alignment:&quot;</span>}</div>
<div class="line">                    <span class="keyword">set</span> myParagraphAlignmentGroup to make radiobutton group</div>
<div class="line">                    tell myParagraphAlignmentGroup</div>
<div class="line">                        <span class="keyword">set</span> myLeftRadioButton to make radiobutton control with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Left&quot;</span>, checked state:<span class="keyword">true</span>}</div>
<div class="line">                        <span class="keyword">set</span> myCenterRadioButton to make radiobutton control with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Center&quot;</span>}</div>
<div class="line">                        <span class="keyword">set</span> myRightRadioButton to make radiobutton control with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Right&quot;</span>}</div>
<div class="line">                    end tell</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myResult to show myDialog</div>
<div class="line">        <span class="keywordflow">if</span> myResult is <span class="keyword">true</span> then</div>
<div class="line">            --Get the settings from the dialog box.</div>
<div class="line">            --Get the point size from the point size field.</div>
<div class="line">            <span class="keyword">set</span> myPointSize to edit value of myPointSizeField</div>
<div class="line">            --Get the example text from the text edit field.</div>
<div class="line">            <span class="keyword">set</span> myString to edit contents of myTextEditField</div>
<div class="line">            --Get the vertical justification setting from the pop-up menu.</div>
<div class="line">            <span class="keywordflow">if</span> selected index of myVerticalJustificationMenu is 0 then</div>
<div class="line">                <span class="keyword">set</span> myVerticalJustification to top align</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> selected index of myVerticalJustificationMenu is 1 then</div>
<div class="line">                <span class="keyword">set</span> myVerticalJustification to center align</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                <span class="keyword">set</span> myVerticalJustification to bottom align</div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">            --Get the paragraph alignment setting from the radiobutton group.</div>
<div class="line">            <span class="keyword">get</span> properties of myParagraphAlignmentGroup</div>
<div class="line">            <span class="keywordflow">if</span> selected button of myParagraphAlignmentGroup is 0 then</div>
<div class="line">                <span class="keyword">set</span> myParagraphAlignment to left align</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> selected button of myParagraphAlignmentGroup is 1 then</div>
<div class="line">                <span class="keyword">set</span> myParagraphAlignment to center align</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                <span class="keyword">set</span> myParagraphAlignment to right align</div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">            --Remove the dialog box from memory.</div>
<div class="line">            destroy myDialog</div>
<div class="line">            my myMakeDocument(myPointSize, myString, myParagraphAlignment, myVerticalJustification)</div>
<div class="line">        else</div>
<div class="line">            destroy myDialog</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> Here is the myMakeDocument function referred to in the above fragment: </p>
<div class="fragment"><div class="line">on myMakeDocument(myPointSize, myString, myParagraphAlignment, myVerticalJustification)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myDocument to make document</div>
<div class="line">        tell view preferences of myDocument</div>
<div class="line">        end tell</div>
<div class="line">        set myPage to page 1 of myDocument</div>
<div class="line">        tell myPage</div>
<div class="line">            set myTextFrame to make text frame</div>
<div class="line">            set geometric bounds of myTextFrame to my myGetBounds(myDocument, myPage)</div>
<div class="line">            --Apply the settings from the dialog box to the text frame.</div>
<div class="line">            set contents of myTextFrame to myString</div>
<div class="line">            --Apply the vertical justification setting.</div>
<div class="line">            set vertical justification of text frame preferences of myTextFrame to myVerticalJustification</div>
<div class="line">            --Apply the paragraph alignment (&quot;justification&quot;).</div>
<div class="line">            --&quot;text 1 of myTextFrame&quot; is all of the text in the text frame.</div>
<div class="line">            set justification of text 1 of myTextFrame to myParagraphAlignment</div>
<div class="line">            --Set the point size of the text in the text frame.</div>
<div class="line">            set point size of text 1 of myTextFrame to myPointSize</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">end myMakeDocument</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_working_with_scriptui"></a>
Working with ScriptUI</h2>
<p>JavaScripts can create and define user-interface elements using an Adobe scripting component named ScriptUI. ScriptUI gives scripters a way to create floating palettes, progress bars, and interactive dialog boxes that are far more complex than InDesign's built-in dialog object.</p>
<p>This does not mean, however, that user-interface elements written using Script UI are not accessible to JavaScript users. InDesign scripts can execute scripts written in other scripting languages using the DoScript method.</p>
<h3><a class="anchor" id="id_as_creating_a_progress_bar_with_scriptui"></a>
Creating a progress bar with ScriptUI</h3>
<p>The following sample script shows how to create a progress bar using JavaScript and ScriptUI, then use the progress bar from another script (for the complete script, see ProgressBar): </p>
<div class="fragment"><div class="line"><span class="preprocessor">#targetengine &quot;session&quot;</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">//Because these terms are defined in the &quot;session&quot; engine,</span></div>
<div class="line"><span class="comment">//they will be available to any other JavaScript running</span></div>
<div class="line"><span class="comment">//in that instance of the engine.</span></div>
<div class="line">var myMaximumValue = 300;</div>
<div class="line">var myProgressBarWidth = 300;</div>
<div class="line">var myIncrement = myMaximumValue/myProgressBarWidth;</div>
<div class="line">myCreateProgressPanel(myMaximumValue, myProgressBarWidth);</div>
<div class="line"><span class="keyword">function</span> myCreateProgressPanel(myMaximumValue, myProgressBarWidth){</div>
<div class="line">    myProgressPanel = <span class="keyword">new</span> Window(<span class="stringliteral">&#39;window&#39;</span>, <span class="stringliteral">&#39;Progress&#39;</span>);</div>
<div class="line">    with(myProgressPanel){</div>
<div class="line">        myProgressPanel.myProgressBar = add(<span class="stringliteral">&#39;progressbar&#39;</span>, [12, 12,</div>
<div class="line">    myProgressBarWidth, 24], 0, myMaximumValue);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The following script fragment shows how to call the progress bar created in the above script using a separate JavaScript (for the complete script, see CallProgressBar): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to make document</div>
<div class="line">        --Add pages to the active document.</div>
<div class="line">        --If you don<span class="stringliteral">&#39;t do this, the progress bar will</span></div>
<div class="line"><span class="stringliteral">        --go by too quickly.</span></div>
<div class="line"><span class="stringliteral">        --Note that the JavaScripts must use the &quot;session&quot;</span></div>
<div class="line"><span class="stringliteral">        --engine for this to work.</span></div>
<div class="line"><span class="stringliteral">        set myJavaScript to &quot;#targetengine \&quot;session\&quot;&quot; &amp; return</span></div>
<div class="line"><span class="stringliteral">        set myJavaScript to myJavaScript &amp; &quot;myCreateProgressPanel(100, 400);&quot; &amp; return</span></div>
<div class="line"><span class="stringliteral">        set myJavaScript to myJavaScript &amp; &quot;myProgressPanel.show();&quot; &amp; return</span></div>
<div class="line"><span class="stringliteral">        do script myJavaScript language javascript</span></div>
<div class="line"><span class="stringliteral">        repeat with myCounter from 1 to 40</span></div>
<div class="line"><span class="stringliteral">            set myJavaScript to &quot;#targetengine \&quot;session\&quot;&quot; &amp; return</span></div>
<div class="line"><span class="stringliteral">            set myJavaScript to myJavaScript &amp; &quot;myProgressPanel.myProgressBar.value = &quot;</span></div>
<div class="line"><span class="stringliteral">            set myJavaScript to myJavaScript &amp; myCounter &amp; &quot;/myIncrement;&quot; &amp; return</span></div>
<div class="line"><span class="stringliteral">            do script myJavaScript language javascript</span></div>
<div class="line"><span class="stringliteral">            tell myDocument to make page</span></div>
<div class="line"><span class="stringliteral">            if myCounter = 100 then</span></div>
<div class="line"><span class="stringliteral">                set myJavaScript to &quot;#targetengine \&quot;session\&quot;&quot; &amp; return</span></div>
<div class="line"><span class="stringliteral">                set myJavaScript to myJavaScript &amp; &quot;myProgressPanel.myProgressBar.value = 0;&quot; &amp; return</span></div>
<div class="line"><span class="stringliteral">                set myJavaScript to myJavaScript &amp; &quot;myProgressPanel.hide();&quot; &amp; return</span></div>
<div class="line"><span class="stringliteral">                do script myJavaScript language javascript</span></div>
<div class="line"><span class="stringliteral">                close myDocument saving no</span></div>
<div class="line"><span class="stringliteral">            end if</span></div>
<div class="line"><span class="stringliteral">        end repeat</span></div>
</div><!-- fragment --> <h1><a class="anchor" id="id_as_events"></a>
Events</h1>
<p>InDesign scripting can respond to common application and document events, such as opening a file, creating a new file, printing, and importing text and graphic files from disk. In InDesign scripting, the event object responds to an event that occurs in the application. Scripts can be attached to events using the event listener scripting object. Scripts that use events are the same as other scripts -the only difference is that they run automatically when the corresponding event occurs, rather than being run by the user (from the Scripts palette).</p>
<p>This section shows how to work with InDesign event scripting. The sample scripts in this chapter are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script.</p>
<p>For a discussion of events related to menus, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_menus">Menus.</a></p>
<p>The InDesign event scripting model is similar to the Worldwide Web Consortium (W3C) recommendation for Document Object Model Events. For more information, see <a href="http://www.w3c.org">http://www.w3c.org </a>.</p>
<h2><a class="anchor" id="id_as_understanding_the_event_scripting_model"></a>
Understanding the Event Scripting Model</h2>
<p>The InDesign event scripting model consists of a series of objects that correspond to the events that occur as you work with the application. The first object is the event, which corresponds to one of a limited series of actions in the InDesign user interface (or corresponding actions triggered by scripts).</p>
<p>To respond to an event, you register an event listener with an object capable of receiving the event. When the specified event reaches the object, the event listener executes the script function defined in its handler function (a reference to a script file on disk).</p>
<p>You can view the available events using the AppleScript Dictionary Viewer. In the AppleScript Dictionary viewer in your AppleScript editor, look at the event class in the Basics Suite.</p>
<h3><a class="anchor" id="id_as_about_event_properties_and_event_propagation"></a>
About event properties and event propagation</h3>
<p>When an action-whether initiated by a user or by a script-triggers an event, the event can spread, or propagate, through the scripting objects capable of responding to the event. When an event reaches an object that has an event listener registered for that event, the event listener is triggered by the event. An event can be handled by more than one object as it propagates.</p>
<p>There are two types of event propagation:</p>
<ul>
<li>None- Only the event listeners registered to the event target are triggered by the event. The beforeDisplay event is an example of an event that does not propagate.</li>
<li>Bubbling - The event starts propagation at its target and triggers any qualifying event listeners registered to the target. The event then proceeds upward through the scripting object model, triggering any qualifying event listeners registered to objects above the target in the scripting object model hierarchy.</li>
</ul>
<p>The following table provides more detail on the properties of an event and the ways in which they relate to event propagation through the scripting object model.</p>
<table class="doxtable">
<tr>
<th>Property </th><th>Description </th></tr>
<tr>
<td>Bubbles </td><td>If true, the event propagates to scripting objects above the object initiating the event. </td></tr>
<tr>
<td>Cancelable </td><td>If true, the default behavior of the event on its target can be canceled. To do this, use the PreventDefault method . </td></tr>
<tr>
<td>CurrentTarget </td><td>The current scripting object processing the event. See target in this table. </td></tr>
<tr>
<td>DefaultPrevented </td><td>If true, the default behavior of the event on the current target was prevented, thereby canceling the action. See target in this table. </td></tr>
<tr>
<td>EventPhase </td><td>The current stage of the event propagation process. </td></tr>
<tr>
<td>EventType </td><td>The type of the event, as a string (for example, "beforeNew"). </td></tr>
<tr>
<td>PropagationStopped </td><td>If true, the event has stopped propagating beyond the current target (see target in this table). To stop event propagation, use the stopPropagation method. </td></tr>
<tr>
<td>Target </td><td>The object from which the event originates. For example, the target of a beforeImport event is a document; of a beforeNew event, the application. </td></tr>
<tr>
<td>TimeStamp </td><td>The time and date when the event occurred. </td></tr>
</table>
<h2><a class="anchor" id="id_as_working_with_event_listeners"></a>
Working with Event Listeners</h2>
<p>When you create an event listener, you specify the event type and the event handler (as a handler or file reference). The following script fragment shows how to add an event listener for a specific event (for the complete script, see AddEventListener). </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myEventListener to make <span class="keyword">event</span> listener with properties {<span class="keyword">event</span> type:<span class="stringliteral">&quot;afterNew&quot;</span>, handler:my myMessage}</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> The preceding script fragment refers to the following handler: </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        --<span class="stringliteral">&quot;evt&quot;</span> is the <span class="keyword">event</span> passed to <span class="keyword">this</span> script by the <span class="keyword">event</span> listener.</div>
<div class="line">        display dialog <span class="stringliteral">&quot;This event is the &quot;</span> &amp; <span class="keyword">event</span> type of evt &amp; <span class="stringliteral">&quot; event.&quot;</span></div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> When you use an event handler defined in the script, rather than an event handler defined in a separate script file, the script will work correctly when run from the InDesign Scripts panel, but will not work when you run it from a script editing application (such as the AppleScript Editor).</p>
<p>To remove the event listener created by the preceding script, run the following script (from the RemoveEventListener tutorial script): </p>
<div class="fragment"><div class="line">        --You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">        remove event listener event type &quot;afterNew&quot; handler myMessage</span></div>
</div><!-- fragment --><p> When an event listener responds to an event, the event may still be processed by other event listeners that might be monitoring the event (depending on the propagation of the event). For example, thea fterOpen event can be observed by event listeners associated with both the application and the document. event listeners do not persist beyond the current InDesign session. To make an event listener available in every InDesign session, add the script to the startup scripts folder. (For more on installing scripts, see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing Scripts</a> in Adobe InDesign Scripting Tutorial.) When you add an event listener script to a document, it is not saved with the document or exported to IDML.</p>
<dl class="section note"><dt>Note</dt><dd>If you are having trouble with a script that defines an event listener, you can either run a script that removes the event listener or quit and restart InDesign. An event can trigger multiple event listeners as it propagates through the scripting object model. The following sample script demonstrates an event triggering event listeners registered to different objects (for the full script, see MultipleEventListeners): <div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to make document</div>
<div class="line">        --You<span class="stringliteral">&#39;ll have to fill in a valid file path for your system</span></div>
<div class="line"><span class="stringliteral">        make event listener with properties {event type:&quot;beforeImport&quot;, handler:my myEventInfoHandler}</span></div>
<div class="line"><span class="stringliteral">        tell myDocument</span></div>
<div class="line"><span class="stringliteral">            make event listener with properties {event type:&quot;beforeImport&quot;, handler:my myEventInfoHandler}</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --> The handler referred to in the preceding script fragment contains the following: <div class="fragment"><div class="line">on myEventInfoHandler()</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myString to &quot;Current Target: &quot; &amp; name of (current target of evt) &amp; return</div>
<div class="line">        display dialog (myString)</div>
<div class="line">    end tell</div>
<div class="line">end myEventInfoHandler</div>
</div><!-- fragment --> When you run the preceding script and place a file, InDesign displays alerts showing, in sequence, the name of the document, then the name of the application. To remove the event listeners added by the preceding script, run the RemoveMultipleEventListeners script.</dd></dl>
<p>The following sample script creates an event listener for each document event and displays information about the event in a simple dialog box. For the complete script, see EventListenersOn. </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myEventNames to {<span class="stringliteral">&quot;beforeNew&quot;</span>, <span class="stringliteral">&quot;afterNew&quot;</span>, <span class="stringliteral">&quot;beforeQuit&quot;</span>, <span class="stringliteral">&quot;afterQuit&quot;</span>, <span class="stringliteral">&quot;beforeOpen&quot;</span>, <span class="stringliteral">&quot;afterOpen&quot;</span>, <span class="stringliteral">&quot;beforeClose&quot;</span>, <span class="stringliteral">&quot;afterClose&quot;</span>, <span class="stringliteral">&quot;beforeSave&quot;</span>, <span class="stringliteral">&quot;afterSave&quot;</span>, <span class="stringliteral">&quot;beforeSaveAs&quot;</span>, <span class="stringliteral">&quot;afterSaveAs&quot;</span>, <span class="stringliteral">&quot;beforeSaveACopy&quot;</span>, <span class="stringliteral">&quot;afterSaveACopy&quot;</span>, <span class="stringliteral">&quot;beforeRevert&quot;</span>, <span class="stringliteral">&quot;afterRevert&quot;</span>, <span class="stringliteral">&quot;beforePrint&quot;</span>, <span class="stringliteral">&quot;afterPrint&quot;</span>, <span class="stringliteral">&quot;beforeExport&quot;</span>, <span class="stringliteral">&quot;afterExport&quot;</span>, <span class="stringliteral">&quot;beforeImport&quot;</span>, <span class="stringliteral">&quot;afterImport&quot;</span>, <span class="stringliteral">&quot;beforePlace&quot;</span>, <span class="stringliteral">&quot;afterPlace&quot;</span>}</div>
<div class="line">        repeat with myEventName in myEventNames</div>
<div class="line">            make <span class="keyword">event</span> listener with properties {<span class="keyword">event</span> type:myEventName, handler:<span class="stringliteral">&quot;yukino:scripts:GetEventInfo.applescript&quot;</span>}</div>
<div class="line">        end repeat</div>
</div><!-- fragment --><p> The preceding script refers to the following script. The file reference in the preceding script must match the location of this script on your disk. For the complete script, see GetEventInfo.applescript. </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myString to <span class="stringliteral">&quot;Handling Event: &quot;</span> &amp; (<span class="keyword">event</span> type of myEvent) &amp; <span class="keywordflow">return</span> &amp; <span class="keywordflow">return</span></div>
<div class="line">        --Have to handle the target as a special <span class="keywordflow">case</span> when it<span class="stringliteral">&#39;s a document.</span></div>
<div class="line"><span class="stringliteral">        if class of target of myEvent is document then</span></div>
<div class="line"><span class="stringliteral">            set myString to myString &amp; &quot;Target: Document &quot; &amp; name of target of myEvent &amp; return</span></div>
<div class="line"><span class="stringliteral">        else</span></div>
<div class="line"><span class="stringliteral">            set myString to myString &amp; &quot;Target: &quot; &amp; (target of myEvent) &amp; &quot; &quot; &amp; name of (target of myEvent) &amp; return</span></div>
<div class="line"><span class="stringliteral">        end if</span></div>
<div class="line"><span class="stringliteral">        set myString to myString &amp; &quot;Current: &quot; &amp; ((current target of myEvent) as string) &amp; &quot; &quot; &amp; name of current target of myEvent &amp; return &amp; return</span></div>
<div class="line"><span class="stringliteral">        set myString to myString &amp; &quot;Phase: &quot; &amp; my myGetPhaseName(event phase of myEvent) &amp; return</span></div>
<div class="line"><span class="stringliteral">        set myString to myString &amp; &quot;Bubbles: &quot; &amp; bubbles of myEvent &amp; return</span></div>
<div class="line"><span class="stringliteral">        set myString to myString &amp; &quot;Cancelable: &quot; &amp; cancelable of myEvent &amp; return</span></div>
<div class="line"><span class="stringliteral">        set myString to myString &amp; &quot;Stopped: &quot; &amp; propagation stopped of myEvent &amp; return</span></div>
<div class="line"><span class="stringliteral">        set myString to myString &amp; &quot;Canceled: &quot; &amp; default prevented of myEvent &amp; return</span></div>
<div class="line"><span class="stringliteral">        set myString to myString &amp; &quot;Time: &quot; &amp; time stamp of myEvent &amp; return</span></div>
<div class="line"><span class="stringliteral">        display dialog myString with title &quot;Event Details&quot;</span></div>
<div class="line"><span class="stringliteral">    end tell</span></div>
</div><!-- fragment --><div class="fragment"><div class="line">on myGetPhaseName(myEventPhase)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        if myEventPhase is at target then</div>
<div class="line">            set myPhaseName to &quot;At Target&quot;</div>
<div class="line">        else if myEventPhase is bubbling phase then</div>
<div class="line">            set myPhaseName to &quot;Bubbling&quot;</div>
<div class="line">        else if myEventPhase is done then</div>
<div class="line">            set myPhaseName to &quot;Done&quot;</div>
<div class="line">            --Can&#39;t use &quot;not dispatching&quot; as an enum</div>
<div class="line">        else</div>
<div class="line">            set myPhaseName to &quot;Not Dispatching&quot;</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
<div class="line">    return myPhaseName</div>
<div class="line">end myGetPhaseName</div>
</div><!-- fragment --><p> The following sample script shows how to turn off all event listeners on the application object. For the complete script, see EventListenersOff. </p>
<div class="fragment"><div class="line">        repeat with myCounter from 1 to (count event listeners)</div>
<div class="line">            <span class="keyword">delete</span> <span class="keyword">event</span> listener 1</div>
<div class="line">        end repeat</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_sample_afternew_event_listener"></a>
Sample afterNew Event Listener</h2>
<p>The afterNew event provides a convenient place to add information to the document, such as the user name, the date the document was created, copyright information, and other job-tracking information. The following tutorial script shows how to add this kind of information to a text frame in the slug area of the first master spread in the document (for the complete script, see AfterNew). This script also adds document metadata (also known as file info or XMP information). </p>
<div class="fragment"><div class="line">        make <span class="keyword">event</span> listener with properties {<span class="keyword">event</span> type:<span class="stringliteral">&quot;afterNew&quot;</span>, handler:my myAfterNewHandler}</div>
</div><!-- fragment --><div class="fragment"><div class="line">--Registers an <span class="keyword">event</span> listener on the afterNew <span class="keyword">event</span>.</div>
<div class="line">tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">    make <span class="keyword">event</span> listener with properties {<span class="keyword">event</span> type:<span class="stringliteral">&quot;afterNew&quot;</span>, handler:<span class="stringliteral">&quot;yukino:IDEventHandlers:AfterNewHandler.applescript&quot;</span>}</div>
<div class="line">end tell</div>
</div><!-- fragment --><p>The preceding script refers to the following script. The file reference in the preceding script must match the location of this script on your disk. For the complete script, see AfterNewHandler.applescript. </p>
<div class="fragment"><div class="line">--Provides an <span class="stringliteral">&quot;afterNew&quot;</span> <span class="keyword">event</span> handler <span class="keywordflow">for</span> the AfterNew.applescript</div>
<div class="line">--tutorial script. Sets up a basic document layout and adds XMP information</div>
<div class="line">--to the document.</div>
<div class="line">--</div>
<div class="line">myAfterNewHandler(evt)</div>
<div class="line">on myAfterNewHandler(myEvent)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        if user name = &quot;&quot; then</div>
<div class="line">            set user name to &quot;Adobe&quot;</div>
<div class="line">        end if</div>
<div class="line">        set myUserName to user name</div>
<div class="line">        --set myDocument to parent of myEvent</div>
<div class="line">        set myDocument to document 1</div>
<div class="line">        tell view preferences of myDocument</div>
<div class="line">            set horizontal measurement units to points</div>
<div class="line">            set vertical measurement units to points</div>
<div class="line">            set ruler origin to page origin</div>
<div class="line">        end tell</div>
<div class="line">        --MySlugOffset is the distance from the bottom of the page</div>
<div class="line">        --to the top of the slug.</div>
<div class="line">        set mySlugOffset to 12</div>
<div class="line">        --MySlugHeight is the height of the text frame</div>
<div class="line">        --containing the job information.</div>
<div class="line">        set mySlugHeight to 72</div>
<div class="line">        tell document preferences of myDocument</div>
<div class="line">            set slug bottom offset to mySlugOffset + mySlugHeight</div>
<div class="line">            set slug top offset to 0</div>
<div class="line">            set slug inside or left offset to 0</div>
<div class="line">            set slug right or outside offset to 0</div>
<div class="line">        end tell</div>
<div class="line">        repeat with myCounter from 1 to (count master spreads of myDocument)</div>
<div class="line">            set myMasterSpread to master spread myCounter of myDocument</div>
<div class="line">            repeat with myMasterPageCounter from 1 to (count pages of myMasterSpread)</div>
<div class="line">                set myPage to page myMasterPageCounter of myMasterSpread</div>
<div class="line">                set mySlugBounds to my myGetSlugBounds(myDocument, myPage, mySlugOffset, mySlugHeight)</div>
<div class="line">                tell myPage</div>
<div class="line">                    set mySlugFrame to make text frame with properties {geometric bounds:mySlugBounds, contents:<span class="stringliteral">&quot;Created: &quot;</span> &amp; time stamp of myEvent &amp; <span class="keywordflow">return</span> &amp; <span class="stringliteral">&quot;by: &quot;</span> &amp; myUserName}</div>
<div class="line">                end tell</div>
<div class="line">            end repeat</div>
<div class="line">        end repeat</div>
<div class="line">        tell metadata preferences of myDocument</div>
<div class="line">            <span class="keyword">set</span> author to <span class="stringliteral">&quot;Adobe Systems&quot;</span></div>
<div class="line">            <span class="keyword">set</span> description to <span class="stringliteral">&quot;This is an example document containing XMP metadata. Created: &quot;</span> &amp; time stamp of myEvent</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">end myAfterNewHandler</div>
<div class="line">on myGetSlugBounds(myDocument, myPage, mySlugOffset, mySlugHeight)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        tell myDocument</div>
<div class="line">            set myPageWidth to page width of document preferences</div>
<div class="line">            set myPageHeight to page height of document preferences</div>
<div class="line">        end tell</div>
<div class="line">        set myLeft to left of margin preferences of myPage</div>
<div class="line">        set myRight to right of margin preferences of myPage</div>
<div class="line">        set myX1 to myLeft</div>
<div class="line">        set myY1 to myPageHeight + mySlugOffset</div>
<div class="line">        set myX2 to myPageWidth - myRight</div>
<div class="line">        set myY2 to myY1 + mySlugHeight</div>
<div class="line">        return {myY1, myX1, myY2, myX2}</div>
<div class="line">    end tell</div>
<div class="line">end myGetSlugBounds</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_sample_beforeprint_event_listener"></a>
Sample beforePrint Event Listener</h2>
<p>The beforePrint event provides a perfect place to execute a script that performs various preflight checks on a document. The following script shows how to add an event listener that checks a document for certain attributes before printing (for the complete script, see BeforePrint): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        make <span class="keyword">event</span> listener with properties {<span class="keyword">event</span> type:<span class="stringliteral">&quot;beforePrint&quot;</span>, handler:<span class="stringliteral">&quot;yukino:IDEventHandlers:BeforePrintHandler.applescript&quot;</span>}</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> The preceding script refers to the following script. The file reference in the preceding script must match the location of this script on your disk. For the complete script, see BeforePrintHandler.applescript. </p>
<div class="fragment"><div class="line">--Provides a <span class="stringliteral">&quot;beforePrint&quot;</span> <span class="keyword">event</span> handler <span class="keywordflow">for</span> the BeforePrint.applescript</div>
<div class="line">--tutorial script. Peforms a preflight check on a document. <span class="stringliteral">&quot;evt&quot;</span> is the <span class="keyword">event</span></div>
<div class="line">--passed to <span class="keyword">this</span> script by the <span class="keyword">event</span> listener.</div>
<div class="line">--</div>
<div class="line">myBeforePrintHandler(evt)</div>
<div class="line">on myBeforePrintHandler(myEvent)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        --The parent of the event is the document.</div>
<div class="line">        set myDocument to parent of myEvent</div>
<div class="line">        if my myPreflight(myDocument) is false then</div>
<div class="line">            tell myEvent</div>
<div class="line">                stop propagation</div>
<div class="line">                prevent default</div>
<div class="line">            end tell</div>
<div class="line">            display dialog (&quot;Document did not pass preflight check. Please fix the problems and try again.&quot;)</div>
<div class="line">        else</div>
<div class="line">            display dialog (&quot;Document passed preflight check. Ready to print.&quot;)</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
<div class="line">end myBeforePrintHandler</div>
<div class="line">on myPreflight(myDocument)</div>
<div class="line">    set myPreflightCheck to true</div>
<div class="line">    set myFontCheck to my myCheckFonts(myDocument)</div>
<div class="line">    set myGraphicsCheck to my myCheckGraphics(myDocument)</div>
<div class="line">    display dialog (&quot;Fonts: &quot; &amp; myFontCheck &amp; return &amp; &quot;Links:&quot; &amp; myGraphicsCheck)</div>
<div class="line">    if myFontCheck = false or myGraphicsCheck = false then</div>
<div class="line">        set myPreflightCheck to false</div>
<div class="line">        return myPreflightCheck</div>
<div class="line">    end if</div>
<div class="line">end myPreflight</div>
<div class="line">on myCheckFonts(myDocument)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myFontCheck to true</div>
<div class="line">        repeat with myCounter from 1 to (count fonts of myDocument)</div>
<div class="line">            set myFont to font myCounter of myDocument</div>
<div class="line">            if font status of myFont is not installed then</div>
<div class="line">                set myFontCheck to false</div>
<div class="line">                exit repeat</div>
<div class="line">            end if</div>
<div class="line">        end repeat</div>
<div class="line">        return myFontCheck</div>
<div class="line">    end tell</div>
<div class="line">end myCheckFonts</div>
<div class="line">on myCheckGraphics(myDocument)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myGraphicsCheck to true</div>
<div class="line">        repeat with myCounter from 1 to (count graphics of myDocument)</div>
<div class="line">            set myGraphic to graphic myCounter of myDocument</div>
<div class="line">            set myLink to item link of myGraphic</div>
<div class="line">            if link status of myLink is not normal then</div>
<div class="line">                set myGraphicsCheck to false</div>
<div class="line">                exit repeat</div>
<div class="line">            end if</div>
<div class="line">        end repeat</div>
<div class="line">        return myGraphicsCheck</div>
<div class="line">    end tell</div>
<div class="line">end myCheckGraphics</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_sample_selection_event_listeners"></a>
Sample Selection Event Listeners</h2>
<p>InDesign can respond to events related to selection. When you select or deselect objects in an InDesign document, InDesign generates the afterSelectionChanged event. When you change an attribute (the formatting or position) of the selected object or objects, InDesign generates the afterSelectionAttributeChanged event. These two events are useful when you want to create a script that responds to user actions.</p>
<p>The following script fragment shows how to get and display the type of an object when the selection changes. For the complete script, see AfterSelectionChanged. </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to make document</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myEventListener to make <span class="keyword">event</span> listener with properties {<span class="keyword">event</span> type:<span class="stringliteral">&quot;afterSelectionChanged&quot;</span>, handler:my myDisplaySelectionType}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The event handler referred to in the preceding script fragment looks like this: </p>
<div class="fragment"><div class="line">on myDisplaySelectionType(en)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        if (count documents) is greater than 0 then</div>
<div class="line">            tell document 1</div>
<div class="line">                set mySelection to selection</div>
<div class="line">                if (count mySelection) is greater than 0 then</div>
<div class="line">                    set myString to &quot;Selection Contents:&quot; &amp; return</div>
<div class="line">                    repeat with myCounter from 1 to (count mySelection)</div>
<div class="line">                        set myString to myString &amp; class of item myCounter of mySelection &amp; return</div>
<div class="line">                    end repeat</div>
<div class="line">                    display dialog myString</div>
<div class="line">                end if</div>
<div class="line">            end tell</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
<div class="line">end myDisplaySelectionType</div>
</div><!-- fragment --><p> To remove the event listener added by the preceding script, run the RemoveAfterSelectionChanged script.</p>
<p>The following script fragment shows how to respond to a change in the attributes of a selection. In this example, the event handler checks the selection to see whether the Registration swatch has been applied. (Accidental application of the Registration swatch can cause problems at your commercial printer.) If the Registration swatch has been applied, the script asks whether the change was intentional. For the complete script, see AfterSelectionAttributeChanged. </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to make document</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myEventListener to make <span class="keyword">event</span> listener with properties {<span class="keyword">event</span> type:<span class="stringliteral">&quot;afterSelectionAttributeChanged&quot;</span>, handler:my myCheckForRegistration}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The event handler referred to in the preceding script fragment looks like this: </p>
<div class="fragment"><div class="line">on myCheckForRegistration()</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        if (count documents) is greater than 0 then</div>
<div class="line">            tell document 1</div>
<div class="line">                set mySelection to selection</div>
<div class="line">                if (count mySelection) is greater than 0 then</div>
<div class="line">                    set myRegistrationSwatchUsed to false</div>
<div class="line">                    repeat with myCounter from 1 to (count mySelection)</div>
<div class="line">                        set myFillColor to fill color of item myCounter of mySelection</div>
<div class="line">                        set myStrokeColor to stroke color of item myCounter of mySelection</div>
<div class="line">                        if name of myFillColor is &quot;Registration&quot; or name of myStrokeColor is &quot;Registration&quot; then</div>
<div class="line">                            set myRegistrationSwatchUsed to true</div>
<div class="line">                        end if</div>
<div class="line">                    end repeat</div>
<div class="line">                    if myRegistrationSwatchUsed is true then</div>
<div class="line">                        display dialog &quot;The Registration swatch is applied to some of the&quot; &amp; return &amp; &quot;objects in the selection. Did you really intend to apply this swatch?&quot;</div>
<div class="line">                    end if</div>
<div class="line">                end if</div>
<div class="line">            end tell</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
<div class="line">end myCheckForRegistration</div>
</div><!-- fragment --><p> To remove the event listener added by the preceding script, run the RemoveAfterSelectionAttributeChanged script.</p>
<h2><a class="anchor" id="id_as_sample_onidle_event_listener"></a>
Sample onIdle Event Listener</h2>
<p>InDesign's idle tasks execute when there are no events in the event queue for the application to process. It is easy to run idle tasks by scripting. The onIdle event provides a way to run scripting-based idle tasks. It can be used to automatically execute a script when InDesign/InCopy is idle. Its event target is IdleTask, and its event object is IdleEvent.</p>
<p>The sleep property of the idle task is the amount of time that elapses before InDesign calls the task again. It should be obvious that you need to set the sleep time to a value high enough that it does not interfere with your work, though this value will vary depending on what tasks the script performs.</p>
<p>Setting the sleep time to zero deletes the task (though it does not remove the event listener). This is the most convenient way to stop an idle task.</p>
<p>The following script shows how to add an eventListener and show a message box from the idle task (for the complete script, see OnIdle): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myIdleTaskName to <span class="stringliteral">&quot;my_idle_task&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myIdleTask to make idle task with properties {name:myIdleTaskName, sleep:10000}</div>
<div class="line">        tell myIdleTask</div>
<div class="line">            --You need to fill in your own file path.</div>
<div class="line">            <span class="keyword">set</span> fileName to <span class="stringliteral">&quot;Macintosh HD:scripting:OnIdleEventHandler.applescript&quot;</span></div>
<div class="line">            <span class="keyword">set</span> onIdleEventListener to make <span class="keyword">event</span> listener with properties {<span class="keyword">event</span> type:<span class="stringliteral">&quot;onIdle&quot;</span>, handler:fileName, captures:<span class="keyword">false</span>}</div>
<div class="line">            display alert <span class="stringliteral">&quot;Created idle task &quot;</span> &amp; name &amp; <span class="stringliteral">&quot;; added event listener on &quot;</span> &amp; <span class="keyword">event</span> type of onIdleEventListener</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The event handler is a script file, OnIdleEventHandler.applescript. </p>
<div class="fragment"><div class="line">--<span class="stringliteral">&quot;evt&quot;</span> is the <span class="keyword">event</span> passed to <span class="keyword">this</span> script by the <span class="keyword">event</span> listener.</div>
<div class="line">onIdleEventHandler(evt)</div>
<div class="line">on onIdleEventHandler(myIdleEvent)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        if (count of documents) = 0 then</div>
<div class="line">            set myDoc to make document</div>
<div class="line">            display alert &quot;Created document &quot; &amp; name of myDoc &amp; &quot; in idle task.&quot;</div>
<div class="line">            return</div>
<div class="line">        end if</div>
<div class="line">        </div>
<div class="line">        tell item 1 of pages of active document</div>
<div class="line">            if (count of text frames) = 0 then</div>
<div class="line">                make text frame with properties {geometric bounds:[<span class="stringliteral">&quot;72pt&quot;</span>, <span class="stringliteral">&quot;72pt&quot;</span>, <span class="stringliteral">&quot;288pt&quot;</span>, <span class="stringliteral">&quot;288pt&quot;</span>], contents:<span class="stringliteral">&quot;Text frame created in idle task&quot;</span>}</div>
<div class="line">                display alert <span class="stringliteral">&quot;Created a text frame in idle task.&quot;</span></div>
<div class="line">                <span class="keywordflow">return</span></div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">        end tell</div>
<div class="line">        </div>
<div class="line">        --Delete idle task by setting its sleep time to zero.</div>
<div class="line">        <span class="keyword">set</span> sleep of parent of myIdleEvent to 0</div>
<div class="line">        display alert <span class="stringliteral">&quot;Nothing to do. Delete idle task.&quot;</span></div>
<div class="line">    end tell</div>
<div class="line">end onIdleEventHandler</div>
</div><!-- fragment --><p> To remove the idle task created by preceding script, run the following script (for the complete script, see RemoveIdleTask): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> taskCount to count of idle tasks</div>
<div class="line">        <span class="keywordflow">if</span> taskCount is 0 then</div>
<div class="line">            display alert <span class="stringliteral">&quot;There is no idle task.&quot;</span></div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keyword">set</span> myIdleTaskName to <span class="stringliteral">&quot;my_idle_task&quot;</span></div>
<div class="line">            repeat with i from taskCount to 1 by -1</div>
<div class="line">                <span class="keyword">set</span> myIdleTask to item i of idle tasks</div>
<div class="line">                <span class="keywordflow">if</span> name of myIdleTask is myIdleTaskName then</div>
<div class="line">                    <span class="keyword">delete</span> myIdleTask</div>
<div class="line">                end <span class="keywordflow">if</span></div>
<div class="line">            end repeat</div>
<div class="line">            display alert <span class="stringliteral">&quot;Idle task &quot;</span> &amp; myIdleTaskName &amp; <span class="stringliteral">&quot; removed.&quot;</span></div>
<div class="line">        end <span class="keywordflow">if</span></div>
</div><!-- fragment --><p> To remove all idle tasks, run the following script (for the complete script, see RemoveAllIdleTasks): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> taskCount to count of idle tasks</div>
<div class="line">        <span class="keywordflow">if</span> taskCount is 0 then</div>
<div class="line">            display alert <span class="stringliteral">&quot;There is no idle task.&quot;</span></div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            repeat with i from taskCount to 1 by -1</div>
<div class="line">                <span class="keyword">set</span> myIdleTask to item i of idle tasks</div>
<div class="line">                <span class="keyword">delete</span> myIdleTask</div>
<div class="line">            end repeat</div>
<div class="line">            display alert <span class="stringliteral">&quot;&quot;</span> &amp; taskCount &amp; <span class="stringliteral">&quot; idle task(s) removed.&quot;</span></div>
<div class="line">        end <span class="keywordflow">if</span></div>
</div><!-- fragment --><p> To list existing idle tasks, run the following script (for the complete script, see ListIdleTasks): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> taskCount to count of idle tasks</div>
<div class="line">        <span class="keywordflow">if</span> taskCount is 0 then</div>
<div class="line">            display alert <span class="stringliteral">&quot;There is no idle task.&quot;</span></div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keyword">set</span> str to <span class="stringliteral">&quot;&quot;</span></div>
<div class="line">            repeat with i from 1 to taskCount</div>
<div class="line">                <span class="keyword">set</span> myIdleTask to item i of idle tasks</div>
<div class="line">                tell myIdleTask</div>
<div class="line">                    <span class="keyword">set</span> str to str &amp; <span class="stringliteral">&quot;idle task &quot;</span> &amp; <span class="keywordtype">id</span> &amp; <span class="stringliteral">&quot;: &quot;</span> &amp; name &amp; <span class="keywordflow">return</span></div>
<div class="line">                end tell</div>
<div class="line">            end repeat</div>
<div class="line">            display alert str</div>
<div class="line">        end <span class="keywordflow">if</span></div>
</div><!-- fragment --> <h1><a class="anchor" id="id_as_menus"></a>
Menus</h1>
<p>InDesign scripting can add menu items, remove menu items, perform any menu command, and attach scripts to menu items.</p>
<p>This section shows how to work with InDesign menu scripting. The sample scripts in this chapter are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script.</p>
<h2><a class="anchor" id="id_as_understanding_the_menu_model"></a>
Understanding the Menu Model</h2>
<p>The InDesign menu-scripting model is made up of a series of objects that correspond to the menus you see in the application's user interface, including menus associated with panels as well as those displayed on the main menu bar. A menu object contains the following objects:</p>
<ul>
<li>menuItems - The menu options shown on a menu. This does not include submenus.</li>
<li>menuSeparators - Lines used to separate menu options on a menu.</li>
<li>submenus - Menu options that contain further menu choices.</li>
<li>menuElements - All menuItems, menuSeparators and submenus shown on a menu.</li>
<li>eventListeners - These respond to user (or script) actions related to a menu.</li>
<li>events - The events triggered by a menu.</li>
</ul>
<p>Every menu item is connected to a menu action through the associated menu action property. The properties of the menu action define what happens when the menu item is chosen. In addition to the menu actions defined by the user interface, InDesign scripters can create their own, script menu actions, which associate a script with a menu selection.</p>
<p>A menu action or script menu action can be connected to zero, one, or more menu items.</p>
<p>The following diagram shows how the different menu objects relate to each other:</p>
<div class="image">
<img src="InDesign_ScriptingGuide-7.gif" alt="InDesign_ScriptingGuide-7.gif"/>
</div>
<p>To create a list (as a text file) of all menu actions, run the following script fragment (from the GetMenuActions tutorial script): </p>
<div class="fragment"><div class="line">    <span class="keyword">set</span> myTextFile to choose file name (<span class="stringliteral">&quot;Save menu action names as:&quot;</span>)</div>
<div class="line">    if myTextFile is not equal to &quot;&quot; then</div>
<div class="line">        tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">            set myString to &quot;&quot;</div>
<div class="line">            set myMenuActionNames to name of every menu action</div>
<div class="line">            repeat with myMenuActionName in myMenuActionNames</div>
<div class="line">                set myString to myString &amp; myMenuActionName &amp; return</div>
<div class="line">            end repeat</div>
<div class="line">            my myWriteToFile(myString, myTextFile, false)</div>
<div class="line">        end tell</div>
<div class="line">    end if</div>
</div><!-- fragment --><div class="fragment"><div class="line">on myWriteToFile(myString, myFileName, myAppendData)</div>
<div class="line">    set myTextFile to open for access myFileName with write permission</div>
<div class="line">    if myAppendData is false then</div>
<div class="line">        set eof of myTextFile to 0</div>
<div class="line">    end if</div>
<div class="line">    write myString to myTextFile starting at eof</div>
<div class="line">    close access myTextFile</div>
<div class="line">end myWriteToFile</div>
</div><!-- fragment --><p> To create a list (as a text file) of all available menus, run the following script fragment (for the complete script, see GetMenuNames). These scripts can be very slow, as there are many menu names in InDesign. </p>
<div class="fragment"><div class="line">    <span class="keyword">set</span> myTextFile to choose file name {<span class="stringliteral">&quot;Save Menu Names As&quot;</span>}</div>
<div class="line">    --If the user clicked the Cancel button, the result is null.</div>
<div class="line">    <span class="keywordflow">if</span> (myTextFile is not equal to <span class="stringliteral">&quot;&quot;</span>) then</div>
<div class="line">        tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">            --Open the file with write access.</div>
<div class="line">            my myWriteToFile(<span class="stringliteral">&quot;Adobe InDesign CC Menu Names&quot;</span> &amp; <span class="keywordflow">return</span>, myTextFile, <span class="keyword">false</span>)</div>
<div class="line">            repeat with myCounter from 1 to (count menus)</div>
<div class="line">                set myMenu to item myCounter of menus</div>
<div class="line">                set myString to &quot;----------&quot; &amp; return &amp; name of myMenu &amp; return &amp; &quot;----------&quot; &amp; return</div>
<div class="line">                set myString to my myProcessMenu(myMenu, myString)</div>
<div class="line">                my myWriteToFile(myString, myTextFile, true)</div>
<div class="line">            end repeat</div>
<div class="line">            display dialog (&quot;done!&quot;)</div>
<div class="line">        end tell</div>
<div class="line">    end if</div>
</div><!-- fragment --><div class="fragment"><div class="line">on myProcessMenu(myMenu, myString)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myIndent to my myGetIndent(myMenu)</div>
<div class="line">        repeat with myCounter from 1 to (count menu elements of myMenu)</div>
<div class="line">            set myMenuElement to menu element myCounter of myMenu</div>
<div class="line">            set myClass to class of myMenuElement</div>
<div class="line">            if myClass is not equal to menu separator then</div>
<div class="line">                set myMenuElementName to name of myMenuElement</div>
<div class="line">                set myString to myString &amp; myIndent &amp; myMenuElementName &amp; return</div>
<div class="line">                if class of myMenuElement is submenu then</div>
<div class="line">                    if myMenuElementName is not &quot;Font&quot; then</div>
<div class="line">                        set myString to my myProcessMenu(myMenuElement, myString)</div>
<div class="line">                    end if</div>
<div class="line">                end if</div>
<div class="line">            end if</div>
<div class="line">        end repeat</div>
<div class="line">        return myString</div>
<div class="line">    end tell</div>
<div class="line">end myProcessMenu</div>
<div class="line">on myGetIndent(myObject)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myString to &quot;&quot;</div>
<div class="line">        repeat until class of myObject is menu</div>
<div class="line">            set myString to myString &amp; tab</div>
<div class="line">            set myObject to parent of myObject</div>
<div class="line">        end repeat</div>
<div class="line">        return myString</div>
<div class="line">    end tell</div>
<div class="line">end myGetIndent</div>
<div class="line">on myWriteToFile(myString, myFileName, myAppendData)</div>
<div class="line">    set myTextFile to open for access myFileName with write permission</div>
<div class="line">    if myAppendData is false then</div>
<div class="line">        set eof of myTextFile to 0</div>
<div class="line">    end if</div>
<div class="line">    write myString to myTextFile starting at eof</div>
<div class="line">    close access myTextFile</div>
<div class="line">end myWriteToFile</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_localization_and_menu_names"></a>
Localization and menu names</h3>
<p>In InDesign scripting, menu items, menus, menu actions, and submenus are all referred to by name. Because of this, scripts need a method of locating these objects that is independent of the installed locale of the application. To do this, you can use an internal database of strings that refer to a specific item, regardless of locale. For example, to get the locale-independent name of a menu action, you can use the following script fragment (for the complete script, see GetKeyStrings): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myMenuAction to menu action <span class="stringliteral">&quot;Convert to Note&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myKeyStrings to find key strings <span class="keywordflow">for</span> title of myMenuAction</div>
<div class="line">        <span class="keywordflow">if</span> <span class="keyword">class </span>of myKeyStrings is list then</div>
<div class="line">            repeat with myKeyString in myKeyStrings</div>
<div class="line">                set myString to myKeyString &amp; <span class="keywordflow">return</span></div>
<div class="line">            end repeat</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keyword">set</span> myString to myKeyStrings</div>
<div class="line">        end <span class="keywordflow">if</span></div>
<div class="line">        display dialog (myString)</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>It is much better to get the locale-independent name of a menu action than of a menu, menu item, or submenu, because the title of a menu action is more likely to be a single string. Many of the other menu objects return multiple strings when you use the find key strings method.</dd></dl>
<p>Once you have the locale-independent string you want to use, you can include it in your scripts. Scripts that use these strings will function properly in locales other than that of your version of InDesign.</p>
<p>To translate a locale-independent string into the current locale, use the following script fragment (from the TranslateKeyString tutorial script): </p>
<div class="fragment"><div class="line">        --Enter the key <span class="keywordtype">string</span> you want to translate in the following line.</div>
<div class="line">        <span class="keyword">set</span> myString to translate key <span class="keywordtype">string</span> <span class="keywordflow">for</span> <span class="stringliteral">&quot;$ID/NotesMenu_ConvertToNote&quot;</span></div>
<div class="line">        display dialog (myString)</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_running_a_menu_action_from_a_script"></a>
Running a Menu Action from a Script</h2>
<p>Any of InDesign's built-in menu actions can be run from a script. The menu action does not need to be attached to a menu item; however, in every other way, running a menu item from a script is exactly the same as choosing a menu option in the user interface. For example, If selecting the menu option displays a dialog box, running the corresponding menu action from a script also displays a dialog box.</p>
<p>The following script shows how to run a menu action from a script (for the complete script, see InvokeMenuAction): </p>
<div class="fragment"><div class="line">                    --Get a reference to a menu action.</div>
<div class="line">                    <span class="keyword">set</span> myMenuAction to menu action <span class="stringliteral">&quot;$ID/NotesMenu_ConvertToNote&quot;</span></div>
<div class="line">                    --Run the menu action. The example action will fail <span class="keywordflow">if</span> you <span class="keywordflow">do</span> not</div>
<div class="line">                    --have text selected.</div>
<div class="line">                    invoke myMenuAction</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>In general, you should not try to automate InDesign processes by scripting menu actions and user-interface selections; InDesign's scripting object model provides a much more robust and powerful way to work. Menu actions depend on a variety of user-interface conditions, like the selection and the state of the window. Scripts using the object model work with the objects in an InDesign document directly, which means they do not depend on the user interface; this, in turn, makes them faster and more consistent.</dd></dl>
<h2><a class="anchor" id="id_as_adding_menus_and_menu_items"></a>
Adding Menus and Menu Items</h2>
<p>Scripts also can create new menus and menu items or remove menus and menu items, just as you can in the InDesign user interface. The following sample script shows how to duplicate the contents of a submenu to a new menu in another menu location (for the complete script, see CustomizeMenu): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myMainMenu to menu <span class="stringliteral">&quot;Main&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myTypeMenu to submenu <span class="stringliteral">&quot;Type&quot;</span> of myMainMenu</div>
<div class="line">        <span class="keyword">set</span> myFontMenu to submenu <span class="stringliteral">&quot;Font&quot;</span> of myTypeMenu</div>
<div class="line">        <span class="keyword">set</span> myKozukaMenu to submenu <span class="stringliteral">&quot;Kozuka Mincho Pro &quot;</span> of myFontMenu</div>
<div class="line">        tell myMainMenu</div>
<div class="line">            <span class="keyword">set</span> mySpecialFontMenu to make submenu with properties {title:<span class="stringliteral">&quot;Kozuka Mincho Pro&quot;</span>}</div>
<div class="line">        end tell</div>
<div class="line">        repeat with myMenuItem in menu items of myKozukaMenu</div>
<div class="line">            <span class="keyword">set</span> myAssociatedMenuAction to associated menu action of myMenuItem</div>
<div class="line">            tell mySpecialFontMenu</div>
<div class="line">                make menu item with properties {associated menu action:myAssociatedMenuAction}</div>
<div class="line">            end tell</div>
<div class="line">        end repeat</div>
</div><!-- fragment --><p> To remove the custom menu item created by the above script, use RemoveCustomMenu. </p>
<div class="fragment"><div class="line">    <span class="keyword">set</span> myMainMenu to menu <span class="stringliteral">&quot;Main&quot;</span></div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">        <span class="keyword">set</span> myKozukaMenu to submenu <span class="stringliteral">&quot;Kozuka Mincho Pro&quot;</span> of myMainMenu</div>
<div class="line">        tell myKozukaMenu to <span class="keyword">delete</span></div>
<div class="line">    end <span class="keywordflow">try</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_menus_and_events"></a>
Menus and Events</h2>
<p>Menus and submenus generate events as they are chosen in the user interface, and menu actions and script menu actions generate events as they are used. Scripts can install event listeners to respond to these events. The following table shows the events for the different menu scripting components:</p>
<table class="doxtable">
<tr>
<th>Object</th><th>Event</th><th>Description  </th></tr>
<tr>
<td>menu</td><td>beforeDisplay</td><td>Runs the attached script before the contents of the menu is shown.  </td></tr>
<tr>
<td rowspan="2" colspan="1">menuAction</td><td>afterInvoke</td><td>Runs the attached script when the associated menuItem is selected, but after the onInvoke event.  </td></tr>
<tr>
<td>beforeInvoke</td><td>Runs the attached script when the associated menuItem is selected, but before the onInvoke event.  </td></tr>
<tr>
<td rowspan="4" colspan="1">scriptMenuAction</td><td>afterInvoke</td><td>Runs the attached script when the associated menuItem is selected, but after the onInvoke event.  </td></tr>
<tr>
<td>beforeInvoke</td><td>Runs the attached script when the associated menuItem is selected, but before the onInvoke event.  </td></tr>
<tr>
<td>beforeDisplay</td><td>Runs the attached script before an internal request for the enabled/checked status of the scriptMenuActionscriptMenuAction.  </td></tr>
<tr>
<td>onInvoke</td><td>Runs the attached script when the scriptMenuAction is invoked.  </td></tr>
<tr>
<td>submenu</td><td>beforeDisplay</td><td>Runs the attached script before the contents of the submenu are shown.  </td></tr>
</table>
<p>For more about events and event listeners, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_events">Events.</a></p>
<p>To change the items displayed in a menu, add an event listener for the beforeDisplay event. When the menu is selected, the event listener can then run a script that enables or disables menu items, changes the wording of menu item, or performs other tasks related to the menu. This mechanism is used internally to change the menu listing of available fonts, recent documents, or open windows.</p>
<h2><a class="anchor" id="id_as_working_with_scriptmenuactions"></a>
Working with scriptMenuActions</h2>
<p>You can use script menu action to create a new menu action whose behavior is implemented through the script registered to run when the onInvoke event is triggered.</p>
<p>The following script shows how to create a script menu action and attach it to a menu item (for the complete script, see MakeScriptMenuAction). This script simply displays an alert when the menu item is selected. </p>
<div class="fragment"><div class="line">        --Create the script menu action <span class="stringliteral">&quot;Display Message&quot;</span> <span class="keywordflow">if</span> it does not already exist.</div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">            <span class="keyword">set</span> myScriptMenuAction to script menu action <span class="stringliteral">&quot;Display Message&quot;</span></div>
<div class="line">        on error</div>
<div class="line">            <span class="keyword">set</span> myScriptMenuAction to make script menu action with properties {title:<span class="stringliteral">&quot;Display Message&quot;</span>}</div>
<div class="line">        end <span class="keywordflow">try</span></div>
<div class="line">        tell myScriptMenuAction</div>
<div class="line">            --If the script menu action already existed, </div>
<div class="line">            --<span class="keyword">remove</span> the existing <span class="keyword">event</span> listeners.</div>
<div class="line">            <span class="keywordflow">if</span> (count event listeners) &gt; 0 then</div>
<div class="line">                tell every <span class="keyword">event</span> listener to <span class="keyword">delete</span></div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">            <span class="keyword">set</span> myEventListener to make <span class="keyword">event</span> listener with properties {<span class="keyword">event</span> type:<span class="stringliteral">&quot;onInvoke&quot;</span>, handler:<span class="stringliteral">&quot;yukino:message.applescript&quot;</span>}</div>
<div class="line">        end tell</div>
<div class="line">        tell menu <span class="stringliteral">&quot;$ID/Main&quot;</span></div>
<div class="line">            <span class="keyword">set</span> mySampleScriptMenu to make submenu with properties {title:<span class="stringliteral">&quot;Script Menu Action&quot;</span>}</div>
<div class="line">            tell mySampleScriptMenu</div>
<div class="line">                <span class="keyword">set</span> mySampleScriptMenuItem to make menu item with properties {associated menu action:myScriptMenuAction}</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The message.applescript script file contains the following code: </p>
<div class="fragment"><div class="line">tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">    --<span class="stringliteral">&quot;evt&quot;</span> is the <span class="keyword">event</span> passed to <span class="keyword">this</span> script by the <span class="keyword">event</span> listener.</div>
<div class="line">    <span class="keyword">set</span> myEvent to evt</div>
<div class="line">    display dialog <span class="stringliteral">&quot;This event is the &quot;</span> &amp; <span class="keyword">event</span> type of myEvent &amp; <span class="stringliteral">&quot; event.&quot;</span></div>
<div class="line">end tell</div>
</div><!-- fragment --><p> To remove the menu, submenu, menu item, and script menu action created by the above script, run the following script fragment (from the RemoveScriptMenuAction tutorial script): </p>
<div class="fragment"><div class="line">        <span class="keywordflow">try</span></div>
<div class="line">            <span class="keyword">set</span> myScriptMenuAction to script menu action <span class="stringliteral">&quot;Display Message&quot;</span></div>
<div class="line">            tell myScriptMenuAction</div>
<div class="line">                <span class="keyword">delete</span></div>
<div class="line">            end tell</div>
<div class="line">            tell submenu <span class="stringliteral">&quot;Script Menu Action&quot;</span> of menu <span class="stringliteral">&quot;$ID/Main&quot;</span> to <span class="keyword">delete</span></div>
<div class="line">        end <span class="keywordflow">try</span></div>
</div><!-- fragment --><p> You also can remove all script menu action, as shown in the following script fragment (from the RemoveAllScriptMenuActions tutorial script). This script also removes the menu listings of the script menu action, but it does not delete any menus or submenus you might have created. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        tell every script menu action to <span class="keyword">delete</span></div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> You can create a list of all current script menu actions, as shown in the following script fragment (from the ListScriptMenuActions tutorial script): </p>
<div class="fragment"><div class="line"><span class="keyword">set</span> myTextFile to choose file name {<span class="stringliteral">&quot;Save Script Menu Action Names As&quot;</span>}</div>
<div class="line">--If the user clicked the Cancel button, the result is null.</div>
<div class="line">if myTextFile is not equal to <span class="stringliteral">&quot;&quot;</span> then</div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myString to <span class="stringliteral">&quot;&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myScriptMenuActionNames to name of every script menu action</div>
<div class="line">        repeat with myScriptMenuActionName in myScriptMenuActionNames</div>
<div class="line">            <span class="keyword">set</span> myString to myString &amp; myScriptMenuActionName &amp; <span class="keywordflow">return</span></div>
<div class="line">        end repeat</div>
<div class="line">        my myWriteToFile(myString, myTextFile, <span class="keyword">false</span>)</div>
<div class="line">    end tell</div>
<div class="line">end if</div>
<div class="line">on myWriteToFile(myString, myFileName, myAppendData)</div>
<div class="line">    set myTextFile to open for access myFileName with write permission</div>
<div class="line">    if myAppendData is false then</div>
<div class="line">        set eof of myTextFile to 0</div>
<div class="line">    end if</div>
<div class="line">    write myString to myTextFile starting at eof</div>
<div class="line">    close access myTextFile</div>
<div class="line">end myWriteToFile</div>
</div><!-- fragment --><p> script menu actions also can run scripts during their beforeDisplay event, in which case they are executed before an internal request for the state of the script menu action (e.g., when the menu item is about to be displayed). Among other things, the script can then change the menu names and/or set the enabled/checked status.</p>
<p>In the following sample script, we add an event listener to the beforeDisplay event that checks the current selection. If there is no selection, the script in the event listener disables the menu item. If an item is selected, the menu item is enabled, and choosing the menu item displays the type of the first item in the selection. (For the complete script, see BeforeDisplay.) </p>
<div class="fragment"><div class="line">        --Create the script menu action <span class="stringliteral">&quot;Display Message&quot;</span> <span class="keywordflow">if</span> it does not already exist.</div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">            <span class="keyword">set</span> myScriptMenuAction to script menu action <span class="stringliteral">&quot;Display Message&quot;</span></div>
<div class="line">        on error</div>
<div class="line">            <span class="keyword">set</span> myScriptMenuAction to make script menu action with properties {title:<span class="stringliteral">&quot;Display Message&quot;</span>}</div>
<div class="line">        end <span class="keywordflow">try</span></div>
<div class="line">        tell myScriptMenuAction</div>
<div class="line">            --If the script menu action already existed, </div>
<div class="line">            --<span class="keyword">remove</span> the existing <span class="keyword">event</span> listeners.</div>
<div class="line">            <span class="keywordflow">if</span> (count event listeners) &gt; 0 then</div>
<div class="line">                tell every <span class="keyword">event</span> listener to <span class="keyword">delete</span></div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">            --You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">            make event listener with properties {event type:&quot;onInvoke&quot;, handler:&quot;yukino:IDEventHandlers:WhatIsSelected.applescript&quot;}</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">        tell menu &quot;$ID/Main&quot;</span></div>
<div class="line"><span class="stringliteral">            set mySampleScriptMenu to make submenu with properties {title:&quot;Script Menu Action&quot;}</span></div>
<div class="line"><span class="stringliteral">            tell mySampleScriptMenu</span></div>
<div class="line"><span class="stringliteral">                set mySampleScriptMenuItem to make menu item with properties {associated menu action:myScriptMenuAction}</span></div>
<div class="line"><span class="stringliteral">                make event listener with properties {event type:&quot;beforeDisplay&quot;, handler:&quot;yukino:IDEventHandlers:BeforeDisplayHandler.applescript&quot;}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --><p> The BeforeDisplayHandler tutorial script file contains the following script: </p>
<div class="fragment"><div class="line">tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">        <span class="keyword">set</span> mySampleScriptAction to script menu action <span class="stringliteral">&quot;Display Message&quot;</span></div>
<div class="line">        <span class="keyword">set</span> mySelection to selection</div>
<div class="line">        <span class="keywordflow">if</span> (count mySelection) &gt; 0 then</div>
<div class="line">            <span class="keyword">set</span> enabled of mySampleScriptAction to <span class="keyword">true</span></div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keyword">set</span> enabled of mySampleScriptAction to <span class="keyword">false</span></div>
<div class="line">        end <span class="keywordflow">if</span></div>
<div class="line">    on error</div>
<div class="line">        display alert (<span class="stringliteral">&quot;Script menu action did not exist.&quot;</span>)</div>
<div class="line">    end try</div>
<div class="line">end tell</div>
</div><!-- fragment --><p> The WhatIsSelected tutorial script file contains the following script: </p>
<div class="fragment"><div class="line">    <span class="keyword">set</span> mySelection to selection</div>
<div class="line">    <span class="keywordflow">if</span> (count mySelection) &gt; 0 then</div>
<div class="line">        <span class="keyword">set</span> myString to <span class="keyword">class </span>of item 1 of mySelection as string</div>
<div class="line">        display dialog (&quot;The first item in the selection is a &quot; &amp; myString &amp; <span class="stringliteral">&quot;.&quot;</span>)</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        display dialog (<span class="stringliteral">&quot;Nothing is selected.&quot;</span>)</div>
<div class="line">    end if</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_a_more_complex_menu-scripting_example"></a>
A More Complex Menu-scripting Example</h2>
<p>You have probably noticed that selecting different items in the InDesign user interface changes the contents of the context menus. The following sample script shows how to modify the context menu based on the properties of the object you select. Fragments of the script are shown below; for the complete script, see LayoutContextMenu.</p>
<p>The following snippet shows how to create a new menu item on the Layout context menu (the context menu that appears when you have a page item selected). The following snippet adds a beforeDisplay event listener which checks for the existence of a menu item and removes it if it already exists. We do this to ensure the menu item does not appear on the context menu when the selection does not contain a graphic, and to avoid adding multiple menu choices to the context menu. The event listener then checks the selection to see if it contains a graphic; if so, it creates a new script menu item. </p>
<div class="fragment"><div class="line">        --The locale-independent name (aka <span class="stringliteral">&quot;key string&quot;</span>) for the </div>
<div class="line">        --Layout context menu is &quot;$ID/RtMouseLayout&quot;.</div>
<div class="line">        set myLayoutMenu to menu &quot;$ID/RtMouseLayout&quot;</div>
<div class="line">        set myActionName to &quot;Create Graphic Label&quot;</div>
<div class="line">        --Note that the following script actions only create the script menu action</div>
<div class="line">        --and set up event listeners--they do not actually add the menu item to the</div>
<div class="line">        --Layout context menu. That job is taken care of by the event handler scripts</div>
<div class="line">        --themselves. The Layout context menu will not display the menu item unless</div>
<div class="line">        --a graphic is selected.</div>
<div class="line">        tell myLayoutMenu</div>
<div class="line">            --You will need to fill in a valid file location on your system for the script in the following line.</div>
<div class="line">            set myBeforeDisplayHandler to make event listener with properties {<span class="keyword">event</span> type:<span class="stringliteral">&quot;beforeDisplay&quot;</span>, handler:<span class="stringliteral">&quot;yukino:IDEventHandlers:LayoutMenuContextBeforeDisplayHandler.applescript&quot;</span>, captures:<span class="keyword">false</span>}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The LayoutContextMenuBeforeDisplayHandler.applescript file referred to in the above example contains the following: </p>
<div class="fragment"><div class="line">myBeforeDisplayHandler(evt)</div>
<div class="line">on myBeforeDisplayHandler(myEvent)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myGraphicList to {PDF, EPS, image}</div>
<div class="line">        <span class="keyword">set</span> myParentList to {rectangle, oval, polygon}</div>
<div class="line">        <span class="keyword">set</span> myContainerList to {page, spread, group, rectangle, oval, polygon}</div>
<div class="line">        <span class="keyword">set</span> myObjectList to {}</div>
<div class="line">        <span class="keyword">set</span> myLayoutContextMenu to menu <span class="stringliteral">&quot;$ID/RtMouseLayout&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> (count documents) &gt; 0 then</div>
<div class="line">            <span class="keyword">set</span> mySelection to selection</div>
<div class="line">            <span class="keywordflow">if</span> (count mySelection) &gt; 0 then</div>
<div class="line">                repeat with myCounter from 1 to (count mySelection)</div>
<div class="line">                    <span class="keyword">set</span> myObject to item myCounter of mySelection</div>
<div class="line">                    <span class="keywordflow">if</span> <span class="keyword">class </span>of myObject is in myGraphicList then</div>
<div class="line">                        --Do not add the graphic to the list if it is in an inline</div>
<div class="line">                        --or anchored frame.</div>
<div class="line">                        if class of parent of parent of myObject is in myContainerList then</div>
<div class="line">                            copy myObject to end of myObjectList</div>
<div class="line">                        end if</div>
<div class="line">                    else if class of myObject is in myParentList then</div>
<div class="line">                        --Do not add the graphic to the list if it is in an inline</div>
<div class="line">                        --or anchored frame.</div>
<div class="line">                        if class of parent of myObject is in myContainerList then</div>
<div class="line">                            if (count graphics of myObject) &gt; 0 then</div>
<div class="line">                                copy graphic 1 of myObject to end of myObjectList</div>
<div class="line">                            end if</div>
<div class="line">                        end if</div>
<div class="line">                    end if</div>
<div class="line">                end repeat</div>
<div class="line">                if (count myObjectList) is not equal to 0 then</div>
<div class="line">                    --The selection contains a qualifying item or items.</div>
<div class="line">                    --Add the menu item if it does not already exist.</div>
<div class="line">                    if my myMenuItemExists(myLayoutContextMenu, &quot;Label Graphic&quot;) is false then</div>
<div class="line">                        my myMakeLabelGraphicMenuItem(myLayoutContextMenu)</div>
<div class="line">                    end if</div>
<div class="line">                else</div>
<div class="line">                    --Remove the menu item if it exists.</div>
<div class="line">                    if my myMenuItemExists(myLayoutContextMenu, &quot;Label Graphic&quot;) is true then</div>
<div class="line">                        tell myLayoutContextMenu</div>
<div class="line">                            delete menu item &quot;Label Graphic&quot;</div>
<div class="line">                        end tell</div>
<div class="line">                    end if</div>
<div class="line">                end if</div>
<div class="line">            end if</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
<div class="line">end myBeforeDisplayHandler</div>
<div class="line">on myMakeLabelGraphicMenuItem(myLayoutContextMenu)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        if my myScriptMenuActionExists(&quot;Label Graphic&quot;) is false then</div>
<div class="line">            set myEventHandler to my myFindFile(&quot;LabelGraphicOnInvoke.appleScript&quot;)</div>
<div class="line">            set myLabelGraphicMenuAction to make script menu action with properties {name:<span class="stringliteral">&quot;Label Graphic&quot;</span>}</div>
<div class="line">            tell myLabelGraphicMenuAction</div>
<div class="line">                <span class="keyword">set</span> myLabelGraphicEventListener to make <span class="keyword">event</span> listener with properties {<span class="keyword">event</span> type:<span class="stringliteral">&quot;onInvoke&quot;</span>, handler:myEventHandler, captures:<span class="keyword">false</span>}</div>
<div class="line">            end tell</div>
<div class="line">            </div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keyword">set</span> myLabelGraphicMenuAction to script menu action <span class="stringliteral">&quot;Label Graphic&quot;</span></div>
<div class="line">        end <span class="keywordflow">if</span></div>
<div class="line">        tell myLayoutContextMenu</div>
<div class="line">            <span class="keyword">set</span> myLabelGraphicMenuItem to make menu item with properties {associated menu action:myLabelGraphicMenuAction}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">end myMakeLabelGraphicMenuItem</div>
</div><!-- fragment --><p> The LayoutMenuOnInvoke.applescript referred to in the above example defines the script menu action that is activated when the menu item is selected (onInvoke event): </p>
<div class="fragment"><div class="line">LabelGraphicEventHandler(evt)</div>
<div class="line">on LabelGraphicEventHandler(myEvent)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myGraphicList to {PDF, EPS, image}</div>
<div class="line">        <span class="keyword">set</span> myParentList to {rectangle, oval, polygon}</div>
<div class="line">        <span class="keyword">set</span> myObjectList to {}</div>
<div class="line">        <span class="keyword">set</span> myLayoutContextMenu to menu <span class="stringliteral">&quot;$ID/RtMouseLayout&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> (count documents) &gt; 0 then</div>
<div class="line">            <span class="keyword">set</span> mySelection to selection</div>
<div class="line">            <span class="keywordflow">if</span> (count mySelection) &gt; 0 then</div>
<div class="line">                repeat with myCounter from 1 to (count mySelection)</div>
<div class="line">                    <span class="keyword">set</span> myObject to item myCounter of mySelection</div>
<div class="line">                    <span class="keywordflow">if</span> <span class="keyword">class </span>of myObject is in myGraphicList then</div>
<div class="line">                        copy myObject to end of myObjectList</div>
<div class="line">                    else if class of myObject is in myParentList then</div>
<div class="line">                        if (count graphics of myObject) &gt; 0 then</div>
<div class="line">                            copy graphic 1 of myObject to end of myObjectList</div>
<div class="line">                        end if</div>
<div class="line">                    end if</div>
<div class="line">                end repeat</div>
<div class="line">                if (count myObjectList) is not equal to 0 then</div>
<div class="line">                    --The selection contains a qualifying item or items.</div>
<div class="line">                    my myDisplayDialog(myObjectList)</div>
<div class="line">                end if</div>
<div class="line">            end if</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
<div class="line">end LabelGraphicEventHandler</div>
<div class="line">--Displays a dialog box containing label options.</div>
<div class="line">on myDisplayDialog(myObjectList)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myLabelWidth to 100</div>
<div class="line">        set myStyleNames to my myGetParagraphStyleNames(document 1)</div>
<div class="line">        set myLayerNames to my myGetLayerNames(document 1)</div>
<div class="line">        set myDialog to make dialog with properties {name:<span class="stringliteral">&quot;LabelGraphics&quot;</span>}</div>
<div class="line">        tell myDialog</div>
<div class="line">            tell (make dialog column)</div>
<div class="line">                --Label Type</div>
<div class="line">                tell (make dialog row)</div>
<div class="line">                    tell (make dialog column)</div>
<div class="line">                        make <span class="keyword">static</span> text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Label Type:&quot;</span>, min width:myLabelWidth}</div>
<div class="line">                    end tell</div>
<div class="line">                    tell (make dialog column)</div>
<div class="line">                        <span class="keyword">set</span> myLabelTypeDropdown to make dropdown with properties {<span class="keywordtype">string</span> list:{<span class="stringliteral">&quot;File Name&quot;</span>, <span class="stringliteral">&quot;File Path&quot;</span>, <span class="stringliteral">&quot;XMP Author&quot;</span>, <span class="stringliteral">&quot;XMP Description&quot;</span>}, selected index:0}</div>
<div class="line">                    end tell</div>
<div class="line">                end tell</div>
<div class="line">                --Text frame height</div>
<div class="line">                tell (make dialog row)</div>
<div class="line">                    tell (make dialog column)</div>
<div class="line">                        make <span class="keyword">static</span> text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Label Height:&quot;</span>, min width:myLabelWidth}</div>
<div class="line">                    end tell</div>
<div class="line">                    tell (make dialog column)</div>
<div class="line">                        <span class="keyword">set</span> myLabelHeightField to make measurement editbox with properties {edit value:24, edit units:points}</div>
<div class="line">                    end tell</div>
<div class="line">                end tell</div>
<div class="line">                --Text frame offset</div>
<div class="line">                tell (make dialog row)</div>
<div class="line">                    tell (make dialog column)</div>
<div class="line">                        make <span class="keyword">static</span> text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Label Offset:&quot;</span>, min width:myLabelWidth}</div>
<div class="line">                    end tell</div>
<div class="line">                    tell (make dialog column)</div>
<div class="line">                        <span class="keyword">set</span> myLabelOffsetField to make measurement editbox with properties {edit value:0, edit units:points}</div>
<div class="line">                    end tell</div>
<div class="line">                end tell</div>
<div class="line">                --Paragraph style to apply</div>
<div class="line">                tell (make dialog row)</div>
<div class="line">                    tell (make dialog column)</div>
<div class="line">                        make <span class="keyword">static</span> text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Label Style:&quot;</span>, min width:myLabelWidth}</div>
<div class="line">                    end tell</div>
<div class="line">                    tell (make dialog column)</div>
<div class="line">                        <span class="keyword">set</span> myLabelStyleDropdown to make dropdown with properties {<span class="keywordtype">string</span> list:myStyleNames, selected index:0}</div>
<div class="line">                    end tell</div>
<div class="line">                end tell</div>
<div class="line">                --Layer</div>
<div class="line">                tell (make dialog row)</div>
<div class="line">                    tell (make dialog column)</div>
<div class="line">                        make <span class="keyword">static</span> text with properties {<span class="keyword">static</span> label:<span class="stringliteral">&quot;Layer:&quot;</span>, min width:myLabelWidth}</div>
<div class="line">                    end tell</div>
<div class="line">                    tell (make dialog column)</div>
<div class="line">                        <span class="keyword">set</span> myLayerDropdown to make dropdown with properties {<span class="keywordtype">string</span> list:myLayerNames, selected index:0}</div>
<div class="line">                    end tell</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myResult to show myDialog</div>
<div class="line">        <span class="keywordflow">if</span> myResult is <span class="keyword">true</span> then</div>
<div class="line">            <span class="keyword">set</span> myLabelType to (selected index of myLabelTypeDropdown)</div>
<div class="line">            <span class="keyword">set</span> myLabelHeight to edit value of myLabelHeightField</div>
<div class="line">            <span class="keyword">set</span> myLabelOffset to edit value of myLabelOffsetField</div>
<div class="line">            <span class="keyword">set</span> myLabelStyleName to item ((selected index of myLabelStyleDropdown) + 1) of myStyleNames</div>
<div class="line">            set myLayerName to item ((selected index of myLayerDropdown) + 1) of myLayerNames</div>
<div class="line">            destroy myDialog</div>
<div class="line">            tell view preferences of document 1</div>
<div class="line">                set myOldXUnits to horizontal measurement units</div>
<div class="line">                set myOldYUnits to vertical measurement units</div>
<div class="line">                set horizontal measurement units to points</div>
<div class="line">                set vertical measurement units to points</div>
<div class="line">            end tell</div>
<div class="line">            repeat with myCounter from 1 to (count myObjectList)</div>
<div class="line">                set myGraphic to item myCounter of myObjectList</div>
<div class="line">                my myAddLabel(myGraphic, myLabelType, myLabelHeight, myLabelOffset, myLabelStyleName, myLayerName)</div>
<div class="line">            end repeat</div>
<div class="line">            tell view preferences of document 1</div>
<div class="line">                set horizontal measurement units to myOldXUnits</div>
<div class="line">                set vertical measurement units to myOldYUnits</div>
<div class="line">            end tell</div>
<div class="line">        else</div>
<div class="line">            destroy myDialog</div>
<div class="line">        end if</div>
<div class="line">    end tell</div>
<div class="line">end myDisplayDialog</div>
<div class="line"></div>
<div class="line">on myAddLabel(myGraphic, myLabelType, myLabelHeight, myLabelOffset, myLabelStyleName, myLayerName)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myDocument to document 1</div>
<div class="line">        set myLabelStyle to paragraph style myLabelStyleName of myDocument</div>
<div class="line">        try</div>
<div class="line">            set myLabelLayer to layer myLayerName of myDocument</div>
<div class="line">        on error</div>
<div class="line">            tell myDocument</div>
<div class="line">                set myLabelLayer to make layer with properties {name:myLayerName}</div>
<div class="line">            end tell</div>
<div class="line">        end <span class="keywordflow">try</span></div>
<div class="line">        <span class="keyword">set</span> myLink to item link of myGraphic</div>
<div class="line">        <span class="keywordflow">if</span> myLabelType is 0 then</div>
<div class="line">            <span class="keyword">set</span> myLabel to name of myLink</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> myLabelType is 1 then</div>
<div class="line">            <span class="keyword">set</span> myLabel to file path of myLink</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> myLabelType is 2 then</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myLabel to author of link xmp of myLink</div>
<div class="line">            on error</div>
<div class="line">                <span class="keyword">set</span> myLabel to <span class="stringliteral">&quot;No author available.&quot;</span></div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> myLabelType is 3 then</div>
<div class="line">            <span class="keywordflow">try</span></div>
<div class="line">                <span class="keyword">set</span> myLabel to description of link xmp of myLink</div>
<div class="line">            on error</div>
<div class="line">                <span class="keyword">set</span> myLabel to <span class="stringliteral">&quot;No description available.&quot;</span></div>
<div class="line">            end <span class="keywordflow">try</span></div>
<div class="line">        end <span class="keywordflow">if</span></div>
<div class="line">        <span class="keyword">set</span> myFrame to parent of myGraphic</div>
<div class="line">        <span class="keyword">set</span> myBounds to geometric bounds of myFrame</div>
<div class="line">        <span class="keyword">set</span> myX1 to item 2 of myBounds</div>
<div class="line">        <span class="keyword">set</span> myY1 to (item 3 of myBounds) + myLabelOffset</div>
<div class="line">        <span class="keyword">set</span> myX2 to item 4 of myBounds</div>
<div class="line">        <span class="keyword">set</span> myY2 to myY1 + myLabelHeight</div>
<div class="line">        tell parent of myFrame</div>
<div class="line">            <span class="keyword">set</span> myTextFrame to make text frame with properties {item layer:myLabelLayer, contents:myLabel, geometric bounds:{myY1, myX1, myY2, myX2}}</div>
<div class="line">            <span class="keyword">set</span> first baseline offset of text frame preferences of myTextFrame to leading offset</div>
<div class="line">            tell myTextFrame</div>
<div class="line">                <span class="keyword">set</span> applied paragraph style of paragraph 1 to myLabelStyle</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">end myAddLabel</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_as_working_with_preflight"></a>
Working with Preflight</h1>
<p>Preflight is a way to verify that you have all required files, fonts, assets (e.g., placed images and PDF files), printer settings, trapping styles, etc., before you send a publication to an output device. For example, if you placed an image as a low-resolution proxy but do not have the high-resolution original image accessible on your hard disk (or workgroup server), that may result in an error during the printing process. Preflight checks for this sort of problem. It can be run in the background as you work.</p>
<p>This section demonstrates how to interact with the preflight system using scripting. For illustration purposes, we show how to configure preflight to raise an error if the page size is something other than letter size (8.5" x 11"). We briefly highlight how it is done in the user interface, then show how to achieve the same results through scripting.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script.</p>
<h2><a class="anchor" id="id_as_exploring_preflight_profiles"></a>
Exploring Preflight Profiles</h2>
<p>InDesign's preflight feature is profile based, rule driven, and parameterized. There might be one or more preflight profiles. Initially, there is one profile, [Basic], which is read-only; you cannot modify or delete it.</p>
<p>A preflight profile contains many preflight rules. Each rule has a name and multiple data objects. Each data object has a name, data type, and data value. The data value can be changed. Each rule can be configured as follows:</p>
<ul>
<li>Disabled - The preflight rule is disabled.</li>
<li>Return as error - The preflight rule returns error-level feedback.</li>
<li>Return as warning - The preflight rule returns warning-level feedback.</li>
<li>Return as informational - The preflight rule returns informational-level feedback.</li>
</ul>
<p>To check the profile in InDesign, choose Preflight Panel &gt; Define Profiles. You also can get profile information by scripting.</p>
<h3><a class="anchor" id="id_as_listing_preflight_profiles"></a>
Listing preflight profiles</h3>
<p>This script fragment shows how to list all preflight profiles. For the complete script, see ListPreflightProfiles. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myProfiles to preflight profiles</div>
<div class="line">        <span class="keyword">set</span> myProfileCount to count of myProfiles</div>
<div class="line">        <span class="keyword">set</span> myStr to <span class="stringliteral">&quot;Preflight profiles: &quot;</span></div>
<div class="line">        repeat with i from 1 to myProfileCount</div>
<div class="line">            <span class="keywordflow">if</span> i &gt; 1 then</div>
<div class="line">                <span class="keyword">set</span> myStr to myStr &amp; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">            <span class="keyword">set</span> myStr to myStr &amp; name of item i of myProfiles</div>
<div class="line">        end repeat</div>
<div class="line">        display alert myStr</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_listing_preflight_rules"></a>
Listing preflight rules</h3>
<p>This script fragment shows how to list all preflight rules in a profile. For the complete script, see ListPreflightRules. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        -- Assume the [Basic] profile exists.</div>
<div class="line">        <span class="keyword">set</span> myProfile to item 1 of preflight profiles</div>
<div class="line">        <span class="keyword">set</span> myRules to preflight profile rules of myProfile</div>
<div class="line">        <span class="keyword">set</span> ruleCount to count of myRules</div>
<div class="line">        <span class="keyword">set</span> str to <span class="stringliteral">&quot;Preflight rules of &quot;</span> &amp; name of myProfile &amp; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line">        repeat with i from 1 to ruleCount</div>
<div class="line">            <span class="keywordflow">if</span> i &gt; 1 then</div>
<div class="line">                <span class="keyword">set</span> str to str &amp; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">            <span class="keyword">set</span> str to str &amp; name of item i of myRules</div>
<div class="line">        end repeat</div>
<div class="line">        display alert str</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_listing_preflight_data_objects"></a>
Listing preflight data objects</h3>
<p>This script fragment shows how to list all preflight data objects in a profile rule. For the complete script, see ListPreflightDataObjects. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myProfile to item 1 of preflight profiles</div>
<div class="line">        <span class="keyword">set</span> myRule to item 1 of preflight profile rules of myProfile</div>
<div class="line">        <span class="keyword">set</span> dataObjects to rule data objects of myRule</div>
<div class="line">        <span class="keyword">set</span> dataObjectCount to count of dataObjects</div>
<div class="line">        <span class="keyword">set</span> str to <span class="stringliteral">&quot;Preflight rule data objects of &quot;</span> &amp; name of myProfile &amp; <span class="stringliteral">&quot;.&quot;</span> &amp; name of myRule &amp; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line">        repeat with i from 1 to dataObjectCount</div>
<div class="line">            <span class="keywordflow">if</span> i &gt; 1 then</div>
<div class="line">                <span class="keyword">set</span> str to str &amp; <span class="stringliteral">&quot;; &quot;</span></div>
<div class="line">            end <span class="keywordflow">if</span></div>
<div class="line">            <span class="keyword">set</span> myObject to item i of dataObjects</div>
<div class="line">            <span class="keyword">set</span> str to str &amp; name of myObject &amp; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">            <span class="keyword">set</span> str to str &amp; data type of myObject &amp; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">            <span class="keyword">set</span> str to str &amp; data value of myObject</div>
<div class="line">        end repeat</div>
<div class="line">        display alert str</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_importing_a_preflight_profile"></a>
Importing a Preflight Profile</h2>
<p>To import a preflight profile from the Preflight panel, choose Preflight Panel &gt; Define Profiles, then choose Load Profile from the drop-down menu in the Preflight Profiles window.</p>
<div class="image">
<img src="InDesign_ScriptingGuide-8.gif" alt="InDesign_ScriptingGuide-8.gif"/>
</div>
<p>You also can load a profile with scripting. The following script fragment imports a profile called Test. For the complete script, see ImportPreflightProfile. </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myProfile to load preflight profile from <span class="stringliteral">&quot;Macintosh HD:tmp:Test.idpp&quot;</span></div>
<div class="line">        <span class="keywordflow">if</span> myProfile is nothing then</div>
<div class="line">            display alert <span class="stringliteral">&quot;The profile did not load successfully&quot;</span></div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            display alert <span class="stringliteral">&quot;Preflight profile &quot;</span> &amp; (name of myProfile) &amp; <span class="stringliteral">&quot; is loaded.&quot;</span></div>
<div class="line">        end <span class="keywordflow">if</span></div>
</div><!-- fragment --><p> It is easier to create profiles using the Preflight panel than with scripting. One workflow would be to create all profiles in the user interface, export them to files, and import them using scripting. This approach avoids the challenges involved with manually adding rules via scripting.</p>
<h2><a class="anchor" id="id_as_creating_a_preflight_profile"></a>
Creating a Preflight Profile</h2>
<p>To create a preflight profile from the Preflight panel, choose Preflight Panel &gt; Define Profiles, then choose the plus sign (+) to add a new preflight profile. Name the profile and fill in all data values for the available rules.</p>
<div class="image">
<img src="InDesign_ScriptingGuide-9.gif" alt="InDesign_ScriptingGuide-9.gif"/>
</div>
<p>You also can create a profile with scripting. The following script fragment adds a single profile called Test. For the complete script, see CreatePreflightProfile. </p>
<div class="fragment"><div class="line">        --Add a <span class="keyword">new</span> preflight profile.</div>
<div class="line">        <span class="keyword">set</span> myProfile to make preflight profile</div>
<div class="line">        display alert <span class="stringliteral">&quot;Preflight profile &quot;</span> &amp; (name of myProfile) &amp; <span class="stringliteral">&quot; is created.&quot;</span></div>
<div class="line">        --Rename the profile</div>
<div class="line">        tell myProfile</div>
<div class="line">            <span class="keyword">set</span> oldName to name</div>
<div class="line">            <span class="keyword">set</span> name to <span class="stringliteral">&quot;Test&quot;</span></div>
<div class="line">            <span class="keyword">set</span> description to <span class="stringliteral">&quot;Test description&quot;</span></div>
<div class="line">        end tell</div>
<div class="line">        display alert <span class="stringliteral">&quot;Profile &quot;</span> &amp; oldName &amp; <span class="stringliteral">&quot; is renamed to &quot;</span> &amp; (name of myProfile) &amp; <span class="stringliteral">&quot;.&quot;</span></div>
</div><!-- fragment --><p> Preflight-profile names must be unique. If the script above is executed more than once within the same InDesign instance, an error is raised, indicating that a profile with that name already exists. To avoid this, either access the existing profile using app.preflightProfiles.itemByName(), or check to see if a profile exists and remove it; see the following script fragment. For the complete script, see DeletePreflightProfile. </p>
<div class="fragment"><div class="line">on removeProfile(profileName)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        set myProfiles to preflight profiles</div>
<div class="line">        set profileCount to count of myProfiles</div>
<div class="line">        repeat with i from 1 to profileCount</div>
<div class="line">            if name of item i of myProfiles is equal to profileName then</div>
<div class="line">                delete item i of myProfiles</div>
<div class="line">            end if</div>
<div class="line">        end repeat</div>
<div class="line">    end tell</div>
<div class="line">end removeProfile</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_adding_rules"></a>
Adding Rules</h2>
<p>A preflight profile contains a mutually exclusive set of rules. To add a rule to a profile, follow these steps:</p>
<ol type="1">
<li>Add a rule to a profile by name. Rules are added by name. For information on rule names, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_available_rules">Available Rules</a>. The following adds the ADBE_PageSizeOrientation rule to the profile. <div class="fragment"><div class="line">--Add a rule that requires a specific page size and orientation </div>
<div class="line">--(portrait or landscape).</div>
<div class="line"><span class="keyword">set</span> RULE_NAME to <span class="stringliteral">&quot;ADBE_PageSizeOrientation&quot;</span></div>
<div class="line"><span class="keyword">set</span> myRule to make preflight profile rule in myProfile with properties {name:RULE_NAME, <span class="keywordtype">id</span>:RULE_NAME}</div>
</div><!-- fragment --></li>
<li>Set the rule's data values. Many, but not all, rules have data properties. For a complete specification of the rules available with InDesign, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_available_rules">Available Rules</a>. The ADBE_PageSizeOrientation rule contains particular data properties that allow you to specify a page size. The following sets the acceptable page height and width, a tolerance (fudge factor), and an option for handling page orientation. <div class="fragment"><div class="line">tell myRule</div>
<div class="line">    --Requires the page size to be 8.5in x 11in (Letter Size)</div>
<div class="line">    --enters a value <span class="keywordflow">for</span> tolerance  make rule data <span class="keywordtype">object</span> with properties {name:<span class="stringliteral">&quot;tolerance&quot;</span>, data type:real datatype, data value:0.01}</div>
<div class="line">    --Sets the width  to the point equivalent of 8.5 inches make rule data <span class="keywordtype">object</span> with properties {name:<span class="stringliteral">&quot;width&quot;</span>, data type:real data type, data value:612}</div>
<div class="line">    --Sets the width  to the point equivalent of 11 inches</div>
<div class="line">    make rule data <span class="keywordtype">object</span> with properties {name:<span class="stringliteral">&quot;height&quot;</span>, data type:real data type, data value:792}</div>
<div class="line">    --<span class="keyword">true</span> = ignore orientation is checked</div>
<div class="line">    make rule data <span class="keywordtype">object</span> with properties {name:<span class="stringliteral">&quot;ignore_orientation&quot;</span>, data type:<span class="keywordtype">boolean</span> data type, data value:<span class="keyword">true</span>}</div>
<div class="line">end tell</div>
</div><!-- fragment --></li>
<li>Set the rule's reporting state. This is done using the rule's flag property. There are several choices (disabled, information, warning, and error), controlled by the PreflightRuleFlag enumeration. <div class="fragment"><div class="line">--<span class="keyword">set</span> the rule to <span class="keywordflow">return</span> an error</div>
<div class="line"><span class="keyword">set</span> flag of myRule to <span class="keywordflow">return</span> as error</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="id_as_processing_a_profile"></a>
Processing a Profile</h2>
<p>In the desktop version of InDesign, preflight errors are reported in the user interface. In scripting (especially for InDesign Server), the errors are generated on demand. The following script processes an InDesign document. (For the complete script, see ProcessPreflightProfile.) If there are errors, it writes the results to a new PDF file. For an example of the output, see the figure below the script. </p>
<div class="fragment"><div class="line">        --Assume there is an document.</div>
<div class="line">        <span class="keyword">set</span> myDoc to document 1</div>
<div class="line">        --Use the second preflight profile</div>
<div class="line">        <span class="keyword">set</span> myProfile to preflight profile 2</div>
<div class="line">        </div>
<div class="line">        --Process the doc with the profile</div>
<div class="line">        <span class="keyword">set</span> myProcess to make preflight process with properties {target <span class="keywordtype">object</span>:myDoc, applied profile:myProfile}</div>
<div class="line">        wait <span class="keywordflow">for</span> process myProcess</div>
<div class="line">        <span class="keyword">set</span> results to process results of myProcess</div>
<div class="line">        </div>
<div class="line">        -- If errors were found</div>
<div class="line">        <span class="keywordflow">if</span> results is not <span class="stringliteral">&quot;None&quot;</span> then</div>
<div class="line">            -- Export the file to PDF, and to open the file after export.</div>
<div class="line">            save report myProcess to <span class="stringliteral">&quot;Macintosh HD:tmp:PreflightResults.pdf&quot;</span> with <span class="keyword">auto</span> open</div>
<div class="line">        end <span class="keywordflow">if</span></div>
<div class="line">        </div>
<div class="line">        --Cleanup</div>
<div class="line">        <span class="keyword">delete</span> myProcess</div>
</div><!-- fragment --> <div class="image">
<img src="InDesign_ScriptingGuide-10.gif" alt="InDesign_ScriptingGuide-10.gif"/>
</div>
<p>If you would rather produce a text file, simply name your output file with a .txt extension.</p>
<p>Alternately, you may prefer to iterate the errors yourself. The following demonstrates how to access the errors array. For the complete script, see ProcessPreflightProfileShowErrors. </p>
<div class="fragment"><div class="line">        --If errors were found</div>
<div class="line">        <span class="keywordflow">if</span> results is not <span class="stringliteral">&quot;None&quot;</span> then</div>
<div class="line">            --array containing detailed results</div>
<div class="line">            tell aggregated results of myProcess</div>
<div class="line">                <span class="keyword">set</span> str to <span class="stringliteral">&quot;Document: &quot;</span> &amp; item 1 &amp; <span class="stringliteral">&quot;, Profile: &quot;</span> &amp; item 2 &amp; <span class="stringliteral">&quot;, Results: [&quot;</span></div>
<div class="line">                <span class="keyword">set</span> errorResults to item 3</div>
<div class="line">            end tell</div>
<div class="line">            --Show the errors in a message box.</div>
<div class="line">            repeat with i from 1 to count of errorResults</div>
<div class="line">                <span class="keywordflow">if</span> i &gt; 1 then</div>
<div class="line">                    str = str &amp; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">                end <span class="keywordflow">if</span></div>
<div class="line">                <span class="keyword">set</span> str to str &amp; item 2 of item i of errorResults</div>
<div class="line">            end repeat</div>
<div class="line">            <span class="keyword">set</span> str to str &amp; <span class="stringliteral">&quot;]&quot;</span></div>
<div class="line">            display alert str</div>
<div class="line">        end <span class="keywordflow">if</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_custom_rules"></a>
Custom Rules</h2>
<p>It is not possible to create custom rules through the Preflight panel or scripting; however, this can be done through a C++ plug-in. The InDesign Products SDK contains a sample, PreflightRule, that demonstrates how to add custom rules with a plug-in.</p>
<h2><a class="anchor" id="id_as_available_rules"></a>
Available Rules</h2>
<p>One of the hardest aspects of scripting rules is discovering rule names and properties. Due to the dynamic nature of rules (they really are just strings), specific rule names and properties do not appear in the Extend Script Tool Kit's Object Model Viewer. To discover this information, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_exploring_preflight_profiles">Exploring Preflight Profiles</a>. For your convenience, the DumpPreflightRules.jsx script is provided in the SDK to produce the following output as an HTML file (SDK\docs\references\PreflightRules.html). If you use a plug-in that adds custom rules, you can run the script to extract the new names and properties.</p>
<table class="doxtable">
<tr>
<th>Rule name </th><th>Rule properties </th></tr>
<tr>
<td>ADBE_BlankPages </td><td>"ADBE_BlankPages" </td></tr>
<tr>
<td>ADBE_BleedSlug </td><td>"ADBE_BleedSlug" </td></tr>
<tr>
<td>ADBE_BleedTrimHazard </td><td>"ADBE_BleedTrimHazard" </td></tr>
<tr>
<td>ADBE_CMYPlates </td><td>no </td></tr>
<tr>
<td>ADBE_Colorspace </td><td>"ADBE_Colorspace" </td></tr>
<tr>
<td>ADBE_ConditionIndicators </td><td>no </td></tr>
<tr>
<td>ADBE_CrossReferences </td><td>"ADBE_CrossReferences" </td></tr>
<tr>
<td>ADBE_FontUsage </td><td>"ADBE_FontUsage" </td></tr>
<tr>
<td>ADBE_ImageColorManagement </td><td>"ADBE_ImageColorManagement" </td></tr>
<tr>
<td>ADBE_ImageResolution </td><td>"ADBE_ImageResolution" </td></tr>
<tr>
<td>ADBE_InteractiveContent </td><td>no </td></tr>
<tr>
<td>ADBE_LayerVisibility </td><td>no </td></tr>
<tr>
<td>ADBE_MissingFonts </td><td>no </td></tr>
<tr>
<td>ADBE_MissingGlyph </td><td>no </td></tr>
<tr>
<td>ADBE_MissingModifiedGraphics </td><td>no </td></tr>
<tr>
<td>ADBE_OPI </td><td>no </td></tr>
<tr>
<td>ADBE_Overprint </td><td>no </td></tr>
<tr>
<td>ADBE_OversetText </td><td>no </td></tr>
<tr>
<td>ADBE_PageCount </td><td>"ADBE_PageCount" </td></tr>
<tr>
<td>ADBE_PageSizeOrientation </td><td>"ADBE_PageSizeOrientation" </td></tr>
<tr>
<td>ADBE_Registration </td><td>no </td></tr>
<tr>
<td>ADBE_ScaledGraphics </td><td>"ADBE_ScaledGraphics" </td></tr>
<tr>
<td>ADBE_ScaledType </td><td>"ADBE_ScaledType" </td></tr>
<tr>
<td>ADBE_SmallText </td><td>"ADBE_SmallText" </td></tr>
<tr>
<td>ADBE_SpellCheck </td><td>no </td></tr>
<tr>
<td>ADBE_SpotColorSetup </td><td>"ADBE_SpotColorSetup" </td></tr>
<tr>
<td>ADBE_StrokeRequirements </td><td>"ADBE_StrokeRequirements" </td></tr>
<tr>
<td>ADBE_TextOverrides </td><td>"ADBE_TextOverrides" </td></tr>
<tr>
<td>ADBE_TransparencyBlending </td><td>"ADBE_TransparencyBlending" </td></tr>
<tr>
<td>ADBE_TransparencyUsage </td><td>no </td></tr>
<tr>
<td>ADBE_WhiteOverprint </td><td>no </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_blankpages"></a>
ADBE_BlankPages</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value</th></tr>
<tr>
<td>Boolean </td><td>ignore_master </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>ignore_nonprinting </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_bleedslug"></a>
ADBE_BleedSlug</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>bleed_b </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_b_aux </td><td>9 </td></tr>
<tr>
<td>Integer </td><td>bleed_comparison_type </td><td>3 </td></tr>
<tr>
<td>Boolean </td><td>bleed_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>bleed_l </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_l_aux </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_r </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_r_aux </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_t </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_t_aux </td><td>9 </td></tr>
<tr>
<td>Real </td><td>slug_b </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_b_aux </td><td>18 </td></tr>
<tr>
<td>Integer </td><td>slug_comparison_type </td><td>3 </td></tr>
<tr>
<td>Boolean </td><td>slug_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>slug_l </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_l_aux </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_r </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_r_aux </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_t </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_t_aux </td><td>18 </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.01 </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_bleedtrimhazard"></a>
ADBE_BleedTrimHazard</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>binding_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>binding_width </td><td>1 </td></tr>
<tr>
<td>Real </td><td>live_b </td><td>18 </td></tr>
<tr>
<td>Real </td><td>live_l </td><td>18 </td></tr>
<tr>
<td>Real </td><td>live_r </td><td>18 </td></tr>
<tr>
<td>Real </td><td>live_t </td><td>18 </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.01 </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_colorspace"></a>
ADBE_Colorspace</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>no_cmyk </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_gray </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_lab </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_rgb </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_spot </td><td>false </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_crossreferences"></a>
ADBE_CrossReferences</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>xrefs_out_of_date </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>xrefs_unresolved </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_fontusage"></a>
ADBE_FontUsage</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>no_ATC </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_Bitmap </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_CID </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_MultipleMaster </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_OpenTypeCFF </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_OpenTypeCID </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_OpenTypeTT </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_TrueType </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_Type1 </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_protected </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_imagecolormanagement"></a>
ADBE_ImageColorManagement</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>no_cmyk_profiles </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>no_image_overrides </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>overrides_exclude_uncal </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_imageresolution"></a>
ADBE_ImageResolution</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>bw_max_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>bw_max_res </td><td>2400 </td></tr>
<tr>
<td>Boolean </td><td>bw_min_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>bw_min_res </td><td>800 </td></tr>
<tr>
<td>Boolean </td><td>color_max_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>color_max_res </td><td>1200 </td></tr>
<tr>
<td>Boolean </td><td>color_min_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>color_min_res </td><td>250 </td></tr>
<tr>
<td>Boolean </td><td>gray_max_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>gray_max_res </td><td>1200 </td></tr>
<tr>
<td>Boolean </td><td>gray_min_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>gray_min_res </td><td>250 </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.5 </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_pagecount"></a>
ADBE_PageCount</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Integer </td><td>comparison_type </td><td>2 </td></tr>
<tr>
<td>Integer </td><td>comparison_value </td><td>1 </td></tr>
<tr>
<td>Integer </td><td>comparison_value_aux </td><td>1 </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_pagesizeorientation"></a>
ADBE_PageSizeOrientation</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>height </td><td>792 </td></tr>
<tr>
<td>Boolean </td><td>ignore_orientation </td><td>false </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.01 </td></tr>
<tr>
<td>Real </td><td>width </td><td>612 </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_scaledgraphics"></a>
ADBE_ScaledGraphics</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>max_scale </td><td>100.5 </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_scaledtype"></a>
ADBE_ScaledType</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>ignore_justification </td><td>true </td></tr>
<tr>
<td>Real </td><td>max_scale </td><td>100.5 </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_smalltext"></a>
ADBE_SmallText</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>minSize </td><td>4 </td></tr>
<tr>
<td>Boolean </td><td>minSize_trap_safe_only </td><td>false </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_spotcolorsetup"></a>
ADBE_SpotColorSetup</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>lab_spots </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>lab_spots_enabled </td><td>false </td></tr>
<tr>
<td>Integer </td><td>max_spots </td><td>1 </td></tr>
<tr>
<td>Boolean </td><td>max_spots_enabled </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_strokerequirements"></a>
ADBE_StrokeRequirements</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>min_width </td><td>0.125 </td></tr>
</table>
<p>Boolean | min_width_trap_safe_only | false</p>
<h3><a class="anchor" id="id_as_adbe_textoverrides"></a>
ADBE_TextOverrides</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>ignore_color_overrides </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>ignore_font_overrides </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>ignore_kerning_tracking_overrides </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>ignore_language_overrides </td><td>false </td></tr>
</table>
<h3><a class="anchor" id="id_as_adbe_transparencyblending"></a>
ADBE_TransparencyBlending</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Integer </td><td>space </td><td>3 </td></tr>
</table>
<h1><a class="anchor" id="id_as_creating_dynamic_documents"></a>
Creating Dynamic Documents</h1>
<p>InDesign can create documents for web and online use, also known as Rich Interactive Documents (RID). Dynamic documents contain sounds, animations, hyperlinks, and other interactive content. InDesign documents can be exported to SWF, XFL, or PDF. For SWF and XFL files, documents can include animations, buttons, multistate objects, movies, and sound clips. You can use the Preview panel in InDesign to test some types of dynamic content before exporting.</p>
<p>This section shows how to create dynamic documents using scripting. For more on exporting as PDF, SWF, and XFL, refer to <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_documents">Documents</a>.</p>
<h2><a class="anchor" id="id_as_importing_movies_and_sounds"></a>
Importing Movies and Sounds</h2>
<p>InDesign can import movie and sound files that can then be viewed or listened to in exported PDF, SWF, or XFL documents. Movies and sounds in an InDesign document are very similar to graphics in that they exist inside container objects on an InDesign page. Unlike graphics, however, you cannot see (or hear) the content of the imported multimedia files on an InDesign page. For that, you'll need to either view the page in the Preview panel, or export the file, then open the file in a viewer capable of displaying the content (such as Acrobat Reader or a web browser).</p>
<p>Scripts can control the playback properties of a sound or movie in an exported dynamic document. You can also add a preview, or "poster," image to the page item containing the sound or movie.</p>
<p>The following script fragment shows how to import a movie and control the way that the movie is shown and played in an exported document (for the complete script, refer to PlaceMovie). </p>
<div class="fragment"><div class="line">        --Given a page <span class="stringliteral">&quot;myPage&quot;</span>... </div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myFrame to make rectangle with properties {geometric bounds:{72, 72, 288, 288}}</div>
<div class="line">        end tell</div>
<div class="line">        --Import a movie file (you<span class="stringliteral">&#39;ll have to provide a valid file path on your system)</span></div>
<div class="line"><span class="stringliteral">        tell myFrame to place file &quot;hazuki:movie.mp4&quot;</span></div>
<div class="line"><span class="stringliteral">        set myMovie to movie 1 of myFrame</span></div>
<div class="line"><span class="stringliteral">        --Set movie properties.</span></div>
<div class="line"><span class="stringliteral">        set embed in PDF of myMovie to true</span></div>
<div class="line"><span class="stringliteral">        set show controls of myMovie to true</span></div>
<div class="line"><span class="stringliteral">        get properties of myMovie</span></div>
<div class="line"><span class="stringliteral">        --Add a preview image. You&#39;</span>ll have to provide a valid path on your system.</div>
<div class="line">        <span class="keyword">set</span> poster file of myMovie to <span class="stringliteral">&quot;hazuki:movie poster.jpg&quot;</span></div>
</div><!-- fragment --><p> The following script fragment shows how to import a sound file and control the playback and display of the sound in an exported document (for the complete script, refer to PlaceSound). </p>
<div class="fragment"><div class="line">        --Given a page <span class="stringliteral">&quot;myPage&quot;</span> in a document <span class="stringliteral">&quot;myDocument...&quot;</span> </div>
<div class="line">        --Import a sound file (you<span class="stringliteral">&#39;ll have to provide a valid file path on your system)</span></div>
<div class="line"><span class="stringliteral">        tell myPage</span></div>
<div class="line"><span class="stringliteral">            set mySound to place file &quot;hazuki:sound.mp3&quot; place point {72, 72}</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">        set mySound to item 1 of mySound</span></div>
<div class="line"><span class="stringliteral">        tell mySound</span></div>
<div class="line"><span class="stringliteral">            set embed in PDF to true</span></div>
<div class="line"><span class="stringliteral">            set do not print poster to true</span></div>
<div class="line"><span class="stringliteral">            set sound loop to true</span></div>
<div class="line"><span class="stringliteral">            set stop on page turn to true</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">        --Add a preview image. You&#39;</span>ll have to provide a valid path on your system.</div>
<div class="line">        <span class="keyword">set</span> poster file of mySound to <span class="stringliteral">&quot;hazuki:sound poster.jpg&quot;</span></div>
</div><!-- fragment --><p> Buttons can be used to control the playback of sounds and movies. For information on how to script buttons, see the next section.</p>
<h2><a class="anchor" id="id_as_creating_buttons"></a>
Creating Buttons</h2>
<p>Buttons are often used for navigation in dynamic documents. Buttons contain three states, known as "Normal," "Rollover," and "Click," which, in turn, can contain page items such as rectangles, ovals, text frames, or images. The button can display only one state at a time; the other states are displayed when triggered by mouse actions.</p>
<p>Behaviors control what the button does when you perform a specific mouse action. Behaviors correspond to the Actions shown in the Buttons panel in InDesign's user interface. Buttons can contain multiple behaviors.</p>
<p>The following script fragment shows how to create a simple button that displays the next page in an exported PDF or SWF (for the complete script, refer to SimpleButton). This button makes use of only the Normal state. </p>
<div class="fragment"><div class="line">        --Given a page <span class="stringliteral">&quot;myPage&quot;</span> and a document containing the color <span class="stringliteral">&quot;Red&quot;</span>...</div>
<div class="line">        --Make a button by converting a page item.</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myRightArrow to make polygon with properties {fill color:<span class="stringliteral">&quot;Red&quot;</span>, name:<span class="stringliteral">&quot;GoToNextPageButton&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myRightArrow to {{72, 72}, {144, 108}, {72, 144}}</div>
<div class="line">            <span class="keyword">set</span> myButton to make button with properties {geometric bounds:{72, 72, 144, 144}}</div>
<div class="line">        end tell</div>
<div class="line">        tell state 1 of myButton</div>
<div class="line">            add items to state pageitems {myRightArrow}</div>
<div class="line">        end tell</div>
<div class="line">        tell myButton</div>
<div class="line">            <span class="keyword">set</span> myGoToNextPageBehavior to make <span class="keywordflow">goto</span> next page behavior with properties {behavior <span class="keyword">event</span>:mouse up}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> The following script fragment shows how to create a somewhat more complicated button, containing page items that change the appearance of each of the three button states. For the complete script, refer to ButtonStates.</p>
<div class="fragment"><div class="line">        --Given a page <span class="stringliteral">&quot;myPage&quot;</span> in a document <span class="stringliteral">&quot;myDocument,&quot;</span> containing the colors</div>
<div class="line">        --<span class="stringliteral">&quot;Blue&quot;</span> and <span class="stringliteral">&quot;Red&quot;</span>...</div>
<div class="line">        --Make a button <span class="stringliteral">&quot;from scratch.&quot;</span></div>
<div class="line">        tell page 1 of myDocument</div>
<div class="line">            <span class="keyword">set</span> myButton to make button with properties {geometric bounds:{72, 72, 144, 144}, name:<span class="stringliteral">&quot;GoToNextPageButton&quot;</span>}</div>
<div class="line">        end tell</div>
<div class="line">        tell state 1 of myButton</div>
<div class="line">            <span class="keyword">set</span> myRightArrow to make polygon with properties {fill color:color <span class="stringliteral">&quot;Red&quot;</span> of myDocument, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myRightArrow to {{72, 72}, {144, 108}, {72, 144}}</div>
<div class="line">        end tell</div>
<div class="line">        --Add the Rollover state.</div>
<div class="line">        tell myButton</div>
<div class="line">            <span class="keyword">set</span> myRolloverState to make state</div>
<div class="line">        end tell</div>
<div class="line">        tell myRolloverState</div>
<div class="line">            <span class="keyword">set</span> myRolloverArrow to make polygon with properties {fill color:color <span class="stringliteral">&quot;Red&quot;</span> of myDocument, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myRolloverArrow to {{72, 72}, {144, 108}, {72, 144}}</div>
<div class="line">            --Add a shadow to the polygon in the Rollover state.</div>
<div class="line">        end tell</div>
<div class="line">        tell drop shadow settings of fill transparency settings of myRolloverArrow</div>
<div class="line">            <span class="keyword">set</span> mode to drop</div>
<div class="line">            <span class="keyword">set</span> angle to 90</div>
<div class="line">            <span class="keyword">set</span> x offset to 0</div>
<div class="line">            <span class="keyword">set</span> y offset to 0</div>
<div class="line">            <span class="keyword">set</span> size to 6</div>
<div class="line">        end tell</div>
<div class="line">        tell myButton</div>
<div class="line">            <span class="keyword">set</span> myClickState to make state</div>
<div class="line">        end tell</div>
<div class="line">        tell myClickState</div>
<div class="line">            <span class="keyword">set</span> myClickArrow to make polygon with properties {fill color:color <span class="stringliteral">&quot;Blue&quot;</span> of myDocument, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myClickArrow to {{72, 72}, {144, 108}, {72, 144}}</div>
<div class="line">        end tell</div>
<div class="line">        --Set the behavior <span class="keywordflow">for</span> the button.</div>
<div class="line">        tell myButton</div>
<div class="line">            <span class="keyword">set</span> myGoToNextPageBehavior to make <span class="keywordflow">goto</span> next page behavior with properties {behavior <span class="keyword">event</span>:mouse up}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> Buttons can be used to control the playback of movie and sound files. The following script fragment shows an example of using a set of buttons to control the playback of a moving file (for the complete script, refer to MovieControl). </p>
<div class="fragment"><div class="line">        --Given a page <span class="stringliteral">&quot;myPage&quot;</span> in a document <span class="stringliteral">&quot;myDocument,&quot;</span> </div>
<div class="line">        --containing the colors <span class="stringliteral">&quot;Gray&quot;</span> and <span class="stringliteral">&quot;Red&quot;</span>...</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myFrame to make rectangle with properties {geometric bounds:{72, 72, 288, 288}}</div>
<div class="line">            --Import a movie file (you<span class="stringliteral">&#39;ll have to provide a valid file path on your system)</span></div>
<div class="line"><span class="stringliteral">            tell myFrame to place file &quot;hazuki:movie.mp4&quot;</span></div>
<div class="line"><span class="stringliteral">            --Create the movie &quot;Start&quot; button.</span></div>
<div class="line"><span class="stringliteral">            set myPlayButton to make button with properties {geometric bounds:{294, 186, 354, 282}, name:&quot;PlayMovieButton&quot;}</span></div>
<div class="line"><span class="stringliteral">            tell myPlayButton</span></div>
<div class="line"><span class="stringliteral">                set myRightArrow to make polygon with properties {fill color:color &quot;Gray&quot; of myDocument, stroke color:&quot;None&quot;}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            set entire path of path 1 of myRightArrow to {{186, 294}, {186, 354}, {282, 324}}</span></div>
<div class="line"><span class="stringliteral">            --Add the Rollover state.</span></div>
<div class="line"><span class="stringliteral">            tell myPlayButton</span></div>
<div class="line"><span class="stringliteral">                set myRolloverState to make state</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            --Add a shadow to the polygon in the Rollover state.</span></div>
<div class="line"><span class="stringliteral">            tell myRolloverState</span></div>
<div class="line"><span class="stringliteral">                set myRolloverArrow to make polygon with properties {fill color:color &quot;Gray&quot; of myDocument, stroke color:&quot;None&quot;}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            set entire path of path 1 of myRolloverArrow to {{186, 294}, {186, 354}, {282, 324}}</span></div>
<div class="line"><span class="stringliteral">            tell drop shadow settings of fill transparency settings of myRolloverArrow</span></div>
<div class="line"><span class="stringliteral">                set mode to drop</span></div>
<div class="line"><span class="stringliteral">                set angle to 90</span></div>
<div class="line"><span class="stringliteral">                set x offset to 0</span></div>
<div class="line"><span class="stringliteral">                set y offset to 0</span></div>
<div class="line"><span class="stringliteral">                set size to 6</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell myPlayButton</span></div>
<div class="line"><span class="stringliteral">                set myClickState to make state</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell myClickState</span></div>
<div class="line"><span class="stringliteral">                set myClickArrow to make polygon with properties {fill color:color &quot;Red&quot; of myDocument, stroke color:&quot;None&quot;}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            set entire path of path 1 of myClickArrow to {{186, 294}, {186, 354}, {282, 324}}</span></div>
<div class="line"><span class="stringliteral">            --Set the behavior for the button.</span></div>
<div class="line"><span class="stringliteral">            tell myPlayButton</span></div>
<div class="line"><span class="stringliteral">                set myMovieStartBehavior to make movie behavior with properties {movie item:movie 1 of myFrame, behavior event:mouse up, operation:play}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            --Create the movie &quot;Stop&quot; button.</span></div>
<div class="line"><span class="stringliteral">            set myStopButton to make button with properties {geometric bounds:{294, 78, 354, 174}, name:&quot;StopMovieButton&quot;}</span></div>
<div class="line"><span class="stringliteral">            tell state 1 of myStopButton</span></div>
<div class="line"><span class="stringliteral">                set myNormalRectangle to make rectangle with properties {geometric bounds:{294, 78, 354, 174}, fill color:color &quot;Gray&quot; of myDocument}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell myStopButton</span></div>
<div class="line"><span class="stringliteral">                set myRolloverState to make state</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell myRolloverState</span></div>
<div class="line"><span class="stringliteral">                set myRolloverRectangle to make rectangle with properties {geometric bounds:{294, 78, 354, 174}, fill color:color &quot;Gray&quot; of myDocument}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell drop shadow settings of fill transparency settings of myRolloverRectangle</span></div>
<div class="line"><span class="stringliteral">                set mode to drop</span></div>
<div class="line"><span class="stringliteral">                set angle to 90</span></div>
<div class="line"><span class="stringliteral">                set x offset to 0</span></div>
<div class="line"><span class="stringliteral">                set y offset to 0</span></div>
<div class="line"><span class="stringliteral">                set size to 6</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell myStopButton</span></div>
<div class="line"><span class="stringliteral">                set myClickState to make state</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell myClickState</span></div>
<div class="line"><span class="stringliteral">                set myClickRectangle to make rectangle with properties {geometric bounds:{294, 78, 354, 174}, fill color:color &quot;Red&quot; of myDocument}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell myStopButton</span></div>
<div class="line"><span class="stringliteral">                set myMovieStopBehavior to make movie behavior with properties {movie item:movie 1 of myFrame, behavior event:mouse up, operation:stop}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --><p> Buttons are also important in controlling the appearance of multistate objects, as we'll demonstrate in the next section.</p>
<h2><a class="anchor" id="id_as_creating_multistate_objects"></a>
Creating Multistate Objects</h2>
<p>Multistate objects (or MSOs) are similar to buttons in that they contains states, and that only one state can be visible at a time. They are unlike buttons in that they can contain any number of states; buttons can contain three states, at most. Multistate objects rely on buttons to change the way they display their states.</p>
<p>The following script fragment shows how to create a simple multistate object and add a button to control the display of the states in the object (for the complete script, refer to MultiStateObject). </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and</div>
<div class="line">        --four colors <span class="stringliteral">&quot;myColorA,&quot;</span> <span class="stringliteral">&quot;myColorB,&quot;</span> <span class="stringliteral">&quot;myColorC,&quot;</span> and <span class="stringliteral">&quot;myColorD&quot;</span>...</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myMSO to make multi state <span class="keywordtype">object</span> with properties {name:<span class="stringliteral">&quot;Spinner&quot;</span>, geometric bounds:{72, 72, 144, 144}}</div>
<div class="line">            --New multi-state objects contain two states when they<span class="stringliteral">&#39;re created. Add two more.</span></div>
<div class="line"><span class="stringliteral">            tell myMSO</span></div>
<div class="line"><span class="stringliteral">                set name of state 1 to &quot;Up&quot;</span></div>
<div class="line"><span class="stringliteral">                set name of state 2 to &quot;Right&quot;</span></div>
<div class="line"><span class="stringliteral">                make state with properties {name:&quot;Down&quot;}</span></div>
<div class="line"><span class="stringliteral">                make state with properties {name:&quot;Left&quot;}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            --Add page items to the states.</span></div>
<div class="line"><span class="stringliteral">            tell state 1 of myMSO</span></div>
<div class="line"><span class="stringliteral">                set myPolygon to make polygon with properties {fill color:myColorA, stroke color:&quot;None&quot;}</span></div>
<div class="line"><span class="stringliteral">                set entire path of path 1 of myPolygon to {{72, 144}, {144, 144}, {108, 72}}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell state 2 of myMSO</span></div>
<div class="line"><span class="stringliteral">                set myPolygon to make polygon with properties {fill color:myColorB, stroke color:&quot;None&quot;}</span></div>
<div class="line"><span class="stringliteral">                set entire path of path 1 of myPolygon to {{72, 72}, {72, 144}, {144, 108}}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell state 3 of myMSO</span></div>
<div class="line"><span class="stringliteral">                set myPolygon to make polygon with properties {fill color:myColorC, stroke color:&quot;None&quot;}</span></div>
<div class="line"><span class="stringliteral">                set entire path of path 1 of myPolygon to {{72, 72}, {108, 144}, {144, 72}}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell state 4 of myMSO</span></div>
<div class="line"><span class="stringliteral">                set myPolygon to make polygon with properties {fill color:myColorD, stroke color:&quot;None&quot;}</span></div>
<div class="line"><span class="stringliteral">                set entire path of path 1 of myPolygon to {{144, 72}, {72, 108}, {144, 144}}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --><p> Typically, you'll control the display of the states in a multistate object using a button. The following script fragment shows how to do this (for the complete script, refer to MultiStateObjectControl). </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and</div>
<div class="line">        --four colors <span class="stringliteral">&quot;myColorA,&quot;</span> <span class="stringliteral">&quot;myColorB,&quot;</span> <span class="stringliteral">&quot;myColorC,&quot;</span> and <span class="stringliteral">&quot;myColorD&quot;</span>...</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myMSO to make multi state <span class="keywordtype">object</span> with properties {name:<span class="stringliteral">&quot;Spinner&quot;</span>, geometric bounds:{72, 72, 144, 144}}</div>
<div class="line">            --New multi-state objects contain two states when they<span class="stringliteral">&#39;re created. Add two more.</span></div>
<div class="line"><span class="stringliteral">            tell myMSO</span></div>
<div class="line"><span class="stringliteral">                set name of state 1 to &quot;Up&quot;</span></div>
<div class="line"><span class="stringliteral">                set name of state 2 to &quot;Right&quot;</span></div>
<div class="line"><span class="stringliteral">                make state with properties {name:&quot;Down&quot;}</span></div>
<div class="line"><span class="stringliteral">                make state with properties {name:&quot;Left&quot;}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            --Add page items to the states.</span></div>
<div class="line"><span class="stringliteral">            tell state 1 of myMSO</span></div>
<div class="line"><span class="stringliteral">                set myPolygon to make polygon with properties {fill color:myColorA, stroke color:&quot;None&quot;}</span></div>
<div class="line"><span class="stringliteral">                set entire path of path 1 of myPolygon to {{72, 144}, {144, 144}, {108, 72}}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell state 2 of myMSO</span></div>
<div class="line"><span class="stringliteral">                set myPolygon to make polygon with properties {fill color:myColorB, stroke color:&quot;None&quot;}</span></div>
<div class="line"><span class="stringliteral">                set entire path of path 1 of myPolygon to {{72, 72}, {72, 144}, {144, 108}}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell state 3 of myMSO</span></div>
<div class="line"><span class="stringliteral">                set myPolygon to make polygon with properties {fill color:myColorC, stroke color:&quot;None&quot;}</span></div>
<div class="line"><span class="stringliteral">                set entire path of path 1 of myPolygon to {{72, 72}, {108, 144}, {144, 72}}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell state 4 of myMSO</span></div>
<div class="line"><span class="stringliteral">                set myPolygon to make polygon with properties {fill color:myColorD, stroke color:&quot;None&quot;}</span></div>
<div class="line"><span class="stringliteral">                set entire path of path 1 of myPolygon to {{144, 72}, {72, 108}, {144, 144}}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            set myButton to make button with properties {geometric bounds:{72, 72, 144, 144}}</span></div>
<div class="line"><span class="stringliteral">            tell myButton</span></div>
<div class="line"><span class="stringliteral">                set myRolloverState to make state</span></div>
<div class="line"><span class="stringliteral">                set myClickState to make state</span></div>
<div class="line"><span class="stringliteral">                set myNextStateBehavior to make goto next state behavior with properties {associated multi state object:myMSO, behavior event:mouse down, enable behavior:true, loops to next or previous:true}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            tell myRolloverState</span></div>
<div class="line"><span class="stringliteral">                set myRolloverRectangle to rectangle 1 of group 1</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            set stroke color of myRolloverRectangle to myColorD</span></div>
<div class="line"><span class="stringliteral">            set stroke weight of myRolloverRectangle to 1</span></div>
<div class="line"><span class="stringliteral">            set myStrokeTransparencySettings to stroke transparency settings of myRolloverRectangle</span></div>
<div class="line"><span class="stringliteral">            set myDropShadowSettings to drop shadow settings of myStrokeTransparencySettings</span></div>
<div class="line"><span class="stringliteral">            tell myDropShadowSettings</span></div>
<div class="line"><span class="stringliteral">                set mode to drop</span></div>
<div class="line"><span class="stringliteral">                set angle to 90</span></div>
<div class="line"><span class="stringliteral">                set x offset to 0</span></div>
<div class="line"><span class="stringliteral">                set y offset to 0</span></div>
<div class="line"><span class="stringliteral">                set size to 6</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_working_with_animation"></a>
Working with Animation</h2>
<p>Page items can be animated, adding motion to the dynamic documents you create using InDesign. You apply animation to objects using motion presets, define the movement of animated objects using motion paths, and control the duration of the animation using timing settings, timing lists, and timing groups.</p>
<p>The animation settings of an object control the animation that will be applied to the object. When animation settings have been applied to an object, InDesign sets the has custom settings property of the object to true; if the object is not to be animated, this property is false.</p>
<p>The point at which an animation begins to play, relative to the event that triggers the animation, is controlled by the objects and properties of the timing settings object attached to the page item or to one of its parent containers (usually the spread).</p>
<h3><a class="anchor" id="id_as_basic_animation"></a>
Basic animation</h3>
<p>The following script fragment shows how to create a simple animation (for the complete script, refer to SimpleAnimation). The most basic forms of animation can be applied without using timing settings. </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and a color <span class="stringliteral">&quot;myColorA&quot;</span>...</div>
<div class="line">        --Add a page items to animate.</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myPolygon to make polygon with properties {fill color:myColorA, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> entire path of path 1 of myPolygon to {{72, 72}, {72, 144}, {144, 108}}</div>
<div class="line">        --Create a motion path.</div>
<div class="line">        <span class="keyword">set</span> myMotionPathPoints to {{{{108, 108}, {108, 108}, {108, 108}}, {{516, 108}, {516, 108}, {516, 108}}}, <span class="keyword">true</span>}</div>
<div class="line">        --Set animation preferences <span class="keywordflow">for</span> the polygon. We havent<span class="stringliteral">&#39; set a dynamic trigger</span></div>
<div class="line"><span class="stringliteral">        --for the animation, so the polygon&#39;</span>s animation will be triggered by </div>
<div class="line">        --on page load (the <span class="keywordflow">default</span>).</div>
<div class="line">        tell animation settings of myPolygon</div>
<div class="line">            <span class="keyword">set</span> duration to 2</div>
<div class="line">            <span class="keyword">set</span> motion path points to myMotionPathPoints</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_timingsettings"></a>
TimingSettings</h3>
<p>The timing settings objects of spreads, pages, and page items control the timing of the animation(s) applied to the object and to any objects contained by the object. timing settings contain:</p>
<ul>
<li>timing lists, which define the trigger event (page load, page click, and so on) that start the animation.</li>
<li>timing groups, which associate a page item or series of page items with a specific timing and define the sequence in which animations are shown.</li>
</ul>
<p>timing groups contain timing targets , which define the objects associated with a given timing group. timing targets also specify a delay value for the animation applied to the page item, relative to the start of the animation of the timing group (for the first item in the timing group), or from the start of the previous item in the timing group (for other items in the timing group).</p>
<p>The following script fragment shows how to control the timing of the animation of an object using the various timing objects (for the complete script, refer to TimingSettings). Note that the parameters used to create a timing group specify the properties of the first timing target in the timing group; subsequent timing targets, if any, can be added separately.</p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and the color <span class="stringliteral">&quot;myColorA&quot;</span>,</div>
<div class="line">        --<span class="stringliteral">&quot;myColorB&quot;</span>, and <span class="stringliteral">&quot;myColorC&quot;</span>...</div>
<div class="line">        --Add a page items to animate.</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myPolygonA to make polygon with properties {fill color:myColorA, strokeColor:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myPolygonA to {{72, 72}, {72, 144}, {144, 108}}</div>
<div class="line">            <span class="keyword">set</span> myPolygonB to make polygon with properties {fill color:myColorB, strokeColor:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myPolygonB to {{72, 72}, {72, 144}, {144, 108}}</div>
<div class="line">            <span class="keyword">set</span> myPolygonC to make polygon with properties {fill color:myColorC, strokeColor:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myPolygonC to {{72, 72}, {72, 144}, {144, 108}}</div>
<div class="line">        end tell</div>
<div class="line">        --Create a motion path.</div>
<div class="line">        <span class="keyword">set</span> myMotionPathPoints to {{{{108, 108}, {108, 108}, {108, 108}}, {{516, 108}, {516, 108}, {516, 108}}}, <span class="keyword">true</span>}</div>
<div class="line">        --Set animation preferences <span class="keywordflow">for</span> the polygons.</div>
<div class="line">        tell animation settings of myPolygonA</div>
<div class="line">            <span class="keyword">set</span> duration to 2</div>
<div class="line">            <span class="keyword">set</span> motion path points to myMotionPathPoints</div>
<div class="line">        end tell</div>
<div class="line">        tell animation settings of myPolygonB</div>
<div class="line">            <span class="keyword">set</span> duration to 2</div>
<div class="line">            <span class="keyword">set</span> motion path points to myMotionPathPoints</div>
<div class="line">        end tell</div>
<div class="line">        tell animation settings of myPolygonC</div>
<div class="line">            <span class="keyword">set</span> duration to 2</div>
<div class="line">            <span class="keyword">set</span> motion path points to myMotionPathPoints</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myTimingSettings to timing settings of parent of myPage</div>
<div class="line">        --Remove the <span class="keywordflow">default</span> timing list.</div>
<div class="line">        tell myTimingSettings</div>
<div class="line">            <span class="keyword">delete</span> timing list 1</div>
<div class="line">            --Add a <span class="keyword">new</span> timing list that triggers when the page is clicked.</div>
<div class="line">            <span class="keyword">set</span> myTimingList to make timing list with properties {trigger <span class="keyword">event</span>:on page click}</div>
<div class="line">        end tell</div>
<div class="line">        --Add the polygons to a single timing group.</div>
<div class="line">        tell myTimingList</div>
<div class="line">            <span class="keyword">set</span> myTimingGroup to make timing group with properties {dynamic target:myPolygonA, delay seconds:0}</div>
<div class="line">        end tell</div>
<div class="line">        tell myTimingGroup</div>
<div class="line">            make timing target with properties {dynamic target:myPolygonB, delay seconds:2}</div>
<div class="line">            make timing target with properties {dynamic target:myPolygonC, delay seconds:2}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> Note that attempting to add a page item whose has custom settings property (in the animation settings object of the page item) is false to a timing target generates an error.</p>
<p>The following script fragment shows how to control the sequence of animations applied to objects on a page (for the complete script, refer to MultipleTimingGroups). Note that the order in which timing groups are added to a timing list determines the order in which the animations play when the trigger event specified in the timing list occurs. Some trigger events, such as on page load, trigger the animations in the timing list (in sequence); others, such as on page click , trigger the animations one by one, in sequence, with each instance of the event. For example, a timing list containing five timing groups, each containing a single timing target, and having the trigger event on page click requires five mouse clicks to process all the animations. </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and the color <span class="stringliteral">&quot;myColorA&quot;</span>,</div>
<div class="line">        --<span class="stringliteral">&quot;myColorB&quot;</span>, and <span class="stringliteral">&quot;myColorC&quot;</span>...</div>
<div class="line">        --Add a page items to animate.</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myPolygonA to make polygon with properties {fill color:myColorA, strokeColor:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myPolygonA to {{72, 72}, {72, 144}, {144, 108}}</div>
<div class="line">            <span class="keyword">set</span> myPolygonB to make polygon with properties {fill color:myColorB, strokeColor:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myPolygonB to {{72, 72}, {72, 144}, {144, 108}}</div>
<div class="line">            <span class="keyword">set</span> myPolygonC to make polygon with properties {fill color:myColorC, strokeColor:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myPolygonC to {{72, 72}, {72, 144}, {144, 108}}</div>
<div class="line">            <span class="keyword">set</span> myPolygonD to make polygon with properties {fill color:myColorA, strokeColor:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myPolygonD to {{72, 144}, {72, 216}, {144, 180}}</div>
<div class="line">            <span class="keyword">set</span> myPolygonE to make polygon with properties {fill color:myColorB, strokeColor:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myPolygonE to {{72, 144}, {72, 216}, {144, 180}}</div>
<div class="line">            <span class="keyword">set</span> myPolygonF to make polygon with properties {fill color:myColorC, strokeColor:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myPolygonF to {{72, 144}, {72, 216}, {144, 180}}</div>
<div class="line">        end tell</div>
<div class="line">        --Create a motion path.</div>
<div class="line">        <span class="keyword">set</span> myMotionPathPointsA to {{{{108, 108}, {108, 108}, {108, 108}}, {{516, 108}, {516, 108}, {516, 108}}}, <span class="keyword">true</span>}</div>
<div class="line">        <span class="keyword">set</span> myMotionPathPointsB to {{{{108, 180}, {108, 180}, {108, 180}}, {{516, 180}, {516, 180}, {516, 180}}}, <span class="keyword">true</span>}</div>
<div class="line">        --Set animation preferences <span class="keywordflow">for</span> the polygons. </div>
<div class="line">        --DynamicTriggerEvents.onPageLoad (the <span class="keywordflow">default</span>).</div>
<div class="line">        <span class="keyword">set</span> duration of animation settings of myPolygonA to 2</div>
<div class="line">        <span class="keyword">set</span> motion path points of animation settings of myPolygonA to myMotionPathPointsA</div>
<div class="line">        <span class="keyword">set</span> duration of animation settings of myPolygonB to 2</div>
<div class="line">        <span class="keyword">set</span> motion path points of animation settings of myPolygonB to myMotionPathPointsA</div>
<div class="line">        <span class="keyword">set</span> duration of animation settings of myPolygonC to 2</div>
<div class="line">        <span class="keyword">set</span> motion path points of animation settings of myPolygonC to myMotionPathPointsA</div>
<div class="line">        <span class="keyword">set</span> duration of animation settings of myPolygonD to 2</div>
<div class="line">        <span class="keyword">set</span> motion path points of animation settings of myPolygonD to myMotionPathPointsB</div>
<div class="line">        <span class="keyword">set</span> duration of animation settings of myPolygonE to 2</div>
<div class="line">        <span class="keyword">set</span> motion path points of animation settings of myPolygonE to myMotionPathPointsB</div>
<div class="line">        <span class="keyword">set</span> duration of animation settings of myPolygonF to 2</div>
<div class="line">        <span class="keyword">set</span> motion path points of animation settings of myPolygonF to myMotionPathPointsB</div>
<div class="line">        <span class="keyword">set</span> myTimingSettings to timing settings of parent of myPage</div>
<div class="line">        --Remove the <span class="keywordflow">default</span> timing list.</div>
<div class="line">        tell myTimingSettings</div>
<div class="line">            <span class="keyword">delete</span> timing list 1</div>
<div class="line">            --Add a <span class="keyword">new</span> timing list that triggers when the page is clicked.</div>
<div class="line">            <span class="keyword">set</span> myTimingList to make timing list with properties {trigger <span class="keyword">event</span>:on page click}</div>
<div class="line">            --Add the polygons to a single timing group.</div>
<div class="line">            tell myTimingList</div>
<div class="line">                <span class="keyword">set</span> myTimingGroupA to make timing group with properties {dynamic target:myPolygonA, delay seconds:0}</div>
<div class="line">                tell myTimingGroupA</div>
<div class="line">                    make timing target with properties {dynamic target:myPolygonB, delay seconds:2}</div>
<div class="line">                    make timing target with properties {dynamic target:myPolygonC, delay seconds:2}</div>
<div class="line">                end tell</div>
<div class="line">                --myTimingGroupB will play on the second page click.</div>
<div class="line">                <span class="keyword">set</span> myTimingGroupB to make timing group with properties {dynamic target:myPolygonD, delay seconds:0}</div>
<div class="line">                tell myTimingGroupB</div>
<div class="line">                    make timing target with properties {dynamic target:myPolygonE, delay seconds:2}</div>
<div class="line">                    make timing target with properties {dynamic target:myPolygonF, delay seconds:2}</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> A given timing settings object can contain multiple timing list objects, each of which responds to a different trigger event. The following script fragment shows a series of animations triggered by on page load, by on page click (for the complete script, refer to MultipleTimingLists). </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myTimingSettings to timing settings of parent of myPage</div>
<div class="line">        tell myTimingSettings</div>
<div class="line">            --At <span class="keyword">this</span> point, all of the polygons have already been added as timing targets</div>
<div class="line">            --of the <span class="keywordflow">default</span> timing list. Change the delay of myPolygonB and myPolygonC,</div>
<div class="line">            --which are the targets of the second and third timing groups.</div>
<div class="line">            <span class="keyword">set</span> myTimingListA to timing list 1</div>
<div class="line">            tell myTimingListA</div>
<div class="line">                tell timing group 2</div>
<div class="line">                    <span class="keyword">set</span> delay seconds of timing target 1 to 2</div>
<div class="line">                end tell</div>
<div class="line">                tell timing group 3</div>
<div class="line">                    <span class="keyword">set</span> delay seconds of timing target 1 to 2</div>
<div class="line">                end tell</div>
<div class="line">                --Remove the last three timing groups in the timing list.</div>
<div class="line">                --We have to <span class="keywordflow">do</span> <span class="keyword">this</span>, because we don<span class="stringliteral">&#39;t want these polygons to be</span></div>
<div class="line"><span class="stringliteral">                --animated when the page loads.             </span></div>
<div class="line"><span class="stringliteral">                delete timing group -1</span></div>
<div class="line"><span class="stringliteral">                delete timing group -1</span></div>
<div class="line"><span class="stringliteral">                delete timing group -1</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            --Add a new timing list that triggers when the page is clicked.</span></div>
<div class="line"><span class="stringliteral">            set myTimingListB to make timing list with properties {trigger event:on page click}</span></div>
<div class="line"><span class="stringliteral">            tell myTimingListB</span></div>
<div class="line"><span class="stringliteral">                set myTimingGroupB to make timing group with properties {dynamic target:myPolygonD, delay seconds:0}</span></div>
<div class="line"><span class="stringliteral">                tell myTimingGroupB</span></div>
<div class="line"><span class="stringliteral">                    make timing target with properties {dynamic target:myPolygonE, delay seconds:2}</span></div>
<div class="line"><span class="stringliteral">                    make timing target with properties {dynamic target:myPolygonF, delay seconds:2}</span></div>
<div class="line"><span class="stringliteral">                end tell</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --><p> In the previous examples, we've worked with the timing settings of the spread containing the page items we want to animate. When you want to animate a page item when a user clicks the item, you'll need to use the timing settings of the page item itself, as shown in the following script fragment (for the complete script, refer to PageItemTimingSettings). </p>
<div class="fragment"><div class="line">        --Given a page <span class="stringliteral">&quot;myPage&quot;</span>...</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myPolygonA to make polygon with properties {fill color:myColorA, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myPolygonA to {{72, 72}, {72, 144}, {144, 108}}</div>
<div class="line">            --Create a motion path.</div>
<div class="line">            <span class="keyword">set</span> myMotionPathPointsA to {{{{108, 108}, {108, 108}, {108, 108}}, {{516, 108}, {516, 108}, {516, 108}}}, <span class="keyword">true</span>}</div>
<div class="line">            --Set animation preferences <span class="keywordflow">for</span> the polygon.</div>
<div class="line">            tell animation settings of myPolygonA</div>
<div class="line">                <span class="keyword">set</span> duration to 2</div>
<div class="line">                <span class="keyword">set</span> motion path points to myMotionPathPointsA</div>
<div class="line">            end tell</div>
<div class="line">            --Remove the <span class="keywordflow">default</span> timing list in the timing settings <span class="keywordflow">for</span> the spread.</div>
<div class="line">            <span class="keyword">set</span> myTimingSettings to timing settings of parent of myPage</div>
<div class="line">            tell myTimingSettings</div>
<div class="line">                <span class="keyword">delete</span> timing list 1</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myTimingSettings to timing settings of myPolygonA</div>
<div class="line">            tell myTimingSettings</div>
<div class="line">                <span class="keyword">set</span> myTimingList to make timing list with properties {trigger <span class="keyword">event</span>:on click}</div>
<div class="line">            end tell</div>
<div class="line">            tell myTimingList</div>
<div class="line">                <span class="keyword">set</span> myTimingGroup to make timing group with properties {dynamic target:myPolygonA, delay seconds:0}</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_animating_transformations"></a>
Animating transformations</h3>
<p>Page items can change size, rotation or skewing angles, opacity, and visibility as their animation plays. The animation settings of the page item contain properties (such as rotation array or hidden after) that define the transformations that are applied during animation. The following script fragment shows how to make a page item rotate as it follows a motion path (for the complete script, refer to AnimateRotation). </p>
<div class="fragment"><div class="line">            --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and the color <span class="stringliteral">&quot;myColorA&quot;</span>...</div>
<div class="line">            --Add a page items to animate.</div>
<div class="line">            tell page 1</div>
<div class="line">                <span class="keyword">set</span> myPolygon to make polygon with properties {fill color:myColorA, stroke color:<span class="stringliteral">&quot;None&quot;</span>}</div>
<div class="line">            end tell</div>
<div class="line">            --Create a motion path.</div>
<div class="line">            <span class="keyword">set</span> entire path of path 1 of myPolygon to {{72, 72}, {72, 144}, {144, 108}}</div>
<div class="line">            <span class="keyword">set</span> myMotionPathPoints to {{{{108, 108}, {108, 108}, {108, 108}}, {{516, 108}, {516, 108}, {516, 108}}}, <span class="keyword">true</span>}</div>
<div class="line">            --Set animation preferences <span class="keywordflow">for</span> the polygon.</div>
<div class="line">            tell animation settings of myPolygon</div>
<div class="line">                <span class="keyword">set</span> duration to 2</div>
<div class="line">                <span class="keyword">set</span> motion path points to myMotionPathPoints</div>
<div class="line">                --Assuming 24 Frames Per Second (FPS)</div>
<div class="line">                --23 = 1 second, 47 = 2 seconds, 71 = 3 seconds, 95 = 4 seconds, </div>
<div class="line">                --119 = 5 seconds, 143 = 6 seconds</div>
<div class="line">                --Since the duration of our animation is 2 seconds, the following line will</div>
<div class="line">                --make the polygon rotate 360 degrees from the start to the end</div>
<div class="line">                --of the animation.</div>
<div class="line">                <span class="keyword">set</span> rotation array to {{0, 0}, {47, 360}}</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myTimingSettings to timing settings of parent of myPage</div>
<div class="line">            tell myTimingSettings</div>
<div class="line">                --Remove the <span class="keywordflow">default</span> timing list.</div>
<div class="line">                <span class="keyword">delete</span> timing list 1</div>
<div class="line">                --Add a <span class="keyword">new</span> timing list that triggers when the page is clicked.</div>
<div class="line">                <span class="keyword">set</span> myTimingList to make timing list with properties {trigger <span class="keyword">event</span>:on page click}</div>
<div class="line">                tell myTimingList</div>
<div class="line">                    --Add the polygon to a single timing group.</div>
<div class="line">                    make timing group with properties {dynamic target:myPolygon, delay seconds:0}</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
</div><!-- fragment --><p> Scripting offers more control over animation than can be achieved with InDesign's user interface. A scripted animation can, for example, apply transformations at each key frame of a given motion path. For more on this topic, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_key_frames">Key frames</a> later in this section.</p>
<h3><a class="anchor" id="id_as_motion_presets"></a>
Motion presets</h3>
<p>In the preceding examples, we've constructed motion paths and specified animation settings as if we were creating animations from the basic level in InDesign's user interface. But InDesign can also use motion presets to define the animation of page items in a layout. A motion preset can apply a number of animation properties at once, as seen in the following script fragment (for the complete script, refer to MotionPreset). InDesign comes with a large number of motion presets, and you can add new presets using either the user interface or scripting. </p>
<div class="fragment"><div class="line">        --Given a page containing the ovals <span class="stringliteral">&quot;myOvalA&quot;</span>... </div>
<div class="line">        <span class="keyword">set</span> myMotionPreset to Motion Preset <span class="stringliteral">&quot;move-right-grow&quot;</span></div>
<div class="line">        tell animation settings of myOvalA</div>
<div class="line">            <span class="keyword">set</span> duration to 2</div>
<div class="line">            <span class="keyword">set</span> plays loop to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> preset to myMotionPreset</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_design_options"></a>
Design options</h3>
<p>Design options affect the way that an animated object appears, relative to the motion specified in the object's animation settings. The following script fragment shows how the design options for an animated shape can affect the playback of the animation (for the complete script, refer to DesignOptions). </p>
<div class="fragment"><div class="line">        --Given a page containing the ovals <span class="stringliteral">&quot;myOvalA&quot;</span> and <span class="stringliteral">&quot;myOvalB&quot;</span>... </div>
<div class="line">        <span class="keyword">set</span> myMotionPreset to Motion Preset <span class="stringliteral">&quot;move-right-grow&quot;</span></div>
<div class="line">        tell animation settings of myOvalA</div>
<div class="line">            <span class="keyword">set</span> duration to 2</div>
<div class="line">            <span class="keyword">set</span> plays loop to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> preset to myMotionPreset</div>
<div class="line">            <span class="keyword">set</span> design option to from current appearance</div>
<div class="line">        end tell</div>
<div class="line">        tell animation settings of myOvalB</div>
<div class="line">            <span class="keyword">set</span> duration to 2</div>
<div class="line">            <span class="keyword">set</span> plays loop to <span class="keyword">true</span></div>
<div class="line">            <span class="keyword">set</span> preset to myMotionPreset</div>
<div class="line">            <span class="keyword">set</span> design option to to current appearance</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_key_frames"></a>
Key frames</h3>
<p>Key frames are points in the timeline of an animation. With InDesign scripting, you can add key frames at any time in the animation, which gives you the ability to apply changes to objects as they are animated. Key frames are part of the motion path applied to an animated page item, and are specified relative to the duration and speed of the animation. For example, for an animation with a duration of two seconds, playing at 24 frames per second, the last frame in the animation is frame 48.</p>
<p>The following script fragment shows how to add key frames to a motion path, and how to change the transformations applied to an animated page item at each key frame. For the complete script, refer to TransformAnimation. </p>
<div class="fragment"><div class="line">        --Given a page containing ovals <span class="stringliteral">&quot;myOvalA,&quot;</span> <span class="stringliteral">&quot;myOvalB,&quot;</span> and <span class="stringliteral">&quot;myOvalC&quot;</span>... </div>
<div class="line">        --The motion path is constructed relative to the center of the object, and key frames</div>
<div class="line">        --are based on the duration of the animation divided by the number of frames per second</div>
<div class="line">        --(usually 24). The following array sets key frames at the start, midpoint, and end</div>
<div class="line">        --of a path.</div>
<div class="line">        <span class="keyword">set</span> myMotionPath to {{0, {{0, 0}, {0, 0}, {0, 0}}}, {23, {{234, 0}, {234, 0}, {234, 0}}}, {47, {{468, 0}, {468, 0}, {468, 0}}}}</div>
<div class="line">        tell animation settings of myOvalA</div>
<div class="line">            <span class="keyword">set</span> duration to 2</div>
<div class="line">            <span class="keyword">set</span> motion path to myMotionPath</div>
<div class="line">            --The transformation changes at each key frame.</div>
<div class="line">            --scale x array in the form {{keyframe, scale_percentage}, {keyframe, scalePercentage}, ...}</div>
<div class="line">            <span class="keyword">set</span> scale x array to {{0, 100}, {23, 200}, {47, 100}}</div>
<div class="line">            --scale y array in the form {{keyframe, scale_percentage}, {keyframe, scalePercentage}, ...}</div>
<div class="line">            <span class="keyword">set</span> scale y array to {{0, 100}, {23, 200}, {47, 100}}</div>
<div class="line">            --opacity array in the form {{keyframe, opacity}, {keyframe, opacity},...}</div>
<div class="line">            <span class="keyword">set</span> opacity array to {{0, 100}, {23, 20}, {47, 100}}</div>
<div class="line">            <span class="keyword">set</span> plays loop to <span class="keyword">true</span></div>
<div class="line">        end tell</div>
<div class="line">        tell animation settings of myOvalB</div>
<div class="line">            <span class="keyword">set</span> duration to 2</div>
<div class="line">            <span class="keyword">set</span> motion path to myMotionPath</div>
<div class="line">            <span class="keyword">set</span> scale x array to {{0, 200}, {23, 300}, {47, 50}}</div>
<div class="line">            <span class="keyword">set</span> scale y array to {{0, 200}, {23, 300}, {47, 50}}</div>
<div class="line">            <span class="keyword">set</span> opacity array to {{0, 10}, {23, 80}, {47, 60}}</div>
<div class="line">            <span class="keyword">set</span> plays loop to <span class="keyword">true</span></div>
<div class="line">        end tell</div>
<div class="line">        tell animation settings of myOvalC</div>
<div class="line">            <span class="keyword">set</span> duration to 2</div>
<div class="line">            <span class="keyword">set</span> motion path to myMotionPath</div>
<div class="line">            <span class="keyword">set</span> scale x array to {{0, 50}, {23, 200}, {47, 400}}</div>
<div class="line">            <span class="keyword">set</span> scale y array to {{0, 50}, {23, 200}, {47, 400}}</div>
<div class="line">            <span class="keyword">set</span> opacity array to {{0, 100}, {23, 40}, {47, 80}}</div>
<div class="line">            <span class="keyword">set</span> plays loop to <span class="keyword">true</span></div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_adding_page_transitions"></a>
Adding Page Transitions</h2>
<p>Page transitions are special effects that appear when you change pages in an exported dynamic document. Adding page transitions using scripting is easy, as shown in the following script fragment (for the complete script, refer to PageTransitions). </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing at least two spreads...</div>
<div class="line">        repeat with myCounter from 1 to (count spreads of myDocument)</div>
<div class="line">            <span class="keyword">set</span> page transition type of spread myCounter of myDocument to page turn transition</div>
<div class="line">            --This page transition option does not support the page transition direction options</div>
<div class="line">            --or page transition duration properties. If you chose wipe transition (<span class="keywordflow">for</span> example), </div>
<div class="line">            --you would be able to <span class="keyword">set</span> those options, as shown in the next two lines:</div>
<div class="line">            --<span class="keyword">set</span> page transition direction options of spread myCounter of myDocument to left to right</div>
<div class="line">            --<span class="keyword">set</span> page transition duration of spread myCounter of myDocument to medium</div>
<div class="line">        end repeat</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_as_xml"></a>
XML</h1>
<p>Extensible Markup Language, or XML, is a text-based mark-up system created and managed by the World Wide Web Consortium (www.w3.org). Like Hypertext Markup Language (HTML), XML uses angle brackets to indicate markup tags (for example, &lt;article&gt; or &lt;para&gt;). While HTML has a predefined set of tags, XML allows you to describe content more precisely by creating custom tags.</p>
<p>Because of its flexibility, XML increasingly is used as a format for storing data. InDesign includes a complete set of features for importing XML data into page layouts, and these features can be controlled using scripting.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create and run a script. We also assume that you have some knowledge of XML, DTDs, and XSLT.</p>
<h2><a class="anchor" id="id_as_overview"></a>
Overview</h2>
<p>Because XML is entirely concerned with content and explicitly not concerned with formatting, making XML work in a page-layout context is challenging. InDesign's approach to XML is quite complete and flexible, but it has a few limitations:</p>
<ul>
<li>Once XML elements are imported into an InDesign document, they become InDesign elements that correspond to the XML structure. The InDesign representations of the XML elements are not the same thing as the XML elements themselves.</li>
<li>Each XML element can appear only once in a layout. If you want to duplicate the information of the XML element in the layout, you must duplicate the XML element itself.</li>
<li>The order in which XML elements appear in a layout largely depends on the order in which they appear in the XML structure.</li>
<li>Any text that appears in a story associated with an XML element becomes part of that element's data.</li>
</ul>
<h2><a class="anchor" id="id_as_the_best_approach_to_scripting_xml_in_indesign"></a>
The Best Approach to Scripting XML in InDesign</h2>
<p>You might want to do most of the work on an XML file outside InDesign, before you import the file into an InDesign layout. Working with XML outside InDesign, you can use a wide variety of excellent tools, such as XML editors and parsers.</p>
<p>When you need to rearrange or duplicate elements in a large XML data structure, the best approach is to transform the XML using XSLT. You can do this as you import the XML file.</p>
<p>If the XML data is already formatted in an InDesign document, you probably will want to use XML rules if you are doing more than the simplest of operations. XML rules can search the XML structure in a document and process matching XML elements much faster than a script that does not use XML rules.</p>
<p>For more on working with XML rules, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_xml_rules">XML Rules.</a></p>
<h2><a class="anchor" id="id_as_scripting_xml_elements"></a>
Scripting XML Elements</h2>
<p>This section shows how to set XML preferences and XML import preferences, import XML, create XML elements, and add XML attributes. The scripts in this section demonstrate techniques for working with the XML content itself; for scripts that apply formatting to XML elements, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_adding_xml_elements_to_a_layout">Adding XML Elements to a Layout</a>.</p>
<h3><a class="anchor" id="id_as_setting_xml_preferences"></a>
Setting XML preferences</h3>
<p>You can control the appearance of the InDesign structure panel using the XML view-preferences object, as shown in the following script fragment (from the XMLViewPreferences tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            tell XML view preferences</div>
<div class="line">                <span class="keyword">set</span> show attributes to <span class="keyword">true</span></div>
<div class="line">                <span class="keyword">set</span> show structure to <span class="keyword">true</span></div>
<div class="line">                <span class="keyword">set</span> show tagged frames to <span class="keyword">true</span></div>
<div class="line">                <span class="keyword">set</span> show tag markers to <span class="keyword">true</span></div>
<div class="line">                <span class="keyword">set</span> show text snippets to <span class="keyword">true</span></div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> You also can specify XML tagging preset preferences (the default tag names and user-interface colors for tables and stories) using the XML preferences object., as shown in the following script fragment (from the XMLPreferences tutorial script): </p>
<div class="fragment"><div class="line">            tell XML preferences</div>
<div class="line">                <span class="keyword">set</span> <span class="keywordflow">default</span> cell tag color to blue</div>
<div class="line">                <span class="keyword">set</span> <span class="keywordflow">default</span> cell tag name to <span class="stringliteral">&quot;cell&quot;</span></div>
<div class="line">                <span class="keyword">set</span> <span class="keywordflow">default</span> image tag color to brick red</div>
<div class="line">                <span class="keyword">set</span> <span class="keywordflow">default</span> image tag name to <span class="stringliteral">&quot;image&quot;</span></div>
<div class="line">                <span class="keyword">set</span> <span class="keywordflow">default</span> story tag color to charcoal</div>
<div class="line">                <span class="keyword">set</span> <span class="keywordflow">default</span> story tag name to <span class="stringliteral">&quot;text&quot;</span></div>
<div class="line">                <span class="keyword">set</span> <span class="keywordflow">default</span> table tag color to cute teal</div>
<div class="line">                <span class="keyword">set</span> <span class="keywordflow">default</span> table tag name to <span class="stringliteral">&quot;table&quot;</span></div>
<div class="line">            end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_setting_xml_import_preferences"></a>
Setting XML import preferences</h3>
<p>Before importing an XML file, you can set XML import preferences that can apply an XSLT transform, govern the way white space in the XML file is handled, or create repeating text elements. You do this using the XML import-preferences object, as shown in the following script fragment (from the XMLImportPreferences tutorial script): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            tell XML <span class="keyword">import</span> preferences</div>
<div class="line">                <span class="keyword">set</span> allow transform to <span class="keyword">false</span></div>
<div class="line">                <span class="keyword">set</span> create link to XML to <span class="keyword">false</span></div>
<div class="line">                <span class="keyword">set</span> ignore unmatched incoming to <span class="keyword">true</span></div>
<div class="line">                <span class="keyword">set</span> ignore whitespace to <span class="keyword">true</span></div>
<div class="line">                <span class="keyword">set</span> <span class="keyword">import</span> CALS tables to <span class="keyword">true</span></div>
<div class="line">                <span class="keyword">set</span> <span class="keyword">import</span> style to merge <span class="keyword">import</span></div>
<div class="line">                <span class="keyword">set</span> <span class="keyword">import</span> text into tables to <span class="keyword">false</span></div>
<div class="line">                <span class="keyword">set</span> <span class="keyword">import</span> to selected to <span class="keyword">false</span></div>
<div class="line">                <span class="keyword">set</span> <span class="keyword">remove</span> unmatched existing to <span class="keyword">false</span></div>
<div class="line">                <span class="keyword">set</span> repeat text elements to <span class="keyword">true</span></div>
<div class="line">                --The following properties are only used when the </div>
<div class="line">                --allow transform <span class="keyword">property</span> is <span class="keyword">set</span> to <span class="keyword">true</span>.</div>
<div class="line">                --<span class="keyword">set</span> transform filename to <span class="stringliteral">&quot;yukino:myTransform.xsl&quot;</span></div>
<div class="line">                --If you have defined parameters in your XSL file,</div>
<div class="line">                --you can pass them to the file during the XML <span class="keyword">import</span></div>
<div class="line">                --process. For each parameter, enter a list containing two</div>
<div class="line">                --strings. The first <span class="keywordtype">string</span> is the name of the parameter,</div>
<div class="line">                --the second is the value of the parameter.</div>
<div class="line">                --<span class="keyword">set</span> transform parameters to {{<span class="stringliteral">&quot;format&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>}}</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_importing_xml"></a>
Importing XML</h3>
<p>Once you set the XML import preferences the way you want them, you can import an XML file, as shown in the following script fragment (from the ImportXML tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            --You<span class="stringliteral">&#39;ll need to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">            import XML from &quot;yukino:xml_test.xml&quot;</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --><p> When you need to import the contents of an XML file into a specific XML element, use the importXML method of the XML element, rather than the corresponding method of the document. See the following script fragment (from the ImportXMLIntoElement tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myRootElement to XML element 1</div>
<div class="line">            tell myRootElement</div>
<div class="line">                --You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">                import XML from &quot;yukino:test.xml&quot;</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">            --Place the root XML element so that you can see the result.</span></div>
<div class="line"><span class="stringliteral">            tell story 1</span></div>
<div class="line"><span class="stringliteral">                place XML using myRootElement</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --><p> You also can set the import to selected property of the xml import preferences object to true, then select the XML element, and then import the XML file, as shown in the following script fragment (from the ImportXMLIntoSelectedElement tutorial script): </p>
<div class="fragment"><div class="line">            tell XML <span class="keyword">import</span> preferences</div>
<div class="line">                <span class="keyword">set</span> <span class="keyword">import</span> to selected to <span class="keyword">true</span></div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myRootElement to XML element 1</div>
<div class="line">            <span class="keyword">set</span> myXMLElement to XML element 1 of myRootElement</div>
<div class="line">            select myXMLElement</div>
<div class="line">            --You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">            import XML from &quot;yukino:test.xml&quot;</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_creating_an_xml_tag"></a>
Creating an XML tag</h3>
<p>XML tags are the names of the XML elements you want to create in a document. When you import XML, the element names in the XML file are added to the list of XML tags in the document. You also can create XML tags directly, as shown in the following script fragment (from the MakeXMLTags tutorial script): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            --You can create an XML tag without specifying a color <span class="keywordflow">for</span> the tag.</div>
<div class="line">            <span class="keyword">set</span> myXMLTagA to make XML tag with properties {name:<span class="stringliteral">&quot;XML_tag_A&quot;</span>}</div>
<div class="line">            --You can define the highlight oclor of the XML tag.</div>
<div class="line">            <span class="keyword">set</span> myXMLTagB to make XML tag with properties {name:<span class="stringliteral">&quot;XML_tag_B&quot;</span>, color:gray}</div>
<div class="line">            --...or you can proved an RGB array to <span class="keyword">set</span> the color of the tag.</div>
<div class="line">            <span class="keyword">set</span> myXMLTagC to make XML tag with properties {name:<span class="stringliteral">&quot;XML_tag_C&quot;</span>, color:{0, 92, 128}}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_loading_xml_tags"></a>
Loading XML tags</h3>
<p>You can import XML tags from an XML file without importing the XML contents of the file. You might want to do this to work out a tag-to-style or style-to-tag mapping before you import the XML data., as shown in the following script fragment (from the LoadXMLTags tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            --You<span class="stringliteral">&#39;ll have to enter a valid file path for your system.</span></div>
<div class="line"><span class="stringliteral">            load XML tags from &quot;yukino:xml_tags.xml&quot;</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_saving_xml_tags"></a>
Saving XML tags</h3>
<p>Just as you can load XML tags from a file, you can save XML tags to a file, as shown in the following script. When you do this, only the tags themselves are saved in the XML file; document data is not included. As you would expect, this process is much faster than exporting XML, and the resulting file is much smaller. The following sample script shows how to save XML tags (for the complete script, see SaveXMLTags): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            --You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">            save XML tags to &quot;yukino:xml_tags.xml&quot; version comments &quot;Tag set created May 23, 2008&quot;</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_creating_an_xml_element"></a>
Creating an XML element</h3>
<p>Ordinarily, you create XML elements by importing an XML file, but you also can create an XML element using InDesign scripting, as shown in the following script fragment (from the CreateXMLElement tutorial script): </p>
<div class="fragment"><div class="line">            <span class="keyword">set</span> myRootElement to XML element 1</div>
<div class="line">            tell myRootElement</div>
<div class="line">                <span class="keyword">set</span> myXMLElement to make XML element with properties {markup tag:myXMLTag}</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> contents of myXMLElement to <span class="stringliteral">&quot;This is an XML element containing text.&quot;</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_moving_an_xml_element"></a>
Moving an XML element</h3>
<p>You can move XML elements within the XML structure using the move method, as shown in the following script fragment (from the MoveXMLElement tutorial script): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myRootElement to XML element 1</div>
<div class="line">            <span class="keyword">set</span> myXMLElementA to XML element 1 of myRootElement</div>
<div class="line">            <span class="keyword">set</span> myXMLElementB to XML element 1 of myRootElement</div>
<div class="line">            --Given two XML elements, <span class="stringliteral">&quot;myXMLElementA&quot;</span> and <span class="stringliteral">&quot;myXMLElementB&quot;</span>,</div>
<div class="line">            --move <span class="stringliteral">&quot;myXMLElementA&quot;</span> to after <span class="stringliteral">&quot;myXMLElementB&quot;</span>.            </div>
<div class="line">            move myXMLElementA to after myXMLElementB</div>
<div class="line">            --Place the root XML element so that you can see the result.</div>
<div class="line">            tell story 1</div>
<div class="line">                place XML <span class="keyword">using</span> myRootElement</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_deleting_an_xml_element"></a>
Deleting an XML element</h3>
<p>Deleting an XML element removes it from both the layout and the XML structure, as shown in the following script fragment (from the DeleteXMLElement tutorial script). </p>
<div class="fragment"><div class="line">            <span class="keyword">set</span> myRootElement to XML element 1</div>
<div class="line">            <span class="keyword">set</span> myXMLElement to XML element 1 of myRootElement</div>
<div class="line">            --Given an XML element <span class="stringliteral">&quot;myXMLElement&quot;</span>...</div>
<div class="line">            tell myXMLElement to <span class="keyword">delete</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_duplicating_an_xml_element"></a>
Duplicating an XML element</h3>
<p>When you duplicate an XML element, the new XML element appears immediately after the original XML element in the XML structure, as shown in the following script fragment (from the DuplicateXMLElement tutorial script): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myRootElement to XML element 1</div>
<div class="line">            <span class="keyword">set</span> myXMLElementA to XML element 1 of XML element 1</div>
<div class="line">            --&lt;fragment&gt;</div>
<div class="line">            --Given an XML element <span class="stringliteral">&quot;myXMLElementA&quot;</span></div>
<div class="line">            duplicate myXMLElementA</div>
<div class="line">            --&lt;/fragment&gt;</div>
<div class="line">            --Place the root XML element so that you can see the result.</div>
<div class="line">            tell story 1</div>
<div class="line">                place XML <span class="keyword">using</span> myRootElement</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_removing_items_from_the_xml_structure"></a>
Removing items from the XML structure</h3>
<p>To break the association between a page item or text and an XML element, use the untag method, as shown in the following script. The objects are not deleted, but they are no longer tied to an XML element (which is deleted). Any content of the deleted XML element becomes associated with the parent XML element. If the XML element is the root XML element, any layout objects (text or page items) associated with the XML element remain in the document. (For the complete script, see UntagXMLElement.) </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            tell XML element -1 of XML element 1 to untag</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_creating_an_xml_comment"></a>
Creating an XML comment</h3>
<p>XML comments are used to make notes in XML data structures. You can add an XML comment using something like the following script fragment (from the MakeXMLComment tutorial script): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myRootXMLElement to XML element 1</div>
<div class="line">            <span class="keyword">set</span> myXMLElement to XML element 1 of myRootXMLElement</div>
<div class="line">            tell myXMLElement</div>
<div class="line">                make XML comment with properties {value:<span class="stringliteral">&quot;This is an XML comment.&quot;</span>}</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_creating_an_xml_processing_instruction"></a>
Creating an XML processing instruction</h3>
<p>A processing instruction (PI) is an XML element that contains directions for the application reading the XML document. XML processing instructions are ignored by InDesign but can be inserted in an InDesign XML structure for export to other applications. An XML document can contain multiple processing instructions.</p>
<p>An XML processing instruction has two parts, target and value. The following is an example: </p>
<div class="fragment"><div class="line">&lt;?xml-stylesheet type=<span class="stringliteral">&quot;text/css&quot;</span> href=<span class="stringliteral">&quot;generic.css&quot;</span>?&gt;</div>
</div><!-- fragment --><p>The following script fragment shows how to add an XML processing instruction (for the complete script, see MakeProcessingInstruction): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myRootXMLElement to XML element 1</div>
<div class="line">            tell myRootXMLElement</div>
<div class="line">                <span class="keyword">set</span> myXMLInstruction to make XML instruction with properties {target:<span class="stringliteral">&quot;xml-stylesheet type=\&quot;text/css\&quot;&quot;</span>, data:<span class="stringliteral">&quot;href=\&quot;generic.css\&quot;&quot;</span>}</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_working_with_xml_attributes"></a>
Working with XML attributes</h3>
<p>XML attributes are "metadata" that can be associated with an XML element. To add an XML attribute to an XML element, use something like the following script fragment (from the MakeXMLAttribute tutorial script). An XML element can have any number of XML attributes, but each attribute name must be unique within the element (that is, you cannot have two attributes named "id"). </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myRootXMLElement to XML element 1</div>
<div class="line">            <span class="keyword">set</span> myXMLElement to XML element 1 of myRootXMLElement</div>
<div class="line">            tell myXMLElement</div>
<div class="line">                make XML attribute with properties {name:<span class="stringliteral">&quot;example_attribute&quot;</span>, value:<span class="stringliteral">&quot;This is an XML attribute.&quot;</span>}</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> In addition to creating attributes directly using scripting, you can convert XML elements to attributes. When you do this, the text contents of the XML element become the value of an XML attribute added to the parent of the XML element. Because the name of the XML element becomes the name of the attribute, this method can fail when an attribute with that name already exists in the parent of the XML element. If the XML element contains page items, those page items are deleted from the layout.</p>
<p>When you convert an XML attribute to an XML element, you can specify the location where the new XML element is added. The new XML element can be added to the beginning or end of the parent of the XML attribute. By default, the new element is added at the beginning of the parent element.</p>
<p>You also can specify am XML mark-up tag for the new XML element. If you omit this parameter, the new XML element is created with the same XML tag as XML element containing the XML attribute.</p>
<p>The following script shows how to convert an XML element to an XML attribute (for the complete script, see ConvertElementToAttribute): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myRootXMLElement to XML element 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myXMLElement to XML element 1 of myRootXMLElement</div>
<div class="line">        --Given an XML Element <span class="stringliteral">&quot;myXMLElement&quot;</span>...</div>
<div class="line">        tell myXMLElement</div>
<div class="line">            convert to attribute</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> You also can convert an XML attribute to an XML element, as shown in the following script fragment (from the ConvertAttributeToElement tutorial script): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myXMLTag to XML tag <span class="stringliteral">&quot;myXMLElement&quot;</span> of myDocument</div>
<div class="line">        <span class="keyword">set</span> myRootXMLElement to XML element 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myXMLElementB to XML element 2 of myRootXMLElement</div>
<div class="line">        <span class="keyword">set</span> myAttribute to XML attribute 1 of myXMLElementB</div>
<div class="line">        --Given an XML attribute <span class="stringliteral">&quot;myAttribute&quot;</span> and an XML tag <span class="stringliteral">&quot;myXMLTag&quot;</span>...</div>
<div class="line">        tell myAttribute</div>
<div class="line">            convert to element located element end markup tag myXMLTag</div>
<div class="line">        end tell</div>
<div class="line">        --Place the story so that you can see the result of the change.</div>
<div class="line">        tell story 1 of myDocument</div>
<div class="line">            place XML <span class="keyword">using</span> myRootXMLElement</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_working_with_xml_stories"></a>
Working with XML stories</h3>
<p>When you import XML elements that were not associated with a layout element (a story or page item), they are stored in an XML story. You can work with text in unplaced XML elements just as you would work with the text in a text frame. The following script fragment shows how this works (for the complete script, see XMLStory): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myXMLStory to xml story 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> the point size of text 1 of myXMLStory to 72</div>
<div class="line">        <span class="keyword">set</span> myRootXMLElement to XML element 1 of myDocument</div>
<div class="line">        --Place the story so that you can see the result of the change.</div>
<div class="line">        tell story 1 of myDocument</div>
<div class="line">            place XML <span class="keyword">using</span> myRootXMLElement</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_exporting_xml"></a>
Exporting XML</h3>
<p>To export XML from an InDesign document, export either the entire XML structure in the document or one XML element (including any child XML elements it contains). The following script fragment shows how to do this (for the complete script, see ExportXML): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            --You<span class="stringliteral">&#39;ll need to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">            export to &quot;yukino:test.xml&quot; format &quot;XML&quot;</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
</div><!-- fragment --><p> In addition, you can use the export from selected property of the xml export preferences object to export an XML element selected in the user interface. The following script fragment shows how to do this (for the complete script, see ExportSelectedXMLElement): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> export from selected of XML export preferences to <span class="keyword">true</span></div>
<div class="line">            select XML element -1 of XML element 1</div>
<div class="line">            export to <span class="stringliteral">&quot;yukino:selectedXMLElement.xml&quot;</span> format <span class="stringliteral">&quot;XML&quot;</span></div>
<div class="line">            <span class="keyword">set</span> export from selected of XML export preferences to <span class="keyword">false</span></div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_adding_xml_elements_to_a_layout"></a>
Adding XML Elements to a Layout</h2>
<p>Previously, we covered the process of getting XML data into InDesign documents and working with the XML structure in a document. In this section, we discuss techniques for getting XML information into a page layout and applying formatting to it.</p>
<h3><a class="anchor" id="id_as_associating_xml_elements_with_page_items_and_text"></a>
Associating XML elements with page items and text</h3>
<p>To associate a page item or text with an existing XML element, use the place xml method. This replaces the content of the page item with the content of the XML element, as shown in the following script fragment (from the PlaceXML tutorial script): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to text frame 1 of myPage</div>
<div class="line">        tell myTextFrame to place XML <span class="keyword">using</span> XML element 1 of myDocument</div>
</div><!-- fragment --><p> To associate an existing page item or text object with an existing XML element, use the markup method. This merges the content of the page item or text with the content of the XML element (if any). The following script fragment shows how to use the markup method (for the complete script, see Markup): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myRootXMLElement to XML element 1</div>
<div class="line">            <span class="keyword">set</span> myXMLElement to XML element 1 of myRootXMLElement</div>
<div class="line">            tell paragraph 3 of story 1</div>
<div class="line">                markup <span class="keyword">using</span> myXMLElement</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> <b>Placing XML into page items</b></p>
<p>Another way to associate an XML element with a page item is to use the place into frame method. With this method, you can create a frame as you place the XML, as shown in the following script fragment (for the complete script, see PlaceIntoFrame): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        --place into frame has two parameters:</div>
<div class="line">        --on: The page, spread, or master spread on which to create the frame</div>
<div class="line">        --geometric bounds: The bounds of the <span class="keyword">new</span> frame (in page coordinates).</div>
<div class="line">        tell XML element 1 of myDocument</div>
<div class="line">            place into frame on myPage geometric bounds {72, 72, 288, 288}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> To associate an XML element with an inline page item (i.e., an anchored object), use the place into copy method, as shown in the following script fragment (from the PlaceIntoCopy tutorial script): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell XML element 1 of myDocument</div>
<div class="line">            <span class="keyword">set</span> myFrame to place into copy on myPage place point {288, 72} copy item myTextFrame</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> To associate an existing page item (or a copy of an existing page item) with an XML element and insert the page item into the XML structure at the location of the element, use the place into inline copy method, as shown in the following script fragment (from the PlaceIntoInlineCopy tutorial script): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myPage to page 1 of document 1</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myNewTextFrame to make text frame with properties {geometric bounds:{72, 72, 96, 144}}</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myXMLElement to XML element 3 of XML element 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myFrame to place into <span class="keyword">inline</span> copy myXMLElement copy item myNewTextFrame without retain existing frame</div>
</div><!-- fragment --><p> To associate an XML element with a new inline frame, use the placeIntoInlineFrame method, as shown in the following script fragment (from the PlaceIntoInlineFrame tutorial script): </p>
<div class="fragment"><div class="line">        --place into frame has one parameter, dimensions, which define</div>
<div class="line">        --the width and height of the <span class="keyword">inline</span> frame.</div>
<div class="line">        tell XML element 3 of XML element 1 of myDocument</div>
<div class="line">            place into <span class="keyword">inline</span> frame dimensions {72, 24}</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> <b>Inserting text in and around XML text elements</b></p>
<p>When you place XML data into an InDesign layout, you often need to add white space (for example, return and tab characters) and static text (labels like "name" or "address") to the text of your XML elements. The following sample script shows how to add text in and around XML elements (for the complete script, see InsertTextAsContent): </p>
<div class="fragment"><div class="line">        --Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myXMLTag to make XML tag with properties {name:<span class="stringliteral">&quot;myXMLElement&quot;</span>}</div>
<div class="line">            <span class="keyword">set</span> myRootXMLElement to XML element 1</div>
<div class="line">            tell myRootXMLElement</div>
<div class="line">                <span class="keyword">set</span> myXMLElementA to make XML element with properties {markup tag:myXMLTag}</div>
<div class="line">                <span class="keyword">set</span> contents of myXMLElementA to <span class="stringliteral">&quot;This is a paragraph in an XML story.&quot;</span></div>
<div class="line">                <span class="keyword">set</span> myXMLElementB to make XML element with properties {markup tag:myXMLTag}</div>
<div class="line">                <span class="keyword">set</span> contents of myXMLElementB to <span class="stringliteral">&quot;This is a another paragraph in an XML story.&quot;</span></div>
<div class="line">                <span class="keyword">set</span> myXMLElementC to make XML element with properties {markup tag:myXMLTag}</div>
<div class="line">                <span class="keyword">set</span> contents of myXMLElementC to <span class="stringliteral">&quot;This is the third paragraph in an XML story.&quot;</span></div>
<div class="line">                <span class="keyword">set</span> myXMLElementD to make XML element with properties {markup tag:myXMLTag}</div>
<div class="line">                <span class="keyword">set</span> contents of myXMLElementD to <span class="stringliteral">&quot;This is the last paragraph in an XML story.&quot;</span></div>
<div class="line">                tell myXMLElementA</div>
<div class="line">                    --By inserting the <span class="keywordflow">return</span> character after the XML element, the</div>
<div class="line">                    --character becomes part of the content of the parent XML element,</div>
<div class="line">                    --and not part of the content of the XML element itself.</div>
<div class="line">                    insert text as content <span class="keyword">using</span> <span class="keywordflow">return</span> position after element</div>
<div class="line">                end tell</div>
<div class="line">                tell myXMLElementB</div>
<div class="line">                    insert text as content <span class="keyword">using</span> <span class="stringliteral">&quot;Static text: &quot;</span> position before element</div>
<div class="line">                    insert text as content <span class="keyword">using</span> <span class="keywordflow">return</span> position after element</div>
<div class="line">                end tell</div>
<div class="line">                tell myXMLElementC</div>
<div class="line">                    insert text as content <span class="keyword">using</span> <span class="stringliteral">&quot;Text at the start of an element: &quot;</span> position element start</div>
<div class="line">                    insert text as content <span class="keyword">using</span> <span class="stringliteral">&quot; Text at the end of an element. &quot;</span> position element end</div>
<div class="line">                end tell</div>
<div class="line">                tell myXMLElementD</div>
<div class="line">                    insert text as content <span class="keyword">using</span> <span class="stringliteral">&quot;Text before the element: &quot;</span> position before element</div>
<div class="line">                    insert text as content <span class="keyword">using</span> <span class="stringliteral">&quot; Text after the element. &quot;</span> position after element</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">            --Place the XML so that you can see the result.</div>
<div class="line">            tell story 1</div>
<div class="line">                place XML <span class="keyword">using</span> myRootXMLElement</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_marking_up_existing_layouts"></a>
Marking up existing layouts</h3>
<p>In some cases, an XML publishing project does not start with an XML file-especially when you need to convert an existing page layout to XML. For this type of project, you can mark up existing page-layout content and add it to an XML structure. You can then export this structure for further processing by XML tools outside InDesign.</p>
<p><b>Mapping tags to styles</b></p>
<p>One of the quickest ways to apply formatting to XML text elements is to use XMLImportMaps, also known as tag-to-style mapping. When you do this, you can associate a specific XML tag with a paragraph or character style. When you use the map XML tags to styles method of the document, InDesign applies the style to the text, as shown in the following script fragment (from the MapTagsToStyles tutorial script): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myPage to page 1</div>
<div class="line">            --Create a tag to style mapping.</div>
<div class="line">            make XML <span class="keyword">import</span> map with properties {markup tag:<span class="stringliteral">&quot;heading_1&quot;</span>, mapped style:<span class="stringliteral">&quot;heading 1&quot;</span>}</div>
<div class="line">            make XML <span class="keyword">import</span> map with properties {markup tag:<span class="stringliteral">&quot;heading_2&quot;</span>, mapped style:<span class="stringliteral">&quot;heading 2&quot;</span>}</div>
<div class="line">            make XML <span class="keyword">import</span> map with properties {markup tag:<span class="stringliteral">&quot;para_1&quot;</span>, mapped style:<span class="stringliteral">&quot;para 1&quot;</span>}</div>
<div class="line">            make XML <span class="keyword">import</span> map with properties {markup tag:<span class="stringliteral">&quot;body_text&quot;</span>, mapped style:<span class="stringliteral">&quot;body text&quot;</span>}</div>
<div class="line">            --Map the XML tags to the defined styles.</div>
<div class="line">            map XML tags to styles</div>
<div class="line">            --Place the story so that you can see the result of the mapping.</div>
<div class="line">            tell story 1</div>
<div class="line">                place XML <span class="keyword">using</span> XML element 1 of myDocument</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> <b>Mapping styles to tags</b></p>
<p>When you have formatted text that is not associated with any XML elements, and you want to move that text into an XML structure, use style-to-tag mapping, which associates paragraph and character styles with XML tags. To do this, use XML export map objects to create the links between XML tags and styles, then use the map styles to XML tags method to create the corresponding XML elements, as shown in the following script fragment (from the MapStylesToTags tutorial script): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            --Create a tag to style mapping.</div>
<div class="line">            make XML export map with properties {markup tag:<span class="stringliteral">&quot;heading_1&quot;</span>, mapped style:<span class="stringliteral">&quot;heading 1&quot;</span>}</div>
<div class="line">            make XML export map with properties {markup tag:<span class="stringliteral">&quot;heading_2&quot;</span>, mapped style:<span class="stringliteral">&quot;heading 2&quot;</span>}</div>
<div class="line">            make XML export map with properties {markup tag:<span class="stringliteral">&quot;para_1&quot;</span>, mapped style:<span class="stringliteral">&quot;para 1&quot;</span>}</div>
<div class="line">            make XML export map with properties {markup tag:<span class="stringliteral">&quot;body_text&quot;</span>, mapped style:<span class="stringliteral">&quot;body text&quot;</span>}</div>
<div class="line">            --Apply the style to tag mapping.</div>
<div class="line">            map styles to XML tags</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> Another approach is simply to have your script create a new XML tag for each paragraph or character style in the document, and then apply the style to tag mapping, as shown in the following script fragment (from the MapAllStylesToTags tutorial script): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            --Create a tag to style mapping.</div>
<div class="line">            repeat with myParagraphStyle in paragraph styles</div>
<div class="line">                <span class="keyword">set</span> myParagraphStyleName to name of myParagraphStyle</div>
<div class="line">                <span class="keyword">set</span> myXMLTagName to my myReplace(myParagraphStyleName, <span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;_&quot;</span>)</div>
<div class="line">                set myXMLTagName to my myReplace(myXMLTagName, &quot;[&quot;, &quot;&quot;)</div>
<div class="line">                set myXMLTagName to my myReplace(myXMLTagName, &quot;]&quot;, &quot;&quot;)</div>
<div class="line">                set myMarkupTag to make XML tag with properties {name:myXMLTagName}</div>
<div class="line">                make XML export map with properties {markup tag:myMarkupTag, mapped style:myParagraphStyle}</div>
<div class="line">            end repeat</div>
<div class="line">            map styles to XML tags</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> <b>Marking up graphics</b></p>
<p>The following script fragment shows how to associate an XML element with a graphic (for the complete script, see MarkingUpGraphics): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myMarkupTag to make XML tag with properties {name:<span class="stringliteral">&quot;graphic&quot;</span>}</div>
<div class="line">            tell XML element 1</div>
<div class="line">                <span class="keyword">set</span> myXMLElement to make XML element with properties {markup tag:myMarkupTag}</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myFrame to rectangle 1 of page 1</div>
<div class="line">            tell myFrame to markup <span class="keyword">using</span> myXMLElement</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_applying_styles_to_xml_elements"></a>
Applying styles to XML elements</h3>
<p>In addition to using tag-to-style and style-to-tag mappings or applying styles to the text and page items associated with XML elements, you also can apply styles to XML elements directly. The following script fragment shows how to use three methods: apply paragraph style, apply character style, and apply object style. (For the complete script, see ApplyStylesToXMLElements.) </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myPage to page 1 of myDocument</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myHeading1XMLTag to XML tag <span class="stringliteral">&quot;heading_1&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myHeading2XMLTag to XML tag <span class="stringliteral">&quot;heading_2&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myPara1XMLTag to XML tag <span class="stringliteral">&quot;para_1&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myBodyTextXMLTag to XML tag <span class="stringliteral">&quot;body_text&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myHeading1Style to paragraph style <span class="stringliteral">&quot;heading 1&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myHeading2Style to paragraph style <span class="stringliteral">&quot;heading 2&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myPara1Style to paragraph style <span class="stringliteral">&quot;para 1&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myBodyTextStyle to paragraph style <span class="stringliteral">&quot;body text&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myCharacterStyle to character style <span class="stringliteral">&quot;Emphasis&quot;</span></div>
<div class="line">        end tell</div>
<div class="line">        --Add XML elements.</div>
<div class="line">        <span class="keyword">set</span> myRootXMLElement to XML element 1 of myDocument</div>
<div class="line">        tell myRootXMLElement</div>
<div class="line">            <span class="keyword">set</span> myXMLElementA to make XML element with properties {markup tag:myHeading1XMLTag, contents:<span class="stringliteral">&quot;Heading 1&quot;</span>}</div>
<div class="line">            tell myXMLElementA</div>
<div class="line">                insert text as content <span class="keyword">using</span> <span class="keywordflow">return</span> position after element</div>
<div class="line">                apply paragraph style <span class="keyword">using</span> myHeading1Style clearing overrides yes</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myXMLElementB to make XML element with properties {markup tag:myPara1XMLTag, contents:<span class="stringliteral">&quot;This is the first paragraph in the article.&quot;</span>}</div>
<div class="line">            tell myXMLElementB</div>
<div class="line">                insert text as content <span class="keyword">using</span> <span class="keywordflow">return</span> position after element</div>
<div class="line">                apply paragraph style <span class="keyword">using</span> myPara1Style clearing overrides yes</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myXMLElementC to make XML element with properties {markup tag:myBodyTextXMLTag, contents:<span class="stringliteral">&quot;This is the second paragraph in the article.&quot;</span>}</div>
<div class="line">            tell myXMLElementC</div>
<div class="line">                insert text as content <span class="keyword">using</span> <span class="keywordflow">return</span> position after element</div>
<div class="line">                apply paragraph style <span class="keyword">using</span> myBodyTextStyle clearing overrides yes</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myXMLElementD to make XML element with properties {markup tag:myHeading2XMLTag, contents:<span class="stringliteral">&quot;Heading 2&quot;</span>}</div>
<div class="line">            tell myXMLElementD</div>
<div class="line">                insert text as content <span class="keyword">using</span> <span class="keywordflow">return</span> position after element</div>
<div class="line">                apply paragraph style <span class="keyword">using</span> myHeading2Style clearing overrides yes</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myXMLElementE to make XML element with properties {markup tag:myPara1XMLTag, contents:<span class="stringliteral">&quot;This is the first paragraph following the subhead.&quot;</span>}</div>
<div class="line">            tell myXMLElementE</div>
<div class="line">                insert text as content <span class="keyword">using</span> <span class="keywordflow">return</span> position after element</div>
<div class="line">                apply paragraph style <span class="keyword">using</span> myPara1Style clearing overrides yes</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myXMLElementF to make XML element with properties {markup tag:myBodyTextXMLTag, contents:<span class="stringliteral">&quot;Note:&quot;</span>}</div>
<div class="line">            tell myXMLElementF</div>
<div class="line">                insert text as content <span class="keyword">using</span> <span class="stringliteral">&quot; &quot;</span> position after element</div>
<div class="line">                apply character style <span class="keyword">using</span> myCharacterStyle</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myXMLElementG to make XML element with properties {markup tag:myBodyTextXMLTag, contents:<span class="stringliteral">&quot;This is the second paragraph following the subhead.&quot;</span>}</div>
<div class="line">            tell myXMLElementG</div>
<div class="line">                insert text as content <span class="keyword">using</span> <span class="keywordflow">return</span> position after element</div>
<div class="line">                apply paragraph style <span class="keyword">using</span> myBodyTextStyle clearing overrides no</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">        tell myPage</div>
<div class="line">            <span class="keyword">set</span> myTextFrame to make text frame with properties {geometric bounds:my myGetBounds(myDocument, myPage)}</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keyword">set</span> myStory to parent story of myTextFrame</div>
<div class="line">        tell myStory</div>
<div class="line">            place XML <span class="keyword">using</span> myRootXMLElement</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_working_with_xml_tables"></a>
Working with XML tables</h3>
<p>InDesign automatically imports XML data into table cells when the data is marked up using HTML standard table tags. If you cannot use the default table mark-up or prefer not to use it, InDesign can convert XML elements to a table using the convert element to table method.</p>
<p>To use this method, the XML elements to be converted to a table must conform to a specific structure. Each row of the table must correspond to a specific XML element, and that element must contain a series of XML elements corresponding to the cells in the row. The following script fragment shows how to use this method (for the complete script, see ConvertXMLElementToTable). The XML element used to denote the table row is consumed by this process. </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myRootXMLElement to XML element 1</div>
<div class="line">            <span class="keyword">set</span> myTableXMLElement to XML element 1 of myRootXMLElement</div>
<div class="line">            --Given an XML element <span class="stringliteral">&quot;myTableXMLElement&quot;</span>...</div>
<div class="line">            <span class="keyword">set</span> myRowTag to XML tag <span class="stringliteral">&quot;Row&quot;</span> of myDocument</div>
<div class="line">            <span class="keyword">set</span> myCellTag to XML tag <span class="stringliteral">&quot;Cell&quot;</span> of myDocument</div>
<div class="line">            tell myTableXMLElement</div>
<div class="line">                convert element to table row tag myRowTag cell tag myCellTag</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myStory to story 1 of myDocument</div>
<div class="line">            tell myStory</div>
<div class="line">                place XML <span class="keyword">using</span> XML element 1 of myDocument</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> Once you are working with a table containing XML elements, you can apply table styles and cell styles to the XML elements directly, rather than having to apply the styles to the tables or cells associated with the XML elements. To do this, use the apply table style and apply cell style methods, as shown in the following script fragment (from the ApplyTableStyle tutorial script): </p>
<div class="fragment"><div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myCellStyle to cell style <span class="stringliteral">&quot;myCellStyle&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myTableStyle to table style <span class="stringliteral">&quot;myTableStyle&quot;</span></div>
<div class="line">            <span class="keyword">set</span> myTableXMLElement to XML element 1 of XML element 1</div>
<div class="line">            tell myTableXMLElement</div>
<div class="line">                apply table style <span class="keyword">using</span> myTableStyle with clearing overrides</div>
<div class="line">                tell XML element 1 to apply cell style <span class="keyword">using</span> myCellStyle</div>
<div class="line">                tell XML element 4 to apply cell style <span class="keyword">using</span> myCellStyle</div>
<div class="line">                tell XML element 9 to apply cell style <span class="keyword">using</span> myCellStyle</div>
<div class="line">                tell XML element 14 to apply cell style <span class="keyword">using</span> myCellStyle</div>
<div class="line">                tell XML element 15 to apply cell style <span class="keyword">using</span> myCellStyle</div>
<div class="line">                tell XML element 20 to apply cell style <span class="keyword">using</span> myCellStyle</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">        --Place the story so that you can see the result of the change.</div>
<div class="line">        tell story 1 of myDocument</div>
<div class="line">            place XML <span class="keyword">using</span> XML element 1 of myDocument</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_as_xml_rules"></a>
XML Rules</h1>
<p>The InDesign XML-rules feature provides a powerful set of scripting tools for working with the XML content of your documents. XML rules also greatly simplify the process of writing scripts to work with XML elements and dramatically improve performance of finding, changing, and formatting XML elements.</p>
<p>While XML rules can be triggered by application events, like open, place, and close, typically you will run XML rules after importing XML into a document. (For more information on attaching scripts to events, see <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_events">Events.</a>)</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create and run a script. We also assume that you have some knowledge of XML and have read <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_xml">XML.</a></p>
<h2><a class="anchor" id="id_as_overview"></a>
Overview</h2>
<p>InDesign's XML rules feature has three parts:</p>
<ul>
<li>XML rules processor (a scripting object) - Locates XML elements in an XML structure using XPath and applies the appropriate XML rule(s). It is important to note that a script can contain multiple XML rule processor objects, and each rule-processor object is associated with a given XML rule set.</li>
<li>Glue code - A set of routines provided by Adobe to make the process of writing XML rules and interacting with the XML rules-processor easier.</li>
<li>XML rules - The XML actions you add to a script. XML rules are written in scripting code. A rule combines an XPath-based condition and a function to apply when the condition is met. The "apply" function can perform any set of operations that can be defined in InDesign scripting, including changing the XML structure; applying formatting; and creating new pages, page items, or documents.</li>
</ul>
<p>A script can define any number of rules and apply them to the entire XML structure of an InDesign document or any subset of elements within the XML structure. When an XML rule is triggered by an XML rule processor, the rule can apply changes to the matching XML element or any other object in the document.</p>
<p>You can think of the XML rules feature as being something like XSLT. Just as XSLT uses XPath to locate XML elements in an XML structure, then transforms the XML elements in some way, XML rules use XPath to locate and act on XML elements inside InDesign. Just as an XSLT template uses an XML parser outside InDesign to apply transformations to XML data, InDesign's XML Rules Processor uses XML rules to apply transformations to XML data inside InDesign.</p>
<h3><a class="anchor" id="id_as_why_use_xml_rules"></a>
Why use XML rules?</h3>
<p>In prior releases of InDesign, you could not use XPath to navigate the XML structure in your InDesign files. Instead, you needed to write recursive script functions to iterate through the XML structure, examining each element in turn. This was difficult and slow.</p>
<p>XML rules makes it easy to find XML elements in the structure, by using XPath and relying on InDesign's XML-rules processors to find XML elements. An XML-rule processor handles the work of iterating through the XML elements in your document, and it can do so much faster than a script.</p>
<h3><a class="anchor" id="id_as_xml-rules_programming_model"></a>
XML-rules programming model</h3>
<p>An XML rule contains three things:</p>
<ol type="1">
<li>A name (as a string).</li>
<li>An XPath statement (as a string).</li>
<li>An apply function.</li>
</ol>
<p>The XPath statement defines the location in the XML structure; when the XML rules processor finds a matching element, it executes the apply function defined in the rule.</p>
<p>Here is a sample XML rule: </p>
<div class="fragment"><div class="line">on RuleName()</div>
<div class="line">    script RuleName</div>
<div class="line">        property name : &quot;RuleNameAsString&quot;</div>
<div class="line">        property xpath : &quot;ValidXPathSpecifier&quot;</div>
<div class="line">        on apply(element, ruleSet, ruleProcessor)</div>
<div class="line">            --Do something here.</div>
<div class="line">            --Return true to stop further processing of the XML element.</div>
<div class="line">            return false</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end RuleName</div>
</div><!-- fragment --><p> In the above example, RuleNameAsString is the name of the rule and matches the RuleName; ValidXPathSpecifier is an XPath expression. Later in this section, we present a series of functioning XML-rule examples.</p>
<dl class="section note"><dt>Note</dt><dd>XML rules support a limited subset of XPath 1.0. See "XPath limitations" in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_overview">XML Rules Overview</a>.</dd></dl>
<p><b>XML-rule sets</b></p>
<p>An XML-rule set is an array of one or more XML rules to be applied by an XML-rules processor. The rules are applied in the order in which they appear in the array. Here is a sample XML-rule set: </p>
<div class="fragment"><div class="line"><span class="keyword">set</span> myRuleSet to {my SortByName(), my AddStaticText(), my LayoutElements(), my FormatElements()}</div>
</div><!-- fragment --><p> In the above example, the rules listed in the myRuleSet array are defined elsewhere in the script. Later in this section, we present several functioning scripts containing XML-rule sets.</p>
<p>'<b>Glue</b>' <b>code</b></p>
<p>In addition to the XML-rules processor object built into InDesign's scripting model, Adobe provides a set of functions intended to make the process of writing XML rules much easier. These functions are defined within the glue code.as file:</p>
<ul>
<li>__processRuleSet(root, ruleSet) - To execute a set of XML rules, your script must call the __processRuleSet function and provide an XML element and an XML rule set. The XML element defines the point in the XML structure at which to begin processing the rules.</li>
<li>__processChildren(ruleProcessor) - This function directs the XML-rules processor to apply matching XML rules to child elements of the matched XML element. This allows the rule applied to a parent XML element to execute code after the child XML elements are processed. By default, when an XML-rules processor applies a rule to the c hildren of an XML element, control does not return to the rule. You can use the __processChildren function to return control to the apply function of the rule after the child XML elements are processed.</li>
<li>__skipChildren(ruleProcessor) - This function tells the processor not to process any descendants of the current XML element using the XML rule. Use this function when you want to move or delete the current XML element or improve performance by skipping irrelevant parts of an XML structure.</li>
</ul>
<p><b>Iterating through an XML structure</b></p>
<p>The XML-rules processor iterates through the XML structure of a document by processing each XML element in the order in which it appears in the XML hierarchy of the document. The XML-rules processor uses a forward-only traversal of the XML structure, and it visits each XML element in the structure twice (in the order parent-child-parent, just like the normal ordering of nested tags in an XML file). For any XML element, the XML-rules processor tries to apply all matching XML rules in the order in which they are added to the current XML rule set.</p>
<p>The __processRuleSet function applies rules to XML elements in "depth first" order; that is, XML elements and their child elements are processed in the order in which they appear in the XML structure. For each "branch" of the XML structure, the XML-rules processor visits each XML element before moving on to the next branch.</p>
<p>After an XML rule is applied to an XML element, the XML-rules processor continues searching for rules to apply to the descendents of that XML element. An XML rule can alter this behavior by using the __skipChildren or __processChildren function, or by changing the operation of other rules.</p>
<p>To see how all these functions work together, import the DepthFirstProcessingOrder.xml file into a new document, then run the DepthFirstProcessingOrder.jsx script. InDesign creates a text frame, that lists the attribute names of each element in the sample XML file in the order in which they were visited by each rule. You can use this script in conjunction with the AddAttribute tutorial script to troubleshoot XML traversal problems in your own XML documents (you must edit the AddAttribute script to suit your XML structure).</p>
<div class="image">
<img src="InDesign_ScriptingGuide-11.gif" alt="InDesign_ScriptingGuide-11.gif"/>
</div>
<p>Iteration with __processChildren (assuming a rule that matches every XML element in the structure) is shown in the following figure:</p>
<div class="image">
<img src="InDesign_ScriptingGuide-12.gif" alt="InDesign_ScriptingGuide-12.gif"/>
</div>
<p>Iteration given the following rule set is shown in the figure after the script fragment. The rule set includes two rules that match every element, including one that uses __processChildren. Every element is processed twice. (For the complete script, see ProcessChildren.) </p>
<div class="fragment"><div class="line">to NormalRule()</div>
<div class="line">    script NormalRule</div>
<div class="line">        property name : &quot;NormalRule&quot;</div>
<div class="line">        property xpath : &quot;<span class="comment">//XMLElement&quot;</span></div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell insertion point -1 of story 1 of document 1</div>
<div class="line">                        set contents to value of XML attribute 1 of myXMLElement &amp; return</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return false</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end NormalRule</div>
<div class="line">to ProcessChildrenRule()</div>
<div class="line">    script ProcessChildrenRule</div>
<div class="line">        property name : &quot;ProcessChildrenRule&quot;</div>
<div class="line">        property xpath : &quot;<span class="comment">//XMLElement&quot;</span></div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            tell myGlueCode</div>
<div class="line">                __processChildren(myRuleProcessor)</div>
<div class="line">            end tell</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell insertion point -1 of story 1 of document 1</div>
<div class="line">                        set contents to value of XML attribute 1 of myXMLElement &amp; return</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return false</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessChildrenRule</div>
</div><!-- fragment --> <div class="image">
<img src="InDesign_ScriptingGuide-13.gif" alt="InDesign_ScriptingGuide-13.gif"/>
</div>
<p><b>Changing structure during iteration</b></p>
<p>When an XML-rules processor finds a matching XML element and applies an XML rule, the rule can change the XML structure of the document. This can conflict with the process of applying other rules, if the affected XML elements in the structure are part of the current path of the XML-rules processor. To prevent errors that might cause the XML-rules processor to become invalid, the following limitations are placed on XML structure changes you might make within an XML rule:</p>
<ul>
<li>Deleting an ancestor XML element - To delete an ancestor XML element of the matched XML element, create a separate rule that matches and processes the ancestor XML element.</li>
<li>Inserting a parent XML element - To add an ancestor XML element to the matched XML element, do so after processing the current XML element. The ancestor XML element you add is not processed by the XML-rules processor during this rule iteration (as it appears "above" the current element in the hierarchy).</li>
<li>Deleting the current XML element - You cannot delete or move the matched XML element until any child XML elements contained by the element are processed. To make this sort of change, use the __skipChildren function before making the change.</li>
<li>No repetitive processing - Changes to nodes that were already processed will not cause the XML rule to be evaluated again.</li>
</ul>
<p><b>Handling multiple matching rules</b></p>
<p>When multiple rules match an XML element, the XML-rules processor can apply some or all of the matching rules. XML rules are applied in the order in which they appear in the rule set, up to the point that one of the rule apply functions returns true. In essence, returning true means the element was processed. Once a rule returns true, any other XML rules matching the XML element are ignored. You can alter this behavior and allow the next matching rule to be applied, by having the XML rule apply function return false.</p>
<p>When an apply function returns false, you can control the matching behavior of the XML rule based on a condition other than the XPath property defined in the XML rule, like the state of another variable in the script.</p>
<p><b>XPath limitations</b></p>
<p>InDesign's XML rules support a limited subset of the XPath 1.0 specification, specifically including the following capabilities:</p>
<ul>
<li>Find an element by name, specifying a path from the root; for example, /doc/title.</li>
<li>Find paths with wildcards and node matches; for example, /doc/* /subtree/node().</li>
<li>Find an element with a specified attribute that matches a specified value; for example, /doc/para[@font='Courier'].</li>
<li>Find an element with a specified attribute that does not match a specified value; for example, /doc/para[@font !='Courier'].</li>
<li>Find a child element by numeric position (but not last()); for example, /doc/para[3].</li>
<li>Find self or any descendent; for example, //para.</li>
<li>Find comment as a terminal; for example, /doc/comment().</li>
<li>Find PI by target or any; for example, /doc/processing-instruction('foo').</li>
<li>Find multiple predicates; for example, /doc/para[@font='Courier'][@size=5][2].</li>
<li>Find along following-sibling axes; for example, /doc/note/following-sibling::*.</li>
</ul>
<p>Due to the one-pass nature of this implementation, the following XPath expressions are specifically excluded:</p>
<ul>
<li>No ancestor or preceding-sibling axes, including .., ancestor::, preceding-sibling::.</li>
<li>No path specifications in predicates; for example,foo[bar/c].</li>
<li>No last() function.</li>
<li>No text() function or text comparisons; however, you can use InDesign scripting to examine the text content of an XML element matched by a given XML rule.</li>
<li>No compound Boolean predicates; for example, foo[@bar=font or @c=size].</li>
<li>No relational predicates; for example, foo[@bar &lt;font or @c &gt; 3].</li>
<li>No relative paths; for example, doc/chapter.</li>
</ul>
<p><b>Error handling</b></p>
<p>Because XML rules are part of the InDesign scripting model, scripts that use rules do not differ in nature from ordinary scripts, and they benefit from the same error-handling mechanism. When InDesign generates an error, an XML-rules script behaves no differently than any other script. InDesign errors can be captured in the script using whatever tools the scripting language provides to achieve that; for example, <b>try...catch</b> blocks.</p>
<p>InDesign does include a series of errors specific to XML-rules processing. An InDesign error can occur at XML-rules processor initialization, when a rule uses a non-conforming XPath specifier (see "XPath limitations" in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_overview">XML Rules Overview</a>). An InDesign error also can be caused by a model change that invalidates the state of an XML-rules processor. XML structure changes caused by the operation of XML rules can invalidate the XML-rules processor. These changes to the XML structure can be caused by the script containing the XML-rules processor, another concurrently executing script, or a user action initiated from the user interface.</p>
<p>XML structure changes that invalidate an XML-rules processor lead to errors when the XML-rules processor's iteration resumes. The error message indicates which XML structural change caused the error.</p>
<p><b>XML rules flow of control</b></p>
<p>As a script containing XML rules executes, the flow of control passes from the script function containing the XML rules to each XML rule, and from each rule to the functions defined in the glue code. Those functions pass control to the XML-rules processor which, in turn, iterates through the XML elements in the structure. Results and errors are passed back up the chain until they are handled by a function or cause a scripting error. The following diagram provides a simplified overview of the flow of control in an XML-rules script:</p>
<div class="image">
<img src="InDesign_ScriptingGuide_AS-27.gif" />
</div>
<h2><a class="anchor" id="id_as_xml_rules_examples"></a>
XML Rules Examples</h2>
<p>Because XML rules rely on XPath statements to find qualifying XML elements, XML rules are closely tied to the structure of the XML in a document. This means it is almost impossible to demonstrate a functional XML-rules script without having an XML structure to test it against. In the remainder of this section, we present a series of XML-rules exercises based on a sample XML data file. For our example, we use the product list of an imaginary integrated-circuit manufacturer. Each record in the XML data file has the following structure: </p>
<div class="fragment"><div class="line">&lt;device&gt;</div>
<div class="line">    &lt;name&gt;&lt;/name&gt;</div>
<div class="line">    &lt;type&gt;&lt;/type&gt;</div>
<div class="line">    &lt;part_number&gt;&lt;/part_number&gt;</div>
<div class="line">    &lt;supply_voltage&gt;</div>
<div class="line">        &lt;minimum&gt;&lt;/minimum&gt;</div>
<div class="line">        &lt;maximum&gt;&lt;/maximum&gt;</div>
<div class="line">    &lt;/supply_voltage&gt;</div>
<div class="line">    &lt;package&gt;</div>
<div class="line">        &lt;type&gt;&lt;/type&gt;</div>
<div class="line">        &lt;pins&gt;&lt;/pins&gt;</div>
<div class="line">    &lt;/package&gt;</div>
<div class="line">    &lt;price&gt;&lt;/price&gt;</div>
<div class="line">    &lt;description&gt;&lt;/description&gt;</div>
<div class="line">&lt;/device&gt;</div>
</div><!-- fragment --><p>The scripts are presented in order of complexity, starting with a very simple script and building toward more complex operations.</p>
<h3><a class="anchor" id="id_as_setting_up_a_sample_document"></a>
Setting up a sample document</h3>
<p>Before you run each script in this section, import the XMLRulesExampleData.xml data file into a document. When you import the XML, turn on the Do Not Import Contents of Whitespace-Only Elements option in the XML Import Options dialog box. Save the file, then choose File &gt; Revert before running each sample script in this section. Alternately, run the following script before you run each sample XML-rule script (see the XMLRulesExampleSetup.jsx script file): </p>
<div class="fragment"><div class="line">main();</div>
<div class="line"><span class="keyword">function</span> main(){</div>
<div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    myDocument.xmlImportPreferences.allowTransform = <span class="keyword">false</span>;</div>
<div class="line">    myDocument.xmlImportPreferences.ignoreWhitespace = <span class="keyword">true</span>;</div>
<div class="line">    var myScriptPath = myGetScriptPath();</div>
<div class="line">    var myFilePath = myScriptPath.path + <span class="stringliteral">&quot;/XMLRulesExampleData.xml&quot;</span></div>
<div class="line">    myDocument.importXML(File(myFilePath));</div>
<div class="line">    var myBounds = myGetBounds(myDocument, myDocument.pages.item(0));</div>
<div class="line">    myDocument.xmlElements.item(0).placeIntoFrame(myDocument.pages.item(0), myBounds);</div>
<div class="line">    <span class="keyword">function</span> myGetBounds(myDocument, myPage){</div>
<div class="line">        var myWidth = myDocument.documentPreferences.pageWidth;</div>
<div class="line">        var myHeight = myDocument.documentPreferences.pageHeight;</div>
<div class="line">        var myX1 = myPage.marginPreferences.left;</div>
<div class="line">        var myY1 = myPage.marginPreferences.top;</div>
<div class="line">        var myX2 = myWidth - myPage.marginPreferences.right;</div>
<div class="line">        var myY2 = myHeight - myPage.marginPreferences.bottom;</div>
<div class="line">        <span class="keywordflow">return</span> [myY1, myX1, myY2, myX2];</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">function</span> myGetScriptPath() {</div>
<div class="line">        <span class="keywordflow">try</span> {</div>
<div class="line">            <span class="keywordflow">return</span> app.activeScript;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(myError){</div>
<div class="line">            <span class="keywordflow">return</span> File(myError.fileName);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_getting_started_with_xml_rules"></a>
Getting started with XML rules</h3>
<p>Here is a very simple XML rule-it does nothing more than add a return character after every XML element in the document. The XML-rule set contains one rule. For the complete script, see AddReturns. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myRootXML to first XML element of myDocument</div>
<div class="line">        <span class="keyword">set</span> myApplicationPath to file path</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">        <span class="keyword">set</span> myRuleSet to {my AddReturns()}</div>
<div class="line">    end tell</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        --The third parameter of __processRuleSet is a</div>
<div class="line">        --prefix mapping table; we<span class="stringliteral">&#39;ll leave it empty.</span></div>
<div class="line"><span class="stringliteral">        __processRuleSet(myRootXML, myRuleSet, {})</span></div>
<div class="line"><span class="stringliteral">    end tell</span></div>
</div><!-- fragment --><div class="fragment"><div class="line">on AddReturns()</div>
<div class="line">    script AddReturns</div>
<div class="line">        property name : &quot;AddReturns&quot;</div>
<div class="line">        property xpath : &quot;<span class="comment">//*&quot;</span></div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using return position element end</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return false</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end AddReturns</div>
</div><!-- fragment --><p> <b>Adding white space and static text</b></p>
<p>The following XML rule script is similar to the previous script, in that it adds white space and static text. It is somewhat more complex, however, in that it treats some XML elements differently based on their element names. For the complete script, see AddReturnsAndStaticText. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myRootXML to first XML element of myDocument</div>
<div class="line">        <span class="keyword">set</span> myApplicationPath to file path</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">        <span class="keyword">set</span> myRuleSet to {my ProcessDevice(), my ProcessName(), my ProcessType(), my ProcessPartNumber(), my ProcessSupplyVoltage(), my ProcessPackageType(), my ProcessPackageOne(), my ProcessPackages(), my ProcessPrice()}</div>
<div class="line">    end tell</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        --The third parameter of __processRuleSet is a</div>
<div class="line">        --prefix mapping table; we<span class="stringliteral">&#39;ll leave it empty.</span></div>
<div class="line"><span class="stringliteral">        __processRuleSet(myRootXML, myRuleSet, {})</span></div>
<div class="line"><span class="stringliteral">    end tell</span></div>
</div><!-- fragment --><div class="fragment"><div class="line">on ProcessDevice()</div>
<div class="line">    script ProcessDevice</div>
<div class="line">        property name : &quot;ProcessDevice&quot;</div>
<div class="line">        property xpath : &quot;/devices/device&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessDevice</div>
<div class="line">on ProcessName()</div>
<div class="line">    script ProcessName</div>
<div class="line">        property name : &quot;ProcessName&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/name&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using &quot;Device Name: &quot; position before element</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessName</div>
<div class="line">to ProcessType()</div>
<div class="line">    script ProcessType</div>
<div class="line">        property name : &quot;ProcessType&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/type&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using &quot;Circuit Type: &quot; position before element</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessType</div>
<div class="line">to ProcessPartNumber()</div>
<div class="line">    script ProcessPartNumber</div>
<div class="line">        property name : &quot;ProcessPartNumber&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/part_number&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using &quot;Part Number: &quot; position before element</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessPartNumber</div>
<div class="line">to ProcessSupplyVoltage()</div>
<div class="line">    script ProcessSupplyVoltage</div>
<div class="line">        property name : &quot;ProcessSupplyVoltage&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/supply_voltage&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using &quot;Supply Voltage: From: &quot; position before element</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                        tell XML element 1</div>
<div class="line">                            insert text as content using &quot; to &quot; position after element</div>
<div class="line">                        end tell</div>
<div class="line">                        tell XML element -1</div>
<div class="line">                            insert text as content using &quot; volts&quot; position after element</div>
<div class="line">                        end tell</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessSupplyVoltage</div>
<div class="line">--</div>
<div class="line">to ProcessPackageType()</div>
<div class="line">    script ProcessPackageType</div>
<div class="line">        property name : &quot;ProcessPackageType&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/package/type&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using &quot;-&quot; position after element</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessPackageType</div>
<div class="line">--Add the text &quot;Package:&quot; before the list of packages.</div>
<div class="line">to ProcessPackageOne()</div>
<div class="line">    script ProcessPackageOne</div>
<div class="line">        property name : &quot;ProcessPackageOne&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/package[1]&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using &quot;Package: &quot; position before element</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessPackageOne</div>
<div class="line">--Add commas between the package types and a return at the end of the packages.</div>
<div class="line">to ProcessPackages()</div>
<div class="line">    script ProcessPackages</div>
<div class="line">        property name : &quot;ProcessPackages&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/package&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        set myIndex to index of myXMLElement</div>
<div class="line">                        if myIndex is not 1 then</div>
<div class="line">                            insert text as content using &quot;, &quot; position before element</div>
<div class="line">                        end if</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessPackages</div>
<div class="line">--</div>
<div class="line">to ProcessPrice()</div>
<div class="line">    script ProcessPrice</div>
<div class="line">        property name : &quot;ProcessPrice&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/price&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using return position before element</div>
<div class="line">                        insert text as content using &quot;Price: $&quot; position before element</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessPrice</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The above script uses scripting logic to add commas between repeating elements (in the ProcessPackages XML rule). If you have a sequence of similar elements at the same level, you can use forward-axis matching to do the same thing. Given the following example XML structure: <div class="fragment"><div class="line">&lt;xmlElement&gt;</div>
<div class="line">    &lt;item&gt;1&lt;/item&gt;</div>
<div class="line">    &lt;item&gt;2&lt;/item&gt;</div>
<div class="line">    &lt;item&gt;3&lt;/item&gt;</div>
<div class="line">    &lt;item&gt;4&lt;/item&gt;</div>
<div class="line">&lt;/xmlElement&gt;</div>
</div><!-- fragment --> To add commas between each item XML element in a layout, you could use an XML rule like the following (from the ListProcessing tutorial script): <div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myRootXML to first XML element of myDocument</div>
<div class="line">        <span class="keyword">set</span> myApplicationPath to file path</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">        <span class="keyword">set</span> myRuleSet to {my ListItems()}</div>
<div class="line">    end tell</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        __processRuleSet(myRootXML, myRuleSet, {})</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">on ListItems()</div>
<div class="line">    script ListItems</div>
<div class="line">        property name : &quot;ListItems&quot;</div>
<div class="line">        property xpath : &quot;/xmlElement/item[1]/following-sibling::*&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                tell myXMLElement</div>
<div class="line">                    insert text as content using &quot;, &quot; position before element</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">            return false</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ListItems</div>
</div><!-- fragment --> </dd></dl>
<h3><a class="anchor" id="id_as_changing_the_xml_structure_using_xml_rules"></a>
Changing the XML structure using XML rules</h3>
<p>Because the order of XML elements is significant in InDesign's XML implementation, you might need to use XML rules to change the sequence of elements in the structure. In general, large-scale changes to the structure of an XML document are best done using an XSLT file to transform the document before or during XML import into InDesign.</p>
<p>The following XML rule script shows how to use the move method to accomplish this. Note the use of the __skipChildren function from the glue code to prevent the XML-rules processor from becoming invalid. For the complete script, see MoveXMLElementRule. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myRootXML to first XML element of myDocument</div>
<div class="line">        <span class="keyword">set</span> myApplicationPath to file path</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">        <span class="keyword">set</span> myRuleSet to {my MoveElement()}</div>
<div class="line">    end tell</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        --The third parameter of __processRuleSet is a</div>
<div class="line">        --prefix mapping table; we<span class="stringliteral">&#39;ll leave it empty.</span></div>
<div class="line"><span class="stringliteral">        __processRuleSet(myRootXML, myRuleSet, {})</span></div>
<div class="line"><span class="stringliteral">    end tell</span></div>
</div><!-- fragment --><div class="fragment"><div class="line">on MoveElement()</div>
<div class="line">    script MoveElement</div>
<div class="line">        property name : &quot;MoveElement&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/part_number&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            tell myGlueCode</div>
<div class="line">                __skipChildren(myRuleProcessor)</div>
<div class="line">            end tell</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        set myParent to parent</div>
<div class="line">                        set myTargetXMLElement to XML element 1 of myParent</div>
<div class="line">                        move to before myTargetXMLElement</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end MoveElement</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_duplicating_xml_elements_with_xml_rules"></a>
Duplicating XML elements with XML rules</h3>
<p>XML elements have a one-to-one relationship with their expression in a layout. If you want the content of an XML element to appear more than once in a layout, you need to duplicate the element. The following script shows how to duplicate elements using XML rules. For the complete script, see DuplicateXMLElementRule. Again, this rule uses __skipChildren to avoid invalid XML object references. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myRootXML to first XML element of myDocument</div>
<div class="line">        <span class="keyword">set</span> myApplicationPath to file path</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">        <span class="keyword">set</span> myRuleSet to {my DuplicateElement()}</div>
<div class="line">    end tell</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        --The third parameter of __processRuleSet is a</div>
<div class="line">        --prefix mapping table; we<span class="stringliteral">&#39;ll leave it empty.</span></div>
<div class="line"><span class="stringliteral">        __processRuleSet(myRootXML, myRuleSet, {})</span></div>
<div class="line"><span class="stringliteral">    end tell</span></div>
</div><!-- fragment --><div class="fragment"><div class="line">to DuplicateElement()</div>
<div class="line">    script DuplicateElement</div>
<div class="line">        property name : &quot;DuplicateElement&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/part_number&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            --Because this rule makes changes to the XML structure,</div>
<div class="line">            --you must use __skipChildren to avoid invalidating</div>
<div class="line">            --the XML <span class="keywordtype">object</span> references.</div>
<div class="line">            tell myGlueCode</div>
<div class="line">                __skipChildren(myRuleProcessor)</div>
<div class="line">            end tell</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        duplicate</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end DuplicateElement</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_xml_rules_and_xml_attributes"></a>
XML rules and XML attributes</h3>
<p>The following XML rule adds attributes to XML elements based on the content of their "name" element. When you need to find an element by its text contents, copying or moving XML element contents to XML attributes attached to their parent XML element can be very useful in XML-rule scripting. While the subset of XPath supported by XML rules cannot search the text of an element, it can find elements by a specified attribute value. For the complete script, see AddAttribute. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myRootXML to XML element 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myApplicationPath to file path</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">        <span class="keyword">set</span> myRuleSet to {my AddAttribute()}</div>
<div class="line">    end tell</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        __processRuleSet(myRootXML, myRuleSet, {})</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">on AddAttribute()</div>
<div class="line">    script AddAttribute</div>
<div class="line">        property name : &quot;AddAttribute&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/part_number&quot;</div>
<div class="line">        --Adds the content of an XML element to an attribute of</div>
<div class="line">        --the parent of the XML element. This can make finding the</div>
<div class="line">        --element by its contnet much easier and faster.</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        set myString to contents of text 1</div>
<div class="line">                        tell parent</div>
<div class="line">                            make XML attribute with properties {name:<span class="stringliteral">&quot;part_number&quot;</span>, value:myString}</div>
<div class="line">                        end tell</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    <span class="keyword">set</span> myReturnString to myError</div>
<div class="line">                end <span class="keywordflow">try</span></div>
<div class="line">            end tell</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span></div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end AddAttribute</div>
</div><!-- fragment --><p> In the previous XML rule, we copied the data from an XML element into an XML attribute attached to its parent XML element. Instead, what if we want to move the XML element data into an attribute and remove the XML element itself? Use the convertToAttribute method, as shown in the following script (from the ConvertToAttribute tutorial script): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myRootXML to first XML element of active document</div>
<div class="line">        <span class="keyword">set</span> myApplicationPath to file path</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">        <span class="keyword">set</span> myRuleSet to {my ConvertToAttribute()}</div>
<div class="line">    end tell</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        __processRuleSet(myRootXML, myRuleSet, {})</div>
<div class="line">    end tell</div>
<div class="line">    --![Convert to attribute - functions.]</div>
<div class="line">end mySnippet</div>
<div class="line">on myTeardown()</div>
<div class="line">end myTeardown</div>
</div><!-- fragment --><div class="fragment"><div class="line">end mySnippet</div>
<div class="line">on myTeardown()</div>
<div class="line">end myTeardown</div>
<div class="line">--![Convert to attribute.]</div>
<div class="line">on ConvertToAttribute()</div>
<div class="line">    script ConvertToAttribute</div>
<div class="line">        property name : &quot;ConvertToAttribute&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/part_number&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            tell myGlueCode</div>
<div class="line">                __skipChildren(myRuleProcessor)</div>
<div class="line">            end tell</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        convert to attribute (&quot;PartNumber&quot;)</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ConvertToAttribute</div>
</div><!-- fragment --><p> To move data from an XML attribute to an XML element, use the convertToElement method, as described in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_xml">XML.</a></p>
<h3><a class="anchor" id="id_as_applying_multiple_matching_rules"></a>
Applying multiple matching rules</h3>
<p>When the apply function of an XML rule returns true, the XML-rules processor does not apply any further XML rules to the matched XML element. When the apply function returns false, however, the XML-rules processor can apply other rules to the XML element. The following script shows an example of an XML-rule apply function that returns false. This script contains two rules that will match every XML element in the document. The only difference between them is that the first rule applies a color and returns false, while the second rule applies a different color to every other XML element (based on the state of a variable, myCounter). For the complete script, see ReturningFalse. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myPage to active page of active window</div>
<div class="line">        <span class="keyword">set</span> myRootXML to first XML element of document 1</div>
<div class="line">        <span class="keyword">set</span> myApplicationPath to file path</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">        <span class="keyword">set</span> myRuleSet to {my ReturnFalse(), my ReturnTrue()}</div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myColorA to make color with properties {name:<span class="stringliteral">&quot;ColorA&quot;</span>, model:process, color value:{0, 100, 80, 0}}</div>
<div class="line">            <span class="keyword">set</span> myColorB to make color with properties {name:<span class="stringliteral">&quot;ColorB&quot;</span>, model:process, color value:{100, 0, 80, 0}}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        __processRuleSet(myRootXML, myRuleSet, {})</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">on ReturnTrue()</div>
<div class="line">    script ReturnTrue</div>
<div class="line">        property name : &quot;ReturnTrue&quot;</div>
<div class="line">        property xpath : &quot;<span class="comment">//*&quot;</span></div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        if myCounter mod 2 = 0 then</div>
<div class="line">                            set fill color of text 1 to &quot;ColorA&quot;</div>
<div class="line">                        end if</div>
<div class="line">                        set myCounter to myCounter + 1</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            --Do not process the element with any further matching rules.</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ReturnTrue</div>
<div class="line">on ReturnFalse()</div>
<div class="line">    script ReturnFalse</div>
<div class="line">        property name : &quot;ReturnFalse&quot;</div>
<div class="line">        property xpath : &quot;<span class="comment">//*&quot;</span></div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        set fill color of text 1 to &quot;ColorB&quot;</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            --Leave the XML element available for further matching rules.</div>
<div class="line">            return false</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ReturnFalse</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_finding_xml_elements"></a>
Finding XML elements</h3>
<p>As noted earlier, the subset of XPath supported by XML rules does not allow for searching the text contents of XML elements. To get around this limitation, you can either use attributes to find the XML elements you want or search the text of the matching XML elements. The following script shows how to match XML elements using attributes. This script applies a color to the text of elements it finds, but a practical script would do more. For the complete script, see FindXMLElementByAttribute. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myPage to active page of active window</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myRootXML to first XML element</div>
<div class="line">            <span class="keyword">set</span> myColorA to make color with properties {name:<span class="stringliteral">&quot;ColorA&quot;</span>, model:process, color value:{0, 100, 80, 0}}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">    <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">    <span class="keyword">set</span> myRuleSet to {my AddAttribute()}</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        __processRuleSet(myRootXML, myRuleSet, {})</div>
<div class="line">    end tell</div>
<div class="line">    <span class="keyword">set</span> myRuleSet to {my FindAttribute()}</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        __processRuleSet(myRootXML, myRuleSet, {})</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">on AddAttribute()</div>
<div class="line">    script AddAttribute</div>
<div class="line">        property name : &quot;AddAttribute&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/part_number&quot;</div>
<div class="line">        --Adds the content of an XML element to an attribute of</div>
<div class="line">        --the parent of the XML element. This can make finding the</div>
<div class="line">        --element by its contnet much easier and faster.</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        set myString to contents of text 1</div>
<div class="line">                        tell parent</div>
<div class="line">                            make XML attribute with properties {name:<span class="stringliteral">&quot;part_number&quot;</span>, value:myString}</div>
<div class="line">                        end tell</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    <span class="keyword">set</span> myReturnString to myError</div>
<div class="line">                end <span class="keywordflow">try</span></div>
<div class="line">            end tell</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span></div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end AddAttribute</div>
<div class="line">on FindAttribute()</div>
<div class="line">    script FindAttribute</div>
<div class="line">        property name : &quot;FindAttribute&quot;</div>
<div class="line">        property xpath : &quot;/devices/device[@part_number = &#39;DS001&#39;]&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        set fill color of text 1 to &quot;ColorA&quot;</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return false</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end FindAttribute</div>
</div><!-- fragment --><p> The following script shows how to use the findText method to find and format XML content (for the complete script, see FindXMLElementByFindText): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myPage to active page of active window</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        tell document 1</div>
<div class="line">            <span class="keyword">set</span> myRootXML to first XML element</div>
<div class="line">            <span class="keyword">set</span> myColorA to make color with properties {name:<span class="stringliteral">&quot;ColorA&quot;</span>, model:process, color value:{0, 100, 80, 0}}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">    <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">    <span class="keyword">set</span> myRuleSet to {my FindByFindText()}</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        __processRuleSet(myRootXML, myRuleSet, {})</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">on FindByFindText()</div>
<div class="line">    script FindByFindText</div>
<div class="line">        property name : &quot;FindByFindText&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/description&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                set find text preferences to nothing</div>
<div class="line">                set change text preferences to nothing</div>
<div class="line">                set find what of find text preferences to &quot;triangle&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        set myFoundItems to find text</div>
<div class="line">                        if (count myFoundItems) is greater than 0 then</div>
<div class="line">                            set fill color of text 1 to &quot;ColorA&quot;</div>
<div class="line">                        end if</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">                set find text preferences to nothing</div>
<div class="line">                set change text preferences to nothing</div>
<div class="line">            end tell</div>
<div class="line">            return false</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end FindByFindText</div>
</div><!-- fragment --><p> The following script shows how to use the findGrep method to find and format XML content (for the complete script, see FindXMLElementByFindGrep): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myRootXML to first XML element</div>
<div class="line">            <span class="keyword">set</span> myColorA to make color with properties {name:<span class="stringliteral">&quot;ColorA&quot;</span>, model:process, color value:{0, 100, 80, 0}}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">    <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">    <span class="keyword">set</span> myRuleSet to {my FindByFindGrep()}</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        __processRuleSet(myRootXML, myRuleSet, {})</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">on FindByFindGrep()</div>
<div class="line">    script FindByFindGrep</div>
<div class="line">        property name : &quot;FindByFindGrep&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/description&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                set find grep preferences to nothing</div>
<div class="line">                set change grep preferences to nothing</div>
<div class="line">                --Find all of the devices the mention both &quot;pulse&quot; and</div>
<div class="line">                --&quot;triangle&quot; in their description.</div>
<div class="line">                set find what of find grep preferences to &quot;(?i)pulse.*?triangle|triangle.*?pulse&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        set myFoundItems to find grep</div>
<div class="line">                        if (count myFoundItems) is greater than 0 then</div>
<div class="line">                            set fill color of text 1 to &quot;ColorA&quot;</div>
<div class="line">                        end if</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">                set find grep preferences to nothing</div>
<div class="line">                set change grep preferences to nothing</div>
<div class="line">            end tell</div>
<div class="line">            return false</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end FindByFindGrep</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_extracting_xml_elements_with_xml_rules"></a>
Extracting XML elements with XML rules</h3>
<p>XSLT often is used to extract a specific subset of data from an XML file. You can accomplish the same thing using XML rules. The following sample script shows how to duplicate a set of sample XML elements and move them to another position in the XML element hierarchy. Note that you must add the duplicated XML elements at a point in the XML structure that will not be matched by the XML rule, or you run the risk of creating an endless loop. For the complete script, see ExtractSubset. </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myRootXML to first XML element</div>
<div class="line">            <span class="keyword">set</span> myXMLTag to make XML tag with properties {name:<span class="stringliteral">&quot;VCOs&quot;</span>}</div>
<div class="line">            tell myRootXML</div>
<div class="line">                <span class="keyword">set</span> myXMLElement to make XML element with properties {markup tag:myXMLTag}</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">    <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">    <span class="keyword">set</span> myRuleSet to {my ExtractVCO()}</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        __processRuleSet(myRootXML, myRuleSet, {})</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">on ExtractVCO()</div>
<div class="line">    script ExtractVCO</div>
<div class="line">        property name : &quot;ExtractVCO&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/type&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    if contents of text 1 of myXMLElement is &quot;VCO&quot; then</div>
<div class="line">                        set myNewXMLElement to duplicate parent of myXMLElement</div>
<div class="line">                    end if</div>
<div class="line">                    move myNewXMLElement to end of XML element -1 of XML element 1 of document 1</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ExtractVCO</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_applying_formatting_with_xml_rules"></a>
Applying formatting with XML rules</h3>
<p>The previous XML-rule examples have shown basic techniques for finding XML elements, rearranging the order of XML elements, and adding text to XML elements. Because XML rules are part of scripts, they can perform almost any action-from applying text formatting to creating entirely new page items, pages, and documents. The following XML-rule examples show how to apply formatting to XML elements using XML rules and how to create new page items based on XML-rule matching.</p>
<p>The following script adds static text and applies formatting to the example XML data (for the complete script, see XMLRulesApplyFormatting): </p>
<div class="fragment"><div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myDocument to active document</div>
<div class="line">        <span class="keyword">set</span> myApplicationPath to file path</div>
<div class="line">        <span class="keyword">set</span> myFilePath to file path as <span class="keywordtype">string</span></div>
<div class="line">        <span class="keyword">set</span> myFilePath to myFilePath &amp; <span class="stringliteral">&quot;Scripts:Xml rules:glue code.scpt&quot;</span></div>
<div class="line">        tell myDocument</div>
<div class="line">            tell view preferences</div>
<div class="line">                <span class="keyword">set</span> horizontal measurement units to points</div>
<div class="line">                <span class="keyword">set</span> vertical measurement units to points</div>
<div class="line">                <span class="keyword">set</span> ruler origin to page origin</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keyword">set</span> myRootXML to first XML element</div>
<div class="line">            <span class="keyword">set</span> myColor to make color with properties {model:process, color value:{0, 100, 100, 0}, name:<span class="stringliteral">&quot;Red&quot;</span>}</div>
<div class="line">            make paragraph style with properties {name:<span class="stringliteral">&quot;DeviceName&quot;</span>, point size:24, leading:24, space before:24, fill color:<span class="stringliteral">&quot;Red&quot;</span>, rule above:<span class="keyword">true</span>, rule above offset:24}</div>
<div class="line">            make paragraph style with properties {name:<span class="stringliteral">&quot;DeviceType&quot;</span>, point size:12, font style:<span class="stringliteral">&quot;Bold&quot;</span>, leading:12}</div>
<div class="line">            make paragraph style with properties {name:<span class="stringliteral">&quot;PartNumber&quot;</span>, point size:12, font style:<span class="stringliteral">&quot;Bold&quot;</span>, leading:12}</div>
<div class="line">            make paragraph style with properties {name:<span class="stringliteral">&quot;Voltage&quot;</span>, point size:10, leading:12}</div>
<div class="line">            make paragraph style with properties {name:<span class="stringliteral">&quot;DevicePackage&quot;</span>, pointSize:10, leading:12}</div>
<div class="line">            make paragraph style with properties {name:<span class="stringliteral">&quot;Price&quot;</span>, point size:10, leading:12, font style:<span class="stringliteral">&quot;Bold&quot;</span>, space after:12}</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">    <span class="keyword">set</span> myGlueCode to load script file myFilePath</div>
<div class="line">    <span class="keyword">set</span> myRuleSet to {my ProcessDevice(), my ProcessName(), my ProcessType(), my ProcessPartNumber(), my ProcessSupplyVoltage(), my ProcessPackageType(), my ProcessPrice(), my ProcessPackageOne(), my ProcessPackages()}</div>
<div class="line">    tell myGlueCode</div>
<div class="line">        __processRuleSet(myRootXML, myRuleSet, {})</div>
<div class="line">    end tell</div>
</div><!-- fragment --><div class="fragment"><div class="line">on ProcessDevice()</div>
<div class="line">    script ProcessDevice</div>
<div class="line">        property name : &quot;ProcessDevice&quot;</div>
<div class="line">        property xpath : &quot;/devices/device&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessDevice</div>
<div class="line">on ProcessName()</div>
<div class="line">    script ProcessName</div>
<div class="line">        property name : &quot;ProcessName&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/name&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                        apply paragraph style using &quot;DeviceName&quot;</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessName</div>
<div class="line">on ProcessType()</div>
<div class="line">    script ProcessType</div>
<div class="line">        property name : &quot;ProcessType&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/type&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using &quot;Circuit Type: &quot; position before element</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                        apply paragraph style using &quot;DeviceType&quot;</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessType</div>
<div class="line">on ProcessPartNumber()</div>
<div class="line">    script ProcessPartNumber</div>
<div class="line">        property name : &quot;ProcessPartNumber&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/part_number&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using &quot;Part Number: &quot; position before element</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                        apply paragraph style using &quot;PartNumber&quot;</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessPartNumber</div>
<div class="line">to ProcessSupplyVoltage()</div>
<div class="line">    script ProcessSupplyVoltage</div>
<div class="line">        property name : &quot;ProcessSupplyVoltage&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/supply_voltage&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using &quot;Supply Voltage: From: &quot; position before element</div>
<div class="line">                        tell XML element 1</div>
<div class="line">                            insert text as content using &quot; to &quot; position after element</div>
<div class="line">                        end tell</div>
<div class="line">                        tell XML element -1</div>
<div class="line">                            insert text as content using &quot; volts&quot; position after element</div>
<div class="line">                        end tell</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                        apply paragraph style using &quot;Voltage&quot;</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessSupplyVoltage</div>
<div class="line">on ProcessPackageType()</div>
<div class="line">    script ProcessPackageType</div>
<div class="line">        property name : &quot;ProcessPackageType&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/package/type&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using &quot;-&quot; position after element</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessPackageType</div>
<div class="line">--Add the text &quot;Package:&quot; before the list of packages.</div>
<div class="line">on ProcessPackageOne()</div>
<div class="line">    script ProcessPackageOne</div>
<div class="line">        property name : &quot;ProcessPackageOne&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/package[1]&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using &quot;Package: &quot; position before element</div>
<div class="line">                        apply paragraph style using &quot;DevicePackage&quot;</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessPackageOne</div>
<div class="line">--Add commas between the package types and a return at the end of the packages.</div>
<div class="line">on ProcessPackages()</div>
<div class="line">    script ProcessPackages</div>
<div class="line">        property name : &quot;ProcessPackages&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/package&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        set myIndex to index of myXMLElement</div>
<div class="line">                        if myIndex is not 1 then</div>
<div class="line">                            insert text as content using &quot;, &quot; position before element</div>
<div class="line">                        end if</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessPackages</div>
<div class="line">on ProcessPrice()</div>
<div class="line">    script ProcessPrice</div>
<div class="line">        property name : &quot;ProcessPrice&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/price&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                try</div>
<div class="line">                    tell myXMLElement</div>
<div class="line">                        insert text as content using return position before element</div>
<div class="line">                        insert text as content using &quot;Price: $&quot; position before element</div>
<div class="line">                        insert text as content using return position after element</div>
<div class="line">                        apply paragraph style using &quot;Price&quot;</div>
<div class="line">                    end tell</div>
<div class="line">                on error myError</div>
<div class="line">                    set myReturnString to myError</div>
<div class="line">                end try</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessPrice</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_creating_page_items_with_xml_rules"></a>
Creating page items with XML rules</h3>
<p>The following script creates new page items, inserts the content of XML elements in the page items, adds static text, and applies formatting. We include only the relevant XML-rule portions of the script here; for more information, see the complete script (XMLRulesLayout).</p>
<p>The first rule creates a new text frame for each "device" XML element: </p>
<div class="fragment"><div class="line">on ProcessDevice()</div>
<div class="line">    script ProcessDevice</div>
<div class="line">        property name : &quot;ProcessDevice&quot;</div>
<div class="line">        property xpath : &quot;/devices/device&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                set myDocument to document 1</div>
<div class="line">                tell myDocument</div>
<div class="line">                    try</div>
<div class="line">                        tell myXMLElement</div>
<div class="line">                            insert text as content using return position after element</div>
<div class="line">                        end tell</div>
<div class="line">                        if (count text frames of page 1) is greater than 0 then</div>
<div class="line">                            set myPage to make page</div>
<div class="line">                        else</div>
<div class="line">                            set myPage to page 1</div>
<div class="line">                        end if</div>
<div class="line">                        set myBounds to my myGetBounds(myDocument, myPage)</div>
<div class="line">                        set myTextFrame to place into frame myXMLElement on myPage geometric bounds myBounds</div>
<div class="line">                        tell text frame preferences of myTextFrame</div>
<div class="line">                            set first baseline offset to leading offset</div>
<div class="line">                        end tell</div>
<div class="line">                    on error myError</div>
<div class="line">                        set myReturnString to myError</div>
<div class="line">                    end try</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">            return true</div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessDevice</div>
</div><!-- fragment --><p> The "ProcessType" rule moves the "type" XML element to a new frame on the page: </p>
<div class="fragment"><div class="line">to ProcessType()</div>
<div class="line">    script ProcessType</div>
<div class="line">        property name : &quot;ProcessType&quot;</div>
<div class="line">        property xpath : &quot;/devices/device/type&quot;</div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                set myDocument to document 1</div>
<div class="line">                tell myDocument</div>
<div class="line">                    try</div>
<div class="line">                        tell myXMLElement</div>
<div class="line">                            insert text as content using &quot;Circuit Type: &quot; position before element</div>
<div class="line">                            insert text as content using return position after element</div>
<div class="line">                            apply paragraph style using &quot;DeviceType&quot;</div>
<div class="line">                        end tell</div>
<div class="line">                        set myPage to page -1 of myDocument</div>
<div class="line">                        set myBounds to my myGetBounds(myDocument, myPage)</div>
<div class="line">                        set myX1 to item 2 of myBounds</div>
<div class="line">                        set myY1 to (item 1 of myBounds) - 24</div>
<div class="line">                        set myX2 to myX1 + 48</div>
<div class="line">                        set myY2 to item 1 of myBounds</div>
<div class="line">                        set myTextFrame to place into frame myXMLElement on myPage geometric bounds {myY1, myX1, myY2, myX2}</div>
<div class="line">                        <span class="keyword">set</span> fill color of myTextFrame to <span class="stringliteral">&quot;Red&quot;</span></div>
<div class="line">                        tell text frame preferences of myTextFrame</div>
<div class="line">                            <span class="keyword">set</span> inset spacing to {6, 6, 6, 6}</div>
<div class="line">                        end tell</div>
<div class="line">                    on error myError</div>
<div class="line">                        <span class="keyword">set</span> myReturnString to myError</div>
<div class="line">                    end <span class="keywordflow">try</span></div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span></div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessType</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_creating_tables_using_xml_rules"></a>
Creating Tables using XML Rules</h2>
<p>You can use the convert element to table method to turn an XML element into a table. This method has a limitation in that it assumes that all of the XML elements inside the table conform to a very specific set of XML tags-one tag for a row element; another for a cell, or column element. Typically, the XML data we want to put into a table does not conform to this structure: it is likely that the XML elements we want to arrange in columns use heterogeneous XML tags (price, part number, etc.).</p>
<p>To get around this limitation, we can "wrap" each XML element we want to add to a table row using a container XML element, as shown in the following script fragments (see XMLRulesTable). In this example, a specific XML rule creates an XML element for each row. </p>
<div class="fragment"><div class="line">on ProcessDevice()</div>
<div class="line">    script ProcessDevice</div>
<div class="line">        property name : &quot;ProcessDevice&quot;</div>
<div class="line">        property xpath : &quot;<span class="comment">//device[@type = &#39;VCO&#39;]&quot;</span></div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                set myDocument to document 1</div>
<div class="line">                tell myDocument</div>
<div class="line">                    try</div>
<div class="line">                        set myContainerElement to XML element -1 of XML element -1 of XML element 1</div>
<div class="line">                        tell myContainerElement</div>
<div class="line">                            set myNewElement to make XML element with properties {markup tag:<span class="stringliteral">&quot;Row&quot;</span>}</div>
<div class="line">                        end tell</div>
<div class="line">                    on error myError</div>
<div class="line">                        <span class="keyword">set</span> myReturnString to myError</div>
<div class="line">                    end <span class="keywordflow">try</span></div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span></div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessDevice</div>
</div><!-- fragment --><p> Successive rules move and format their content into container elements inside the row XML element. </p>
<div class="fragment"><div class="line">on ProcessPrice()</div>
<div class="line">    script ProcessPrice</div>
<div class="line">        property name : &quot;ProcessPrice&quot;</div>
<div class="line">        property xpath : &quot;<span class="comment">//device[@type = &#39;VCO&#39;]/price&quot;</span></div>
<div class="line">        on apply(myXMLElement, myRuleProcessor)</div>
<div class="line">            tell myGlueCode</div>
<div class="line">                __skipChildren(myRuleProcessor)</div>
<div class="line">            end tell</div>
<div class="line">            global myReturnString</div>
<div class="line">            set myReturnString to &quot;OK&quot;</div>
<div class="line">            tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">                set myDocument to document 1</div>
<div class="line">                tell myDocument</div>
<div class="line">                    try</div>
<div class="line">                        --/devices/VCOs/VCOs/Row</div>
<div class="line">                        set myRootElement to XML element 1</div>
<div class="line">                        set myVCOs to XML element -1 of myRootElement</div>
<div class="line">                        set myTable to XML element -1 of myVCOs</div>
<div class="line">                        set myContainerElement to XML element -1 of myTable</div>
<div class="line">                        tell myContainerElement</div>
<div class="line">                            set myNewElement to make XML element with properties {markup tag:<span class="stringliteral">&quot;Column&quot;</span>}</div>
<div class="line">                        end tell</div>
<div class="line">                        <span class="keyword">set</span> myXMLElement to move myXMLElement to beginning of myNewElement</div>
<div class="line">                        tell myXMLElement</div>
<div class="line">                            insert text as content <span class="keyword">using</span> <span class="stringliteral">&quot;$&quot;</span> position before element</div>
<div class="line">                        end tell</div>
<div class="line">                    on error myError</div>
<div class="line">                        <span class="keyword">set</span> myReturnString to myError</div>
<div class="line">                    end <span class="keywordflow">try</span></div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span></div>
<div class="line">        end apply</div>
<div class="line">    end script</div>
<div class="line">end ProcessPrice</div>
</div><!-- fragment --><p> Once all of the specified XML elements have been "wrapped," we can convert the container element to a table. </p>
<div class="fragment"><div class="line">        tell myContainerElement</div>
<div class="line">            <span class="keyword">set</span> myTable to convert element to table row tag myRowTag cell tag myColumnTag</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_scripting_the_xml-rules_processor_object"></a>
Scripting the XML-rules Processor Object</h2>
<p>While we have provided a set of utility functions in glue code.scpt, you also can script the XML-rules processor object directly. You might want do this to develop your own support routines for XML rules or to use the XML-rules processor in other ways.</p>
<p>When you script XML elements outside the context of XML rules, you cannot locate elements using XPath. You can, however, create an XML rule that does nothing more than return matching XML elements, and apply the rule using an XML-rules processor, as shown in the following script. (This script uses the same XML data file as the sample scripts in previous sections.) For the complete script, see XMLRulesProcessor. </p>
<div class="fragment"><div class="line">    <span class="keyword">set</span> myXPath to {<span class="stringliteral">&quot;/devices/device&quot;</span>}</div>
<div class="line">    <span class="keyword">set</span> myXMLMatches to mySimulateXPath(myXPath)</div>
<div class="line">    --At <span class="keyword">this</span> point, myXMLMatches contains all of the XML elements</div>
<div class="line">    --that matched the XPath expression provided in myXPath.</div>
<div class="line">    --In a real script, you could now process the elements.</div>
<div class="line">    --For <span class="keyword">this</span> example, however, we<span class="stringliteral">&#39;ll simply display a message.</span></div>
<div class="line"><span class="stringliteral">    display dialog (&quot;Found &quot; &amp; (count myXMLMatches) &amp; &quot; matching XML elements.&quot;)</span></div>
</div><!-- fragment --><div class="fragment"><div class="line">on mySimulateXPath(myXPath)</div>
<div class="line">    set myMatchingElements to {}</div>
<div class="line">    tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">        <span class="keyword">set</span> myRuleProcessor to make XML rule processor with properties {rule paths:myXPath}</div>
<div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        <span class="keyword">set</span> myRootXMLElement to XML element 1 of myDocument</div>
<div class="line">        tell myRuleProcessor</div>
<div class="line">            <span class="keyword">set</span> myMatchData to start processing rule <span class="keyword">set</span> initial element myRootXMLElement</div>
<div class="line">            repeat until myMatchData is nothing</div>
<div class="line">                local myMatchData</div>
<div class="line">                local myMatchingElements</div>
<div class="line">                <span class="keyword">set</span> myXMLElement to item 1 of myMatchData</div>
<div class="line">                <span class="keyword">set</span> myMatchingElements to myMatchingElements &amp; myXMLElement</div>
<div class="line">                <span class="keyword">set</span> myMatchData to find next match</div>
<div class="line">            end repeat</div>
<div class="line">        end tell</div>
<div class="line">        <span class="keywordflow">return</span> myMatchingElements</div>
<div class="line">    end tell</div>
<div class="line">end mySimulateXPath</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_as_track_changes"></a>
Track Changes</h1>
<p>Writers can track, show, hide, accept, and reject changes as a document moves through the writing and editing process. All changes are recorded and visualized to make it easier to review a document.</p>
<p>This tutorial shows how to script the most common operations involving tracking changes.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script. We also assume that you have some knowledge of working with text in InDesign and understand basic typesetting terms.</p>
<h2><a class="anchor" id="id_as_tracking_changes"></a>
Tracking Changes</h2>
<p>This section shows how to navigate tracked changes, accept changes, and reject changes using scripting.</p>
<p>Whenever anyone adds, deletes, or moves text within an existing story, the change is marked in galley and story views.</p>
<h3><a class="anchor" id="id_as_navigating_tracked_changes"></a>
Navigating tracked changes</h3>
<p>If the story contains a record of tracked changes, the user can navigate sequentially through tracked changes. The following script show how to navigate the tracked changes (for the complete script, refer to GetTrackchange).</p>
<p>The script below uses the change index number to iterate through changes: </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myStory to story 1</div>
<div class="line">            tell myStory</div>
<div class="line">                <span class="keywordflow">if</span> (track changes) is <span class="keyword">true</span> then</div>
<div class="line">                    <span class="keyword">set</span> myChangeCounter to count</div>
<div class="line">                    <span class="keyword">set</span> myChange to change 1</div>
<div class="line">                end <span class="keywordflow">if</span></div>
<div class="line">                </div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_accepting_and_reject_tracked_changes"></a>
Accepting and reject tracked changes</h3>
<p>When changes are made to a story, by you or others, the change-tracking feature enables you to review all changes and decide whether to incorporate them into the story. You can accept and reject changes-added, deleted, or moved text-made by any user.</p>
<p>In the following script, the change is accepted (for the complete script, refer to Acceptchange): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myStory to story 1</div>
<div class="line">            tell myStory</div>
<div class="line">                <span class="keyword">set</span> myChange to change 1</div>
<div class="line">                tell myChange</div>
<div class="line">                    accept</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --><p> In the following script, the change is rejected (for the complete script, refer to Rejectchange): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myStory to story 1</div>
<div class="line">            tell myStory</div>
<div class="line">                <span class="keyword">set</span> myChange to change 1</div>
<div class="line">                tell myChange</div>
<div class="line">                    reject</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_as_information_about_tracked_changes"></a>
Information about tracked changes</h3>
<p>Change information includes include date and time. The following script shows the information of a tracked change (for the complete script, refer to GetChangeInfo):</p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myStory to story 1</div>
<div class="line">            tell myStory</div>
<div class="line">                <span class="keyword">set</span> myChange to change 1</div>
<div class="line">                tell myChange</div>
<div class="line">                    -- change type (inserted text/deleted text/moved text, r/o) : The type of tracked change. Note: Valid only when track changes is true.</div>
<div class="line">                    set myTypes to change type</div>
<div class="line">                    </div>
<div class="line">                    set myCharacters to characters</div>
<div class="line">                    </div>
<div class="line">                    set myDate to date</div>
<div class="line">                    </div>
<div class="line">                    </div>
<div class="line">                    set myInsertionPoints to insertion points</div>
<div class="line">                    </div>
<div class="line">                    </div>
<div class="line">                    set myLines to lines</div>
<div class="line">                    </div>
<div class="line">                    -- paragraphs A collection of paragraphs.</div>
<div class="line">                    set myParagraphs to paragraphs</div>
<div class="line">                    </div>
<div class="line">                    set myStoryOffset to story offset</div>
<div class="line">                    </div>
<div class="line">                    set myTextColumns to text columns</div>
<div class="line">                    </div>
<div class="line">                    set myTextStyleRanges to text style ranges</div>
<div class="line">                    </div>
<div class="line">                    </div>
<div class="line">                    set myTextsetiableInstances to text variable instances</div>
<div class="line">                    </div>
<div class="line">                    -- The user who made the change. Note: Valid only when track changes is true.</div>
<div class="line">                    set myUserName to user name</div>
<div class="line">                    -- Words  A collection of words</div>
<div class="line">                    set myWords to words</div>
<div class="line">                end tell</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_as_preferences_for_tracking_changes"></a>
Preferences for Tracking Changes</h2>
<p>Track-changes preferences are user settings for tracking changes. For example, you can define which changes are tracked (adding, deleting, or moving text). You can specify the appearance of each type of tracked change, and you can have changes identified with colored change bars in the margins. The following script shows how to set and get these preferences (for the complete script, refer to GetChangePreference): </p>
<div class="fragment"><div class="line">        <span class="keyword">set</span> myTrackChangesPreference to track changes preferences</div>
<div class="line">        tell myTrackChangesPreference</div>
<div class="line">            --  added background color choice (change background uses galley background color/change background uses user color/change background uses change pref color) : The background color option for added text.</div>
<div class="line">            set myAddedBackgroundColorChoice to added background color choice</div>
<div class="line">            set added background color choice to change background uses change pref color</div>
<div class="line">            </div>
<div class="line">            </div>
<div class="line">            --added text color choice (change uses galley text color/change uses change pref color) : The color option for added text.</div>
<div class="line">            set myAddedTextColorChoice to added text color choice</div>
<div class="line">            set added text color choice to change uses change pref color</div>
<div class="line">            </div>
<div class="line">            </div>
<div class="line">            --background color for added text (any) : The background color for added text, specified as an InDesign UI color. Note: Valid only when added background color choice is change background uses change pref color. Can return: list of 3 fixed (0 - 255) or canary/lemon/electrolyte/lime/forest/lichen/...</div>
<div class="line">            set myBackgroundColorForAddedText to background color for added text</div>
<div class="line">            set background color for added text to gray</div>
<div class="line">            </div>
<div class="line">            --background color for deleted text (any) : The background color for deleted text, specified as an InDesign UI color. Note: Valid only when deleted background color choice is change background uses change pref color. Can return: list of 3 fixed (0 - 255) or canary/lemon/electrolyte/lime/forest/lic...</div>
<div class="line">            set myBackgroundColorForDeletedText to background color for deleted text</div>
<div class="line">            set background color for deleted text to red</div>
<div class="line">            </div>
<div class="line">            --background color for moved text (any) : The background color for moved text, specified as an InDesign UI color. Note: Valid only when moved background color choice is change background uses change pref color. Can return: list of 3 fixed (0 - 255) or canary/lemon/electrolyte/lime/forest/lichen/...         </div>
<div class="line">            set myBackgroundColorForMovedText to background color for moved text</div>
<div class="line">            set background color for moved text to pink</div>
<div class="line">            --change bar color (any) : The change bar color, specified as an InDesign UI color. </div>
<div class="line">            set myChangeBarColor to change bar color</div>
<div class="line">            set change bar color to charcoal</div>
<div class="line">            --deleted background color choice (change background uses galley background color/change background uses user color/change background uses change pref color) : The background color option for deleted text.</div>
<div class="line">            set myDeletedBackgroundColorChoice to deleted background color choice</div>
<div class="line">            set deleted background color choice to change background uses change pref color</div>
<div class="line">            </div>
<div class="line">            --deleted text color choice (change uses galley text color/change uses change pref color) : The color option for deleted text.</div>
<div class="line">            set myDeletedTextColorChoice to deleted text color choice</div>
<div class="line">            set deleted text color choice to change uses change pref color</div>
<div class="line">            </div>
<div class="line">            --location for change bar (left align/right align) : The change bar location.</div>
<div class="line">            set myLocationForChangeBar to location for change bar</div>
<div class="line">            set location for change bar to left align</div>
<div class="line">            </div>
<div class="line">            --marking for added text (none/strikethrough/underline single/outline) : The marking that identifies added text.</div>
<div class="line">            set myMarkingForAddedText to marking for added text</div>
<div class="line">            set marking for added text to strikethrough</div>
<div class="line">            </div>
<div class="line">            --marking for deleted text (none/strikethrough/underline single/outline) : The marking that identifies deleted text.</div>
<div class="line">            set myMarkingForDeletedText to marking for deleted text</div>
<div class="line">            set marking for deleted text to underline single</div>
<div class="line">            </div>
<div class="line">            --marking for moved text (none/strikethrough/underline single/outline) : The marking that identifies moved text.</div>
<div class="line">            set myMarkingForMovedText to marking for moved text</div>
<div class="line">            set marking for moved text to outline</div>
<div class="line">            </div>
<div class="line">            </div>
<div class="line">            --moved background color choice (change background uses galley background color/change background uses user color/change background uses change pref color) : The background color option for moved text.</div>
<div class="line">            set myMovedBackgroundColorChoice to moved background color choice</div>
<div class="line">            set moved background color choice to change background uses galley background color</div>
<div class="line">            </div>
<div class="line">            -- moved text color choice (change uses galley text color/change uses change pref color) : The color option for moved text.</div>
<div class="line">            set myMovedTextColorChoice to moved text color choice</div>
<div class="line">            set moved text color choice to change uses change pref color</div>
<div class="line">            </div>
<div class="line">            -- If true, displays added text.</div>
<div class="line">            set myShowAddedText to show added text</div>
<div class="line">            set show added text to true</div>
<div class="line">            </div>
<div class="line">            --  If true, displays change bars.</div>
<div class="line">            set myShowChangeBars to show change bars</div>
<div class="line">            set show change bars to true</div>
<div class="line">            </div>
<div class="line">            -- If true, displays deleted text.</div>
<div class="line">            set myShowDeletedText to show deleted text</div>
<div class="line">            set show deleted text to true</div>
<div class="line">            </div>
<div class="line">            -- If true, displays moved text.</div>
<div class="line">            set myShowMovedText to show moved text</div>
<div class="line">            set show moved text to true</div>
<div class="line">            </div>
<div class="line">            -- If true, includes deleted text when using the Spell Check command.</div>
<div class="line">            set mySpellCheckDeletedText to spell check deleted text</div>
<div class="line">            set spell check deleted text to true</div>
<div class="line">            </div>
<div class="line">            --The color for added text, specified as an InDesign UI color. Note: Valid only when added text color choice is change uses change pref color. Can return: list of 3 fixed (0 - 255) or canary/lemon/electrolyte/lime/forest/lichen/jade/aqua/cirrus/ether/slate....    </div>
<div class="line">            set myTextColorForAddedText to text color for added text</div>
<div class="line">            set text color for added text to blue</div>
<div class="line">            </div>
<div class="line">            --  text color for deleted text (any) : The color for deleted text, specified as an InDesign UI color. Note: Valid only when deleted text color choice is change uses change pref color. Can return: list of 3 fixed (0 - 255) or canary/lemon/electrolyte/lime/forest/lichen/jade/aqua/cirrus/ether/s...           </div>
<div class="line">            set myTextColorForDeletedText to text color for deleted text</div>
<div class="line">            set text color for deleted text to yellow</div>
<div class="line">            </div>
<div class="line">            --  The color for moved text, specified as an InDesign UI color. Note: Valid only when moved text color choice is change uses change pref color. Can return: list of 3 fixed (0 - 255) or canary/lemon/electrolyte/lime/forest/lichen/jade/aqua/cirrus/ether/slate...</div>
<div class="line">            set myTextColorForMovedText to text color for moved text</div>
<div class="line">            set text color for moved text to green</div>
<div class="line">        end tell</div>
</div><!-- fragment --></div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Mar 3 2024 02:53:07 for InDesign Scripting SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
